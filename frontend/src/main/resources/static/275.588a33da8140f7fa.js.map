{"version":3,"mappings":"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","names":["i0","ctx_r55","ctx_r61","ctx_r63","SubstanceCodesComponent","dialog","gaService","overlayContainerService","utilsService","c","Subject","FormControl","this","substanceUpdated","subscribe","i","substance","codes","type","displayedColumns","displayedFilterColumns","filterSubstanceCodes","length","forEach","code","url","trim","filtered","pageChange","searchControl","valueChanges","filterList","value","getTypeFilterOptions","pageSize","overlayContainer","getContainerElement","codeSystemFilter","codeSystemFilterValue","filterTable","codeFilter","codeFilterValue","typeFilter","typeFilterValue","csFilter","cFilter","tFilter","n","f","codeSystem","toLowerCase","includes","push","T","hideFilters","showHideFilterText","typeFilterOptions","l","r","display","u","oneType","filter","e","sort","data","slice","active","direction","a","b","isAsc","s","compare","toString","toUpperCase","_isClassification","countUpdate","emit","access","itIs","comments","split","setValue","templateRef","sendEvent","analyticsEventCategory","dialogRef","open","minWidth","maxWidth","style","zIndex","afterClosed","SubstanceCardBaseFilteredList","selectors","ctx","SubstanceCodesModule","CommonModule","DynamicComponentLoaderModule","MatTableModule","CdkTableModule","MatPaginatorModule","MatInputModule","MatFormFieldModule","MatSelectModule","ReactiveFormsModule","FormsModule","MatTreeModule","RouterModule","MatIconModule","ReferencesManagerModule","MatDialogModule","MatSortModule","CodeDisplayModule"],"sources":["./src/app/core/substance-details/substance-codes/substance-codes.component.html","./src/app/core/substance-details/substance-codes/substance-codes.component.ts","./src/app/core/substance-details/substance-codes/substance-codes.module.ts"],"sourcesContent":["<div class=\"flex-row\">\r\n  <span class=\"middle-fill\"></span>\r\n  <mat-form-field [floatLabel]=\"'never'\" class=\"search\">\r\n    <input matInput placeholder=\"Search\" [formControl]=\"searchControl\">\r\n  </mat-form-field>\r\n</div>\r\n<div class=\"responsive\">\r\n  <span class=\"show-filter-span\">\r\n    <mat-label class = \"mat-button mat-button-primary\" mat-flat-button color=\"warn\" (click)=\"toggleFilter()\">{{showHideFilterText}}</mat-label>\r\n  </span>\r\n  <table [ngClass]=\"{ 'classification': type == 'Codes - Classifications' }\" mat-table [dataSource]=\"paged\" matSort (matSortChange)=\"sortData($event)\">\r\n\r\n    <ng-container matColumnDef=\"classificationTree\">\r\n      <th mat-header-cell *matHeaderCellDef> Classification Tree </th>\r\n      <td mat-cell *matCellDef=\"let code\">\r\n        <div *ngFor=\"let node of getClassificationTree(code.comments); index as i\" [ngStyle]=\"{'padding-left.px':i * 10}\">\r\n          <mat-icon svgIcon=\"subdirectory_arrow_right\" *ngIf=\"i > 0\"></mat-icon>\r\n          <a\r\n            routerLink=\"/browse-substance\"\r\n            [queryParams]='{ search: \"root_codes_comments:\\\"\" + node + \"\\\"\"}'>\r\n            {{node}}\r\n          </a>\r\n        </div>\r\n      </td>\r\n    </ng-container>\r\n\r\n    <ng-container matColumnDef=\"codeSystem\">\r\n      <th mat-header-cell *matHeaderCellDef  mat-sort-header> Code System </th>\r\n      <td mat-cell *matCellDef=\"let code\"> {{code.codeSystem | codeSystemDisplay | async}}\r\n        <span *ngIf=\"codeIsProtected(code.access)\" matTooltip=\"Not Public\">\r\n          <mat-icon svgIcon=\"lock\" class=\"icon-align blue-font\" *ngIf=\"codeIsProtected(code.access)\"></mat-icon>\r\n        </span>\r\n      </td>\r\n    </ng-container>\r\n\r\n    <ng-container matColumnDef=\"code\">\r\n      <th mat-header-cell *matHeaderCellDef  mat-sort-header> Code </th>\r\n      <td mat-cell *matCellDef=\"let code\">\r\n        <a  class = 'a-link' *ngIf = \"code.url\" [href] = \"code.url\" target = \"_blank\">{{code.code}}</a>\r\n        <span *ngIf = \"!code.url\"> {{code.code}}</span>\r\n      </td>\r\n    </ng-container>\r\n\r\n    <ng-container matColumnDef=\"type\">\r\n      <th mat-header-cell *matHeaderCellDef  mat-sort-header> Type </th>\r\n      <td mat-cell *matCellDef=\"let code\"> {{code.type}} </td>\r\n    </ng-container>\r\n\r\n    <ng-container matColumnDef=\"codeSystemFilter\">\r\n      <th mat-header-cell *matHeaderCellDef>\r\n        <div class=\"tableFilter\">\r\n          <mat-form-field>\r\n            <input matInput class=\"form-field\" [formControl]=\"codeSystemFilter\" placeholder=\"Code System Filter\">\r\n          </mat-form-field>\r\n        </div>\r\n      </th>\r\n      <td mat-cell *matCellDef=\"let code\"> {{code.codeSystem | codeSystemDisplay | async}} </td>\r\n    </ng-container>\r\n\r\n    <ng-container matColumnDef=\"codeFilter\">\r\n      <th mat-header-cell *matHeaderCellDef>\r\n        <div class=\"tableFilter\">\r\n          <mat-form-field>\r\n            <input matInput class=\"form-field\" [formControl]=\"codeFilter\" placeholder=\"Code Filter\">\r\n          </mat-form-field>\r\n        </div>\r\n      </th>\r\n      <td mat-cell *matCellDef=\"let code\">\r\n        <a  class = 'a-link' *ngIf = \"code.url\" [href] = \"code.url\" target = \"_blank\">{{code.code}}</a>\r\n        <span *ngIf = \"!code.url\"> {{code.code}}</span>\r\n      </td>\r\n    </ng-container>\r\n\r\n    <ng-container matColumnDef=\"typeFilter\">\r\n      <th mat-header-cell *matHeaderCellDef>\r\n        <div class=\"tableFilter\">\r\n          <mat-form-field appearance=\"fill\">\r\n            <mat-select [formControl]=\"typeFilter\">\r\n              <mat-select-trigger>\r\n                {{typeFilter.value ? typeFilter.value : ''}}\r\n              </mat-select-trigger>\r\n              <mat-option [value]=\"\" selected>Select Type Filter</mat-option>\r\n              <mat-option *ngFor=\"let type of typeFilterOptions\" [value]=\"type.display\">{{type.display}}</mat-option>\r\n            </mat-select>\r\n          </mat-form-field>\r\n        </div>\r\n      </th>\r\n      <td mat-cell *matCellDef=\"let code\"> {{code.type}} </td>\r\n    </ng-container>\r\n\r\n    <ng-container matColumnDef=\"comments\">\r\n      <th mat-header-cell *matHeaderCellDef  mat-sort-header> Comments </th>\r\n      <td mat-cell *matCellDef=\"let code\">\r\n          <button class = \"mat-raised-button mat-primary\" (click)=\"openModal(commentTemplate)\" [disabled]=\"!code.comments && !code.codeText \" >View</button>  \r\n          <ng-template #commentTemplate>\r\n              <h2 mat-dialog-title>Code Comments</h2>\r\n              <div mat-dialog-content>\r\n               <div class = \"form-row\" *ngIf = \"code.codeText\">\r\n                 <div class = \"label\">Comments:</div>\r\n                 <div class = \"content\">{{code.codeText}}</div>\r\n              </div>\r\n              <div class = \"form-row\" *ngIf = \"code.comments\">\r\n                  <div class = \"label\">Code Text:</div>\r\n                  <div class = \"content\">{{code.comments}}</div>\r\n               </div>\r\n               </div>\r\n              <div mat-dialog-actions>\r\n                <span class=\"middle-fill\"></span>\r\n                <button class=\"mat-raised-button mat-primary\" mat-dialog-close>Close</button>\r\n              </div>\r\n              \r\n            </ng-template>\r\n      </td>\r\n\r\n      \r\n    </ng-container>\r\n\r\n    <ng-container matColumnDef=\"references\">\r\n      <th mat-header-cell *matHeaderCellDef> References </th>\r\n      <td mat-cell *matCellDef=\"let code\">\r\n        <button class = \"mat-raised-button mat-primary\" (click)=\"openModal(refTemplate)\" [disabled]=\"code.references.length <= 0\" >View</button>\r\n\r\n        <ng-template #refTemplate>\r\n          <h2 mat-dialog-title>References</h2>\r\n          <div mat-dialog-content>\r\n            <app-references-manager [substance] = \"substance\" [references] = \"code.references\"></app-references-manager>\r\n          </div>\r\n          <div mat-dialog-actions>\r\n            <span class=\"middle-fill\"></span>\r\n            <button class=\"mat-raised-button mat-primary\" mat-dialog-close>Close</button>\r\n          </div>\r\n        </ng-template>\r\n      </td>\r\n    </ng-container>\r\n\r\n    <ng-container matColumnDef=\"emptyFilter\">\r\n      <th mat-header-cell *matHeaderCellDef>\r\n      </th>\r\n    </ng-container>\r\n\r\n    <ng-container matColumnDef=\"resetFilter\">\r\n      <th mat-header-cell *matHeaderCellDef>\r\n        <div class=\"tableFilter\">\r\n          <button class = \"mat-button mat-button-primary\" mat-flat-button color=\"warn\" (click)=\"resetFilters()\">Reset</button>\r\n        </div>\r\n      </th>\r\n    </ng-container>\r\n\r\n    <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\r\n    <tr [hidden]=\"hideFilters\" mat-header-row *matHeaderRowDef=\"displayedFilterColumns\"></tr>\r\n    <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\r\n  </table>\r\n</div>\r\n<mat-paginator [length]=\"filtered && filtered.length || 0\" [pageSize]=\"10\" showFirstLastButtons=\"true\" (page)=\"pageChange($event, analyticsEventCategory)\"\r\n  [pageSizeOptions]=\"[5, 10, 25, 100]\">\r\n</mat-paginator>\r\n","import {AfterViewInit, Component, OnInit} from '@angular/core';\r\nimport { SubstanceCardBaseFilteredList } from '../substance-card-base-filtered-list';\r\nimport {SubstanceCode, SubstanceDetail, SubstanceName, TableFilterDDModel} from '../../substance/substance.model';\r\nimport {MatDialog} from '@angular/material/dialog';\r\nimport { GoogleAnalyticsService } from '../../google-analytics/google-analytics.service';\r\nimport {Subject} from 'rxjs';\r\nimport {Sort} from '@angular/material/sort';\r\nimport { OverlayContainer } from '@angular/cdk/overlay';\r\nimport {UtilsService} from '@gsrs-core/utils';\r\nimport { FormControl } from '@angular/forms';\r\n\r\n@Component({\r\n  selector: 'app-substance-codes',\r\n  templateUrl: './substance-codes.component.html',\r\n  styleUrls: ['./substance-codes.component.scss']\r\n})\r\nexport class SubstanceCodesComponent extends SubstanceCardBaseFilteredList<SubstanceCode> implements OnInit, AfterViewInit {\r\n  type: string;\r\n  codes: Array<SubstanceCode> = [];\r\n  displayedColumns: string[];\r\n  substanceUpdated = new Subject<SubstanceDetail>();\r\n  hideFilters = true;\r\n  showHideFilterText = 'Show Filter';\r\n  displayedFilterColumns: string[];\r\n  codeSystemFilter = new FormControl();\r\n  typeFilter = new FormControl();\r\n  codeFilter = new FormControl();\r\n  typeFilterOptions: Array<TableFilterDDModel> = [];\r\n  private overlayContainer: HTMLElement;\r\n\r\n  constructor(\r\n    private dialog: MatDialog,\r\n    public gaService: GoogleAnalyticsService,\r\n    private overlayContainerService: OverlayContainer,\r\n    private utilsService: UtilsService\r\n  ) {\r\n    super(gaService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.substanceUpdated.subscribe(substance => {\r\n      this.substance = substance;\r\n      this.codes = [];\r\n      if (this.substance != null && this.type != null) {\r\n        if (this.type === 'Codes - Classifications') {\r\n          this.displayedColumns = ['classificationTree', 'codeSystem', 'code', 'references'];\r\n          //this.displayedFilterColumns = ['classTreeFilter', 'codeSystemFilter', 'codeFilter', 'emptyFilter', 'resetFilter'];\r\n        } else {\r\n          this.displayedColumns = ['codeSystem', 'code', 'type', 'comments', 'references'];\r\n          this.displayedFilterColumns = ['codeSystemFilter', 'codeFilter', 'typeFilter', 'emptyFilter', 'resetFilter'];\r\n        }\r\n\r\n          this.filterSubstanceCodes();\r\n\r\n        if (this.codes != null && this.codes.length) {\r\n          this.codes.forEach(code => {\r\n            if (code.url) {\r\n              code.url = code.url.trim();\r\n            }\r\n          });\r\n          this.filtered = this.codes;\r\n          this.pageChange();\r\n\r\n          this.searchControl.valueChanges.subscribe(value => {\r\n            this.filterList(value, this.codes);\r\n          }, error => {\r\n         //   console.log(error);\r\n          });\r\n          this.getTypeFilterOptions();\r\n        } else {\r\n          this.filtered = [];\r\n        }\r\n      }\r\n    });\r\n\r\n  //  if (this.type === 'identifiers') {\r\n      this.pageSize = 10;\r\n  //  }\r\n    \r\n    this.overlayContainer = this.overlayContainerService.getContainerElement();\r\n    this.codeSystemFilter.valueChanges.subscribe((codeSystemFilterValue) => {\r\n      this.filterTable();\r\n    });\r\n    this.codeFilter.valueChanges.subscribe((codeFilterValue) => {\r\n      this.filterTable();\r\n    });\r\n    this.typeFilter.valueChanges.subscribe((typeFilterValue) => {\r\n      this.filterTable();\r\n    });\r\n  }\r\n\r\n  filterTable(type?:string) {\r\n    const csFilter = this.codeSystemFilter.value === null ? '' : this.codeSystemFilter.value;\r\n    const cFilter = this.codeFilter.value === null ? '' : this.codeFilter.value;\r\n    const tFilter = this.typeFilter.value === null ? '' : this.typeFilter.value;\r\n    this.filtered = [];\r\n    for(let n of this.codes) {\r\n      if((n.codeSystem.toLowerCase().includes(csFilter.toLowerCase())) &&\r\n      (n.code.toLowerCase().includes(cFilter.toLowerCase())) &&\r\n      (n.type.toLowerCase().includes(tFilter.toLowerCase()))) {\r\n        this.filtered.push(n);\r\n      }\r\n    }\r\n    \r\n    this.pageChange();\r\n  }\r\n\r\n  toggleFilter() {\r\n    this.hideFilters = !this.hideFilters;\r\n    if(this.hideFilters) {\r\n      this.showHideFilterText = 'Show Filter';\r\n    } else {\r\n      this.showHideFilterText = 'Hide Filter';\r\n    }\r\n  }\r\n\r\n  getTypeFilterValue(value) {\r\n    for(let l of this.typeFilterOptions) {\r\n      if(l.display === value) {\r\n        return l;\r\n      }\r\n    }\r\n  }\r\n\r\n  getTypeFilterOptions() {\r\n    for(let n of this.codes) {\r\n        let oneType = n.type;\r\n        let value: TableFilterDDModel = {\r\n          value: oneType,\r\n          display: oneType\r\n        }\r\n        if (this.typeFilterOptions.filter(e => e.value === oneType).length > 0) {\r\n        } else {\r\n          this.typeFilterOptions.push(value);\r\n        }\r\n    }\r\n  }\r\n\r\n  sortData(sort: Sort) {\r\n    const data = this.codes.slice();\r\n    if (!sort.active || sort.direction === '') {\r\n      this.filtered = data;\r\n      this.pageChange();\r\n      return;\r\n    }\r\n    this.filtered = data.sort((a, b) => {\r\n      const isAsc = sort.direction === 'asc';\r\n      return this.utilsService.compare(a[sort.active] ? a[sort.active].toString().toUpperCase() : null, b[sort.active] ? b[sort.active].toString().toUpperCase() : null, isAsc);\r\n    });\r\n    this.pageChange();\r\n\r\n    \r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n  }\r\n\r\n  private filterSubstanceCodes(): void {\r\n    if (this.substance.codes && this.substance.codes.length > 0) {\r\n      this.substance.codes.forEach(code => {\r\n        if (code._isClassification && this.type === 'Codes - Classifications') {\r\n          this.codes.push(code);\r\n        } else if (!code._isClassification && this.type === 'Codes - Identifiers') {\r\n          this.codes.push(code);\r\n        }\r\n      });\r\n      this.countUpdate.emit(this.codes.length);\r\n    }\r\n  }\r\n\r\n  codeIsProtected(access: string[]) {\r\n    let itIs = false;\r\n    for(let a of access) {\r\n      if(a.toLowerCase() === 'protected') {\r\n        itIs = true;\r\n      }\r\n    }\r\n    return itIs;\r\n  }\r\n\r\n  getClassificationTree(comments: string): Array<string> {\r\n    return comments.split('|');\r\n  }\r\n\r\n  resetFilters() {\r\n    this.pageChange();\r\n    this.searchControl.setValue('');\r\n    this.codeFilter.setValue('');\r\n    this.codeSystemFilter.setValue('');\r\n    this.typeFilter.setValue('');\r\n  }\r\n\r\n  openModal(templateRef) {\r\n\r\n    this.gaService.sendEvent(this.analyticsEventCategory, 'button', 'references view');\r\n\r\n    const dialogRef = this.dialog.open(templateRef, {\r\n      minWidth: '40%',\r\n      maxWidth: '90%'\r\n    });\r\n    this.overlayContainer.style.zIndex = '1002';\r\n\r\n    dialogRef.afterClosed().subscribe(result => {\r\n      this.overlayContainer.style.zIndex = null;\r\n    });\r\n  }\r\n}\r\n\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { SubstanceCodesComponent } from './substance-codes.component';\r\nimport { DynamicComponentLoaderModule } from '../../dynamic-component-loader/dynamic-component-loader.module';\r\nimport { MatTableModule } from '@angular/material/table';\r\nimport { CdkTableModule } from '@angular/cdk/table';\r\nimport { MatPaginatorModule } from '@angular/material/paginator';\r\nimport { MatInputModule } from '@angular/material/input';\r\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\r\nimport { MatTreeModule } from '@angular/material/tree';\r\nimport { RouterModule } from '@angular/router';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport {ReferencesManagerModule} from '../../references-manager/references-manager.module';\r\nimport {MatDialogModule} from '@angular/material/dialog';\r\nimport {MatSortModule} from '@angular/material/sort';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { CodeDisplayModule } from '@gsrs-core/utils/code-display.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    DynamicComponentLoaderModule.forChild(SubstanceCodesComponent),\r\n    MatTableModule,\r\n    CdkTableModule,\r\n    MatPaginatorModule,\r\n    MatInputModule,\r\n    MatFormFieldModule,\r\n    MatSelectModule,\r\n    ReactiveFormsModule,\r\n    FormsModule,\r\n    MatTreeModule,\r\n    RouterModule,\r\n    MatIconModule,\r\n    ReferencesManagerModule,\r\n    MatDialogModule,\r\n    MatSortModule,\r\n    CodeDisplayModule\r\n  ],\r\n  declarations: [\r\n    SubstanceCodesComponent\r\n  ]\r\n})\r\nexport class SubstanceCodesModule { }\r\n"],"sourceRoot":"webpack:///","file":"275.588a33da8140f7fa.js"}