{"version":3,"mappings":"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","names":["SubstanceDetailsBaseTableDisplay","gaService","service","s","pageEvent","this","page","pageIndex","pageSize","results","totalRecords","filtered","pageChangeFda","analyticsEventCategory","paged","i","length","push","o","SubstanceCardBaseFilteredList","factory","i0","ctx_r20","ctx_r41","SubstanceApplicationComponent","router","authService","loadingService","applicationService","generalService","dialog","r","EventEmitter","hasAnyRolesAsync","pipe","take","subscribe","a","isAdmin","response","bdnum","getApplicationCenterList","privateSearch","getApplicationBySubstanceKeyCenter","centerListOriginal","centerList","foundCenterList","loadingComplete","$event","textLabel","tab","loadingStatus","index","indexOf","center","slice","fromTable","searchType","setPageEvent","showSpinner","subscription","getApplicationAll","privateFacetParams","u","etagAllExport","pagingResponse","etag","total","applicationCount","setResultData","content","countApplicationOut","emit","console","log","unsubscribe","extension","url","getApiExportUrl","getUser","open","ExportDialogComponent","height","width","data","type","afterClosed","name","setLoading","startUserDownload","privateExport","navigate","id","getAppAllApiExportUrl","getUpdateApplicationUrl","exportUrl","getApplicationListExportUrl","selectors","ctx","ctx_r16","SubstanceClinicalTrialsComponent","clinicalTrialService","configService","loadedComponents","configData","substanceUuid","getSubstanceClinicalTrials","subscriptions","forEach","skip","subscriptionClinical","getClinicalTrials","searchTerm","cutoff","order","facets","clinicalTrialCount","countClinicalTrialOut","getClinicalTrialListExportUrl","ctx_r12","SubstanceClinicalTrialsEuropeComponent","getSubstanceClinicalTrialsEurope","clinicalTrialEuCount","countClinicalTrialEuOut","getApiEuropeExportUrl","cteu","_","clinicalTrialEuropeMeddraList","join","SubstanceAdverseEventPtComponent","adverseEventService","adverseEventPtSearchSortValues","rolesSubscription","getAdverseEventPt","getFaersDashboardUrl","getFaersDashboardRecordByName","adverseEventPtListExportUrl","getAdverseEventShinyConfig","adverseEventCount","countAdvPtOut","getAdverseEventPtListExportUrl","sort","active","orderIndex","displayedColumns","toString","ascDescDir","direction","sortValues","sortValue","value","getApiExportUrlPt","faersNameSubscription","substanceName","FAERSDashboardSubstanceName","FAERSDashboardAdverseEventUrl","FAERSDashboardReactionTerm","FAERSDashboardSearchTerm","adverseEventShinySubstanceNameDisplay","JSON","parse","adverseEventShinySubstanceNameURL","adverseEventShinySubstanceNameURLWithParam","decodeURIComponent","adverseEventShinyAdverseEventDisplay","adverseEventShinyAdverseEventURL","adverseEventShinyAdverseEventURLWithParam","result","SubstanceAdverseEventDmeComponent","p","adverseEventDmeSearchSortValues","getAdverseEventDme","adverseEventDmeListExportUrl","countAdvDmeOut","getApiExportUrlDme","getAdverseEventDmeListExportUrl","SubstanceAdverseEventCvmComponent","adverseEventCvmSearchSortValues","getAdverseEventCvm","adverseEventCvmListExportUrl","countAdvCvmOut","getApiExportUrlCvm","getAdverseEventCvmListExportUrl","SubstanceImpuritiesComponent","impuritiesService","getImpuritiesBySubstanceUuid","impuritiesListExportUrl","privateSearchTerm","searchImpurities","impurities","impuritiesCount","countImpuritiesOut","loadImpuritiesTestDetails","totalImpurities","element","impuritiesSubstanceList","elementSub","indexSub","_parentSubstanceName","_parentSubstanceUuid","impuritiesTestList","elementTest","indexTest","impuritiesDetailsList","elementDetail","indexDetail","relatedSubstanceUuid","subSubscription","getSubstanceNamesBySubstanceUuid","substanceNames","names","displayName","preferredTerm","getImpuritiesListExportUrl","ctx_r33","ctx_r74","ctx_r76","ctx_r78","ctx_r80","ctx_r82","ctx_r84","ctx_r86","ctx_r88","ctx_r90","SubstanceProductsComponent","productService","substance","uuid","getSubstanceKey","getProductProvenanceList","getSubstanceProducts","baseDomain","apiUrlDomain","advPtCount","advDmeCount","advCvmCount","_name","codes","codeSystem","code","provenanceList","foundProvenanceList","getProducts","productCount","provenance","SubstanceProductsModule","g","CommonModule","DynamicComponentLoaderModule","MatTableModule","CdkTableModule","MatPaginatorModule","MatSortModule","MatInputModule","MatTabsModule","MatButtonModule","MatIconModule","MatProgressSpinnerModule","ReactiveFormsModule","FormsModule","RouterModule"],"sources":["./src/app/fda/substance-details/substance-products/substance-details-base-table-display.ts","./src/app/fda/substance-details/substance-products/substance-application/substance-application.component.html","./src/app/fda/substance-details/substance-products/substance-application/substance-application.component.ts","./src/app/fda/substance-details/substance-products/substance-clinical-trials/substance-clinical-trials.component.html","./src/app/fda/substance-details/substance-products/substance-clinical-trials/substance-clinical-trials.component.ts","./src/app/fda/substance-details/substance-products/substance-clinical-trials-eu/substance-clinical-trials-eu.component.html","./src/app/fda/substance-details/substance-products/substance-clinical-trials-eu/substance-clinical-trials-eu.component.ts","./src/app/fda/substance-details/substance-products/substance-adverseevent/adverseeventpt/substance-adverseeventpt.component.html","./src/app/fda/substance-details/substance-products/substance-adverseevent/adverseeventpt/substance-adverseeventpt.component.ts","./src/app/fda/substance-details/substance-products/substance-adverseevent/adverseeventdme/substance-adverseeventdme.component.html","./src/app/fda/substance-details/substance-products/substance-adverseevent/adverseeventdme/substance-adverseeventdme.component.ts","./src/app/fda/substance-details/substance-products/substance-adverseevent/adverseeventcvm/substance-adverseeventcvm.component.html","./src/app/fda/substance-details/substance-products/substance-adverseevent/adverseeventcvm/substance-adverseeventcvm.component.ts","./src/app/fda/substance-details/substance-products/substance-impurities/substance-impurities.component.html","./src/app/fda/substance-details/substance-products/substance-impurities/substance-impurities.component.ts","./src/app/fda/substance-details/substance-products/substance-products.component.html","./src/app/fda/substance-details/substance-products/substance-products.component.ts","./src/app/fda/substance-details/substance-products/substance-products.module.ts"],"sourcesContent":["import { Component, OnInit, Input, Injectable } from '@angular/core';\nimport { PageEvent } from '@angular/material/paginator';\nimport { FormControl } from '@angular/forms';\nimport { GoogleAnalyticsService } from '@gsrs-core/google-analytics';\nimport { SubstanceCardBaseFilteredList } from '@gsrs-core/substance-details';\n\n@Injectable()\nexport class SubstanceDetailsBaseTableDisplay extends SubstanceCardBaseFilteredList<any> implements OnInit {\n\n  totalRecords: 0;\n  public results: Array<any> = [];\n  isAdmin = false;\n  exportUrl: string;\n\n  @Input() bdnum: string;\n\n  constructor(\n    public gaService: GoogleAnalyticsService,\n    private service\n  ) {\n      super(gaService);\n     // this.service = service;\n    }\n\n  ngOnInit(): void {\n  }\n\n  setPageEvent(pageEvent?: PageEvent): void {\n    if (pageEvent != null) {\n      this.page = pageEvent.pageIndex;\n      this.pageSize = pageEvent.pageSize;\n    }\n  }\n\n  setResultData(results: Array<any>, totalRecords?: number): void {\n    this.results = results;\n    this.filtered = results;\n    this.totalRecords = this.service.totalRecords;\n    this.pageChangeFda();\n  }\n\n  pageChangeFda(pageEvent?: PageEvent, analyticsEventCategory?: string): void {\n    if (pageEvent != null) {\n\n      /*\n      let eventAction;\n      let eventValue;\n\n      if (this.pageSize !== pageEvent.pageSize) {\n          eventAction = 'select:page-size';\n          eventValue = pageEvent.pageSize;\n      } else if (this.page !== pageEvent.pageIndex) {\n          eventAction = 'icon-button:page-number';\n          eventValue = pageEvent.pageIndex + 1;\n      }\n\n      this.gaService.sendEvent(analyticsEventCategory, eventAction, 'pager', eventValue);\n      */\n\n     // this.page = pageEvent.pageIndex;\n     // this.pageSize = pageEvent.pageSize;\n    }\n\n    this.paged = [];\n\n    if (this.filtered) {\n     for (let i = 0; i < this.filtered.length; i++) {\n       if (this.filtered[i] != null) {\n          this.paged.push(this.filtered[i]);\n       } else {\n          break;\n       }\n     }\n    }\n  }\n\n}\n","<div *ngIf=\"(loadingComplete === true && foundCenterList === false && applicationCount === 0)\">\n  <br>\n  <div class=\"padleft25px colorblue\"><b>No Application Found</b></div>\n  <br>\n</div>\n\n<mat-tab-group (selectedTabChange)=\"applicationTabSelected($event)\">\n  <mat-tab label=\"{{appCenter}}\" *ngFor=\"let appCenter of centerList; let index = index\">\n\n    <div class=\"padtop5px padleft25px font15px colorblue\">\n      <b> {{appCenter}}</b>\n      &nbsp;&nbsp;&nbsp;\n      <span class=\"colorred\">{{loadingStatus}}</span>\n      &nbsp;&nbsp;&nbsp;\n      <!-- Export Button -->\n      <span class=\"export\" *ngIf=\"isAdmin\">\n        <button matTooltip=\"Export Search Results\" mat-button (click)=\"export()\"\n          class=\"mat-button export-button mat-raised-button\">\n          <mat-icon svgIcon=\"get_app\"></mat-icon> Export All Applications\n        </button>\n      </span>\n\n      <!--\n      <a [href]=\"exportUrl\" target=\"_blank\" matTooltip='ApplicationRecords' *ngIf=\"totalRecords > 0\">\n        <button mat-icon-button color=\"primary\">\n          <mat-icon>arrow_downward</mat-icon>Export All Applications\n        </button>\n      </a>\n      -->\n    </div>\n\n    <div class=\"responsive mat-table-style\">\n\n      <!-- Spinner -->\n      <div *ngIf=\"showSpinner\" class=\"spinnerstyle\">\n        <mat-progress-spinner diameter=\"80\" color=\"warn\" mode=\"indeterminate\">\n        </mat-progress-spinner>\n      </div>\n\n      <table mat-table [dataSource]=\"paged\" class=\"font12px\">\n        <ng-container matColumnDef=\"appType\">\n          <th mat-header-cell *matHeaderCellDef> Application Type </th>\n          <td mat-cell *matCellDef=\"let application\">\n            <span *ngIf=\"(application.fromTable && application.fromTable === 'GSRS')\">\n            <a [routerLink]=\"['/application', application.id]\" target=\"_blank\">{{application.appType}}</a>\n            &nbsp;&nbsp;\n            <a [routerLink]=\"['/application', application.id, 'edit']\" target=\"_blank\" *ngIf=\"isAdmin\"\n              matTooltip='Edit GSRS Application Record'>\n              <mat-icon svgIcon=\"edit\"></mat-icon>\n            </a>\n            </span>\n            <span *ngIf=\"application.fromTable && application.fromTable !== 'GSRS'\">\n              <a [routerLink]=\"['/application-darrts', application.appType, application.appNumber]\"\n                target=\"_blank\">{{application.appType}}</a>\n              <br><span class=\"font10px colorgray\">(Integrity)</span>\n            </span>\n          </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"appNumber\">\n          <th mat-header-cell *matHeaderCellDef> Application Number </th>\n          <td mat-cell *matCellDef=\"let application\"> {{application.appNumber}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"productName\">\n          <th mat-header-cell *matHeaderCellDef> Product Name </th>\n          <td mat-cell *matCellDef=\"let application\">\n\n            <div *ngFor=\"let prod of application.applicationProductList; let i = index\">\n              <!-- Product Names-->\n              <div class=\"row\" *ngFor=\"let prodName of prod.applicationProductNameList; let i = index\">\n                {{prodName.productName}}\n              </div>\n            </div>\n          </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"sponsorName\">\n          <th mat-header-cell *matHeaderCellDef> Sponsor Name </th>\n          <td mat-cell *matCellDef=\"let application\"> {{application.sponsorName}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"applicationStatus\">\n          <th mat-header-cell *matHeaderCellDef> Application Status </th>\n          <td mat-cell *matCellDef=\"let application\"> {{application.appStatus}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"applicationSubType\">\n          <th mat-header-cell *matHeaderCellDef> Application Sub Type </th>\n          <td mat-cell *matCellDef=\"let application\"> {{application.appSubType}} </td>\n        </ng-container>\n\n        <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n        <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n      </table>\n    </div>\n    <mat-paginator [length]=\"totalRecords\" [pageSize]=\"5\" showFirstLastButtons=\"true\"\n      (page)=\"getApplicationBySubstanceKeyCenter($event)\" [pageSizeOptions]=\"[5, 10, 25, 100]\">\n    </mat-paginator>\n  </mat-tab>\n</mat-tab-group>\n\n<!--\n</div>\n<ng-template #nocenter>\n  <br>\n  <div class=\"padleft25px colorblue\"><b>No Application Found</b></div>\n  <br>\n</ng-template>\n-->","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\nimport { ActivatedRoute, Router, NavigationExtras } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { PageEvent } from '@angular/material/paginator';\nimport { take } from 'rxjs/operators';\nimport { AuthService } from '@gsrs-core/auth';\nimport { LoadingService } from '@gsrs-core/loading/loading.service';\nimport { GoogleAnalyticsService } from '@gsrs-core/google-analytics';\nimport { FacetParam } from '@gsrs-core/facets-manager';\nimport { ExportDialogComponent } from '@gsrs-core/substances-browse/export-dialog/export-dialog.component';\nimport { ApplicationService } from '../../../application/service/application.service';\nimport { GeneralService } from '../../../service/general.service';\nimport { Application } from '../../../application/model/application.model';\nimport { SubstanceDetailsBaseTableDisplay } from '../../substance-products/substance-details-base-table-display';\nimport { SubstanceCardBaseFilteredList } from '@gsrs-core/substance-details';\n\n@Component({\n  selector: 'app-substance-application',\n  templateUrl: './substance-application.component.html',\n  styleUrls: ['./substance-application.component.scss']\n})\n\nexport class SubstanceApplicationComponent extends SubstanceDetailsBaseTableDisplay implements OnInit {\n\n  application: any;\n  applicationCount = 0;\n  totalApplication = 0;\n  centerList: Array<String> = [];\n  centerListOriginal: Array<String> = [];\n  center = '';\n  fromTable = '';\n  loadingStatus = '';\n  showSpinner = false;\n  foundCenterList = false;\n  loadingComplete = false;\n  // result: any;\n  public privateSearch?: string;\n  private privateFacetParams: FacetParam;\n  privateExport = false;\n  disableExport = false;\n  etag = '';\n  etagAllExport = '';\n  @Input() bdnum: string;\n  @Output() countApplicationOut: EventEmitter<number> = new EventEmitter<number>();\n\n  displayedColumns: string[] = [\n    'appType', 'appNumber', 'productName', 'sponsorName', 'applicationStatus', 'applicationSubType'];\n\n  constructor(\n    private router: Router,\n    public authService: AuthService,\n    private loadingService: LoadingService,\n    public gaService: GoogleAnalyticsService,\n    private applicationService: ApplicationService,\n    private generalService: GeneralService,\n    private dialog: MatDialog\n  ) {\n    super(gaService, applicationService);\n  }\n\n  ngOnInit() {\n    this.authService.hasAnyRolesAsync('Admin', 'Updater', 'SuperUpdater').pipe(take(1)).subscribe(response => {\n      this.isAdmin = response;\n    });\n\n    /*\n    if (this.substance && this.substance.uuid) {\n      alert(this.substance.uuid);\n      this.generalService.getSubstanceCodesBySubstanceUuid(this.substance.uuid).subscribe(results => {\n        if (results) {\n          const substanceCodes = results;\n          for (let index = 0; index < substanceCodes.length; index++) {\n            if (substanceCodes[index].codeSystem === 'BDNUM') {\n                this.bdnum = substanceCodes[index].code;\n                break;\n            }\n          }\n        }\n      });\n    }\n    */\n\n    if (this.bdnum) {\n      this.getApplicationCenterList();\n\n      this.privateSearch = 'root_applicationProductList_applicationIngredientList_substanceKey:'\n        + this.bdnum;\n      this.getApplicationBySubstanceKeyCenter(null, 'initial');\n      // this.getApplicationCenterByBdnum();\n      // this.getSubstanceApplications();\n      // this.applicationListExportUrl();\n    }\n  }\n\n  /*\n  searchApplicationBySubstanceKey(): string {\n    this.applicationService.searchApplicationBySubstanceKey(this.bdnum).subscribe(results => {\n      this.results = results;\n      if (results) {\n    //    const content = results.content;\n     //   if (this.centerList && this.centerList.length > 0) {\n    //      this.foundCenterList = true;\n        }\n        this.loadingComplete = true;\n      }\n    });\n  //  return this.centerList;\n  }\n  */\n\n  /* PLAY FRAMEWORK */\n  /*\n  getApplicationCenterByBdnum(): string {\n    this.applicationService.getApplicationCenterByBdnum(this.bdnum).subscribe(results => {\n      this.centerList = results.centerList;\n      if (this.centerList && this.centerList.length > 0) {\n        this.foundCenterList = true;\n      }\n      this.loadingComplete = true;\n    });\n    return this.centerList;\n  }\n  */\n\n  getApplicationCenterList(): void {\n    this.applicationService.getApplicationCenterList(this.bdnum).subscribe(results => {\n      this.centerListOriginal = results;\n      this.centerList = results;\n      if (this.centerList && this.centerList.length > 0) {\n        this.foundCenterList = true;\n\n        // Replace 'Darrts' to 'Integrity' and 'SRS' to 'GSRS'\n        /* this.centerList.forEach((cent, index) => {\n          if (cent != null) {\n            let centerReplace = '';\n            if (cent.indexOf('Darrts') > 0) {\n              centerReplace = cent.replace('Darrts', 'Integrity');\n            } else if (cent.indexOf('SRS') > 0) {\n              centerReplace = cent.replace('SRS', 'GSRS');\n            }\n\n            if (centerReplace.length > 0) {\n              this.centerList[index] = centerReplace;\n            }\n          }\n        }); */\n      }\n      this.loadingComplete = true;\n    });\n  }\n\n  applicationTabSelected($event) {\n    if ($event) {\n      const evt: any = $event.tab;\n      const textLabel: string = evt.textLabel;\n      // Get Center and fromTable/Source from Tab Label\n      if (textLabel != null) {\n        this.loadingStatus = 'Loading data...';\n        const index = textLabel.indexOf(' ');\n        this.center = textLabel.slice(0, index);\n        this.fromTable = textLabel.slice(index + 1, textLabel.length);\n\n        //let fromReplace = '';\n        /*\n        if (this.fromTable.indexOf('Integrity') >= 0) {\n          fromReplace = this.fromTable.replace('Integrity', 'Darrts');\n        } else if (this.fromTable.indexOf('GSRS') >= 0) {\n          fromReplace = this.fromTable.replace('GSRS', 'SRS');\n        }\n        if (fromReplace && fromReplace.length > 0) {\n          this.fromTable = fromReplace;\n        }\n        */\n      }\n\n      // set the current result data to empty or null.\n      this.paged = [];\n\n      this.privateSearch = 'root_applicationProductList_applicationIngredientList_substanceKey:'\n        + this.bdnum + ' AND root_center:' + this.center + ' AND root_fromTable: ' + this.fromTable;\n\n      this.getApplicationBySubstanceKeyCenter();\n    }\n  }\n\n  /*\n  getApplicationBySubstanceKeyCenter(pageEvent ?: PageEvent): void {\n    this.setPageEvent(pageEvent);\n\n    this.showSpinner = true;  // Start progress spinner\n    // , this.page, this.pageSize\n    this.applicationService.getApplicationBySubstanceKeyCenter(this.bdnum).subscribe(results => {\n      this.setResultData(results.content);\n      this.application = results.content;\n      this.totalApplication = results.total;\n      this.applicationService.totalRecords = results.total;\n      this.etag = results.etag;\n      this.countApplicationOut.emit(this.totalApplication);\n      this.loadingStatus = '';\n      this.showSpinner = false;  // Stop progress spinner\n    });\n  }\n  */\n\n  // GSRS 3.0\n  getApplicationBySubstanceKeyCenter(pageEvent?: PageEvent, searchType?: string) {\n    this.setPageEvent(pageEvent);\n    this.showSpinner = true;  // Start progress spinner\n    const skip = this.page * this.pageSize;\n\n    // if (searchType && searchType === 'initial') {\n    //    this.pageSize = 100;\n    //  }\n    const subscription = this.applicationService.getApplicationAll(\n      'default',\n      skip,\n      this.pageSize,\n      this.privateSearch,\n      this.privateFacetParams\n    )\n      .subscribe(pagingResponse => {\n\n        if (searchType && searchType === 'initial') {\n          this.etagAllExport = pagingResponse.etag;\n        } else {\n          this.applicationService.totalRecords = pagingResponse.total;\n          this.applicationCount = pagingResponse.total;\n\n          this.setResultData(pagingResponse.content);\n\n          this.etag = pagingResponse.etag;\n          this.countApplicationOut.emit(this.applicationCount);\n        }\n      }, error => {\n        console.log('error');\n      }, () => {\n        subscription.unsubscribe();\n      });\n    this.loadingStatus = '';\n    this.showSpinner = false;  // Stop progress spinner\n  }\n\n  /*\n  getSubstanceApplications(pageEvent ?: PageEvent): void {\n    this.setPageEvent(pageEvent);\n\n    this.showSpinner = true;  // Start progress spinner\n    this.applicationService.getSubstanceApplications(this.bdnum, this.center, this.fromTable, this.page, this.pageSize)\n      .subscribe(results => {\n        this.setResultData(results);\n        this.applicationCount = this.totalRecords;\n        this.countApplicationOut.emit(this.applicationCount);\n        this.loadingStatus = '';\n        this.showSpinner = false;  // Stop progress spinner\n      });\n  */\n  /*\n      this.searchControl.valueChanges.subscribe(value => {\n        this.filterList(value, this.clinicaltrials, this.analyticsEventCategory);\n      }, error => {\n        console.log(error);\n      });\n      this.countUpdate.emit(clinicaltrials.length);\n    });\n\n}\n*/\n\n  export() {\n    if (this.etagAllExport) {\n      const extension = 'xlsx';\n      const url = this.getApiExportUrl(this.etagAllExport, extension);\n      if (this.authService.getUser() !== '') {\n        const dialogReference = this.dialog.open(ExportDialogComponent, {\n          height: '215x',\n          width: '550px',\n          data: { 'extension': extension, 'type': 'substanceApplication' }\n        });\n        // this.overlayContainer.style.zIndex = '1002';\n        dialogReference.afterClosed().subscribe(name => {\n          // this.overlayContainer.style.zIndex = null;\n          if (name && name !== '') {\n            this.loadingService.setLoading(true);\n            const fullname = name + '.' + extension;\n            this.authService.startUserDownload(url, this.privateExport, fullname).subscribe(response => {\n              this.loadingService.setLoading(false);\n              const navigationExtras: NavigationExtras = {\n                queryParams: {\n                  totalSub: this.applicationCount\n                }\n              };\n              const params = { 'total': this.applicationCount };\n              this.router.navigate(['/user-downloads/', response.id]);\n            }, error => this.loadingService.setLoading(false));\n          }\n        });\n      }\n    }\n  }\n\n  getApiExportUrl(etag: string, extension: string): string {\n    return this.applicationService.getAppAllApiExportUrl(etag, extension);\n  }\n\n  get updateApplicationUrl(): string {\n    return this.applicationService.getUpdateApplicationUrl();\n  }\n\n  applicationListExportUrl() {\n    if (this.bdnum != null) {\n      this.exportUrl = this.applicationService.getApplicationListExportUrl(this.bdnum);\n    }\n  }\n\n}\n","<div class=\"padtop5px padleft25px font15px colorblue\">\n  <b>Clinical Trial US&nbsp;&nbsp;&nbsp;&nbsp;</b>\n\n  <!-- Export Button -->\n  <span class=\"export\" *ngIf=\"isAdmin\" >\n    <button matTooltip=\"Export Search Results\" mat-button (click)=\"export()\" class=\"mat-button export-button mat-raised-button\">\n      <mat-icon svgIcon=\"get_app\"></mat-icon> Export CTs\n    </button>\n  </span>\n\n</div>\n\n<div class=\"responsive mat-table-style\">\n\n  <!-- Spinner -->\n  <div *ngIf=\"showSpinner\" class=\"spinnerstyle\">\n    <mat-progress-spinner diameter=\"80\" color=\"warn\" mode=\"indeterminate\">\n    </mat-progress-spinner>\n  </div>\n\n  <table mat-table [dataSource]=\"paged\">\n\n    <ng-container matColumnDef=\"edit\">\n      <th mat-header-cell *matHeaderCellDef></th>\n      <td mat-cell *matCellDef=\"let clinical\"> \n        <a class=\"clinical-trials-browse-edit1\" target=\"_blank\" title=\"Edit in new tab\" [href]=\"'edit-clinical-trial/' + clinical.trialNumber\">\n          <mat-icon style=\"width: 20px;  height: 20px;\" svgIcon=\"edit\"></mat-icon>\n        </a>          \n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"nctNumber\">\n      <th mat-header-cell *matHeaderCellDef>Trial Number</th>\n      <td mat-cell *matCellDef=\"let clinical\">\n\n        <a target=\"_blank\" title=\"see clinicaltrials.gov\" [href]=\"'https://clinicaltrials.gov/ct2/show/' + clinical.trialNumber\">{{clinical.trialNumber}}</a>\n        <!--\n        <div *ngIf=\"clinical.fromSource === 'EU'\">\n          <a [routerLink]=\"['/clinicalTrialEuropeDetails', clinical.nctNumber, 'eu']\"\n            target=\"_blank\">{{clinical.nctNumber}}</a>\n          <br><span class=\"font10px colorgray\">(Europe)</span>\n        </div>\n        <div *ngIf=\"clinical.fromSource != 'EU'\">\n          <a [routerLink]=\"['/clinicalTrialDetails', clinical.nctNumber, 'srs']\"\n            target=\"_blank\">{{clinical.nctNumber}}</a>\n        </div>\n      -->\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"title\">\n      <th mat-header-cell *matHeaderCellDef> Title </th>\n      <td mat-cell *matCellDef=\"let clinical\"> {{clinical.title}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"sponsorName\">\n      <th mat-header-cell *matHeaderCellDef> Sponsor Name </th>\n      <td mat-cell *matCellDef=\"let clinical\"> {{clinical.sponsor}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"conditions\">\n      <th mat-header-cell *matHeaderCellDef> Conditions </th>\n      <td mat-cell *matCellDef=\"let clinical\"> {{clinical.conditions}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"outcomemeasures\">\n      <th mat-header-cell *matHeaderCellDef> Outcome Measures </th>\n      <td mat-cell *matCellDef=\"let clinical\"> {{clinical.outcomeMeasures}} </td>\n    </ng-container>\n\n    <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n    <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n  </table>\n</div>\n\n<mat-paginator [length]=\"totalRecords\" [pageSize]=\"5\" showFirstLastButtons=\"true\"\n  (page)=\"getSubstanceClinicalTrials($event)\" [pageSizeOptions]=\"[5, 10, 25, 100]\">\n</mat-paginator>","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\nimport { SubstanceCardBaseFilteredList } from '@gsrs-core/substance-details';\nimport { GoogleAnalyticsService } from '@gsrs-core/google-analytics';\nimport { ClinicalTrialService } from '../../../clinical-trials/clinical-trial/clinical-trial.service';\nimport { SubstanceDetailsBaseTableDisplay } from '../../substance-products/substance-details-base-table-display';\nimport { PageEvent } from '@angular/material/paginator';\nimport { FacetParam } from '@gsrs-core/facets-manager';\nimport { ActivatedRoute, Router, NavigationExtras } from '@angular/router';\nimport { Subscription, Observable, Subject } from 'rxjs';\nimport { MatDialog } from '@angular/material/dialog';\nimport { AuthService } from '@gsrs-core/auth';\nimport { LoadingService } from '@gsrs-core/loading/loading.service';\nimport { ConfigService, LoadedComponents } from '@gsrs-core/config';\nimport { ExportDialogComponent } from '@gsrs-core/substances-browse/export-dialog/export-dialog.component';\nimport { take } from 'rxjs/operators';\n\n\n@Component({\n  selector: 'app-substance-clinical-trials',\n  templateUrl: './substance-clinical-trials.component.html',\n  styleUrls: ['./substance-clinical-trials.component.scss']\n})\n\nexport class SubstanceClinicalTrialsComponent extends SubstanceDetailsBaseTableDisplay implements OnInit {\n\n  private privateFacetParams: FacetParam;\n  clinicalTrialCount = 0;\n  showSpinner = false;\n  private subscriptions: Array<Subscription> = [];\n\n  privateExport = false;\n  disableExport = false;\n  etag = '';\n  etagAllExport = '';\n  loadedComponents: LoadedComponents;\n  loadingStatus = '';\n\n  @Input() substanceUuid: string;\n  @Output() countClinicalTrialOut: EventEmitter<number> = new EventEmitter<number>();\n\n  displayedColumns: string[] = [\n    'edit',\n    'nctNumber',\n    'title',\n    'sponsorName',\n    'conditions',\n    'outcomemeasures'\n  ];\n\n  constructor(\n    public gaService: GoogleAnalyticsService,\n    private clinicalTrialService: ClinicalTrialService,\n    private configService: ConfigService,\n    public authService: AuthService,\n    private loadingService: LoadingService,\n    private router: Router,\n    private dialog: MatDialog \n  ) {\n    super(gaService, clinicalTrialService);\n  }\n\n  ngOnInit() {\n    this.loadedComponents = this.configService.configData.loadedComponents || null;\n    this.authService.hasAnyRolesAsync('Admin', 'Updater', 'SuperUpdater').pipe(take(1)).subscribe(response => {\n      this.isAdmin = response;\n    });\n    if (this.substanceUuid) {\n     this.getSubstanceClinicalTrials(null, 'initial');\n    }\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach(subscription => {\n      subscription.unsubscribe();\n    });\n  }\n\n  getSubstanceClinicalTrials(pageEvent?: PageEvent, searchType?: string): void {\n    this.setPageEvent(pageEvent);\n    const skip = this.page * this.pageSize;\n    this.showSpinner = true;  // Start progress spinner\n    const subscriptionClinical = this.clinicalTrialService.getClinicalTrials({\n      searchTerm: this.substanceUuid,\n      cutoff: null,\n      type: \"substanceKey\",\n      order: '$trialNumber',\n      pageSize: this.pageSize,\n      facets: this.privateFacetParams,\n      skip: skip\n    })\n      .subscribe(pagingResponse => {\n        if (searchType && searchType === 'initial') {\n          this.etagAllExport = pagingResponse.etag;\n        } \n        // AW removed else clause so this runs every time. \n        // This makes it work, but AW might need to understand the \n        // intention better. \n        // else {\n        this.clinicalTrialService.totalRecords = pagingResponse.total;\n        this.setResultData(pagingResponse.content);\n        this.clinicalTrialCount = pagingResponse.total;\n        this.etag = pagingResponse.etag;\n        // }    \n\n        this.countClinicalTrialOut.emit(this.clinicalTrialCount);\n        this.showSpinner = false;  // Stop progress spinner\n      });\n\n    /*\n        this.searchControl.valueChanges.subscribe(value => {\n          this.filterList(value, this.clinicaltrials, this.analyticsEventCategory);\n        }, error => {\n          console.log(error);\n        });\n        this.countUpdate.emit(clinicaltrials.length);\n      });\n      */\n     this.subscriptions.push(subscriptionClinical);\n  }\n\n\n  export() {\n    if (this.etagAllExport) {\n      const extension = 'ctus.xlsx';\n      const url = this.getApiExportUrl(this.etagAllExport, extension);\n      if (this.authService.getUser() !== '') {\n        const dialogReference = this.dialog.open(ExportDialogComponent, {\n          height: '215x',\n          width: '550px',\n          data: { 'extension': extension, 'type': 'substanceClinicalTrialUS' }\n        });\n        // this.overlayContainer.style.zIndex = '1002';\n        dialogReference.afterClosed().subscribe(name => {\n          // this.overlayContainer.style.zIndex = null;\n          if (name && name !== '') {\n            this.loadingService.setLoading(true);\n            const fullname = name + '.' + extension;\n            this.authService.startUserDownload(url, this.privateExport, fullname).subscribe(response => {\n              this.loadingService.setLoading(false);\n              const navigationExtras: NavigationExtras = {\n                queryParams: {\n                  totalSub: this.clinicalTrialCount\n                }\n              };\n              const params = { 'total': this.clinicalTrialCount };\n              this.router.navigate(['/user-downloads/', response.id]);\n            }, error => this.loadingService.setLoading(false));\n          }\n        });\n      }\n    }\n  }\n\n  getApiExportUrl(etag: string, extension: string): string {\n    return this.clinicalTrialService.getApiExportUrl(etag, extension);\n  }\n\n\n\n  clinicalTrialListExportUrl() {\n    if (this.substanceUuid != null) {\n      this.exportUrl = this.clinicalTrialService.getClinicalTrialListExportUrl(this.substanceUuid);\n    }\n  }\n\n  /*\n  // copied from products but has no effect. Make approaoch uniform in future. \n  tabSelected($event) {\n    if ($event) {\n      console.log(\"EVENT\");\n      const evt: any = $event.tab;\n      const textLabel: string = evt.textLabel;\n      if (textLabel != null) {\n        this.loadingStatus = 'Loading data...';\n        this.paged = [];\n        this.getSubstanceClinicalTrials();\n      }\n\n    }\n  }\n*/\n\n}\n","<div class=\"padtop5px padleft25px font15px colorblue\">\n  <b>Clinical Trials Europe</b>\n  &nbsp;&nbsp;&nbsp;\n\n  <!-- Export Button -->\n  <span class=\"export\" *ngIf=\"isAdmin\" >\n    <button matTooltip=\"Export Search Results\" mat-button (click)=\"export()\" class=\"mat-button export-button mat-raised-button\">\n      <mat-icon svgIcon=\"get_app\"></mat-icon> Export CTs\n    </button>\n  </span>\n</div>\n\n<div class=\"responsive mat-table-style\">\n  <!-- Spinner -->\n  <div *ngIf=\"showSpinner\" class=\"spinnerstyle\">\n    <mat-progress-spinner diameter=\"80\" color=\"warn\" mode=\"indeterminate\">\n    </mat-progress-spinner>\n  </div>\n\n  <table mat-table [dataSource]=\"paged\">\n\n    <ng-container  matColumnDef=\"trialNumber\">\n      <th mat-header-cell *matHeaderCellDef>Eudract Number</th>\n      <td mat-cell *matCellDef=\"let clinical\">\n        <div *ngIf=\"clinical.trialNumber\">\n          <a href=\"{{clinical.url}}\">{{clinical.trialNumber}}</a>          \n        </div>\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"title\">\n      <th mat-header-cell *matHeaderCellDef> Title </th>\n      <td mat-cell *matCellDef=\"let clinical\"> {{clinical.title}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"sponsorName\">\n      <th mat-header-cell *matHeaderCellDef> Sponsor Name </th>\n      <td mat-cell *matCellDef=\"let clinical\"> {{clinical.sponsorName}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"conditions\">\n      <th mat-header-cell *matHeaderCellDef>Conditions</th>\n      <td mat-cell *matCellDef=\"let clinical\">{{joinMeddraTerms(clinical)}}</td>\n    </ng-container>\n\n    <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n    <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n  </table>\n</div>\n\n<mat-paginator [length]=\"totalRecords\" [pageSize]=\"5\" showFirstLastButtons=\"true\"\n  (page)=\"getSubstanceClinicalTrialsEurope($event)\" [pageSizeOptions]=\"[5, 10, 25, 100]\">\n</mat-paginator>\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\nimport { SubstanceCardBaseFilteredList } from '@gsrs-core/substance-details';\nimport { GoogleAnalyticsService } from '@gsrs-core/google-analytics';\nimport { ClinicalTrialService } from '../../../clinical-trials/clinical-trial/clinical-trial.service';\nimport { SubstanceDetailsBaseTableDisplay } from '../../substance-products/substance-details-base-table-display';\nimport { PageEvent } from '@angular/material/paginator';\nimport { FacetParam } from '@gsrs-core/facets-manager';\nimport { ActivatedRoute, Router, NavigationExtras } from '@angular/router';\nimport { Subscription, Observable, Subject } from 'rxjs';\nimport { MatDialog } from '@angular/material/dialog';\nimport { AuthService } from '@gsrs-core/auth';\nimport { LoadingService } from '@gsrs-core/loading/loading.service';\nimport { ConfigService, LoadedComponents } from '@gsrs-core/config';\nimport { ExportDialogComponent } from '@gsrs-core/substances-browse/export-dialog/export-dialog.component';\nimport { take } from 'rxjs/operators';\nimport * as _ from 'lodash';\n\n@Component({\n  selector: 'app-substance-clinical-trials-eu',\n  templateUrl: './substance-clinical-trials-eu.component.html',\n  styleUrls: ['./substance-clinical-trials-eu.component.scss']\n})\n\nexport class SubstanceClinicalTrialsEuropeComponent extends SubstanceDetailsBaseTableDisplay implements OnInit {\n  private privateFacetParams: FacetParam;\n  clinicalTrialEuCount = 0;\n  showSpinner = false;\n  private subscriptions: Array<Subscription> = [];\n\n  privateExport = false;\n  disableExport = false;\n  etag = '';\n  etagAllExport = '';\n  loadedComponents: LoadedComponents;\n  loadingStatus = '';\n\n  @Input() substanceUuid: string;\n  @Output() countClinicalTrialEuOut: EventEmitter<number> = new EventEmitter<number>();\n\n  displayedColumns: string[] = [\n    'trialNumber',\n    'title',\n    'sponsorName',\n    'conditions'\n  ];\n\n  constructor(\n    public gaService: GoogleAnalyticsService,\n    private clinicalTrialService: ClinicalTrialService,\n    private configService: ConfigService,\n    public authService: AuthService,\n    private loadingService: LoadingService,\n    private router: Router,\n    private dialog: MatDialog \n  ) {\n    super(gaService, clinicalTrialService);\n  }\n\n  ngOnInit() {\n    this.loadedComponents = this.configService.configData.loadedComponents || null;\n    this.authService.hasAnyRolesAsync('Admin', 'Updater', 'SuperUpdater').pipe(take(1)).subscribe(response => {\n      this.isAdmin = response;\n    });\n    if (this.substanceUuid) {\n     this.getSubstanceClinicalTrialsEurope(null, 'initial');\n    }\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach(subscription => {\n      subscription.unsubscribe();\n    });\n  }\n\n  getSubstanceClinicalTrialsEurope(pageEvent?: PageEvent, searchType?: string): void {\n    this.setPageEvent(pageEvent);\n    this.showSpinner = true;  // Start progress spinner\n    const subscriptionClinical = this.clinicalTrialService.getSubstanceClinicalTrialsEurope(\n      this.substanceUuid, this.page, this.pageSize\n    )\n      .subscribe(pagingResponse => {\n        if (searchType && searchType === 'initial') {\n          this.etagAllExport = pagingResponse['etag'];\n        } \n        this.setResultData(pagingResponse['content']);\n        this.clinicalTrialEuCount = pagingResponse['total'];\n        this.countClinicalTrialEuOut.emit(this.clinicalTrialEuCount);\n        this.showSpinner = false;  // Stop progress spinner\n      });\n    /*\n        this.searchControl.valueChanges.subscribe(value => {\n          this.filterList(value, this.clinicaltrials, this.analyticsEventCategory);\n        }, error => {\n          console.log(error);\n        });\n        this.countUpdate.emit(clinicaltrials.length);\n      });\n      */\n     this.subscriptions.push(subscriptionClinical);\n  }\n\n\n  export() {\n    if (this.etagAllExport) {\n      const extension = 'cteu.xlsx';\n      const url = this.getApiExportUrl(this.etagAllExport, extension);\n      if (this.authService.getUser() !== '') {\n        const dialogReference = this.dialog.open(ExportDialogComponent, {\n          height: '215x',\n          width: '550px',\n          data: { 'extension': extension, 'type': 'substanceClinicalTrialEU' }\n        });\n        // this.overlayContainer.style.zIndex = '1002';\n        dialogReference.afterClosed().subscribe(name => {\n          // this.overlayContainer.style.zIndex = null;\n          if (name && name !== '') {\n            this.loadingService.setLoading(true);\n            const fullname = name + '.' + extension;\n            this.authService.startUserDownload(url, this.privateExport, fullname).subscribe(response => {\n              this.loadingService.setLoading(false);\n              const navigationExtras: NavigationExtras = {\n                queryParams: {\n                  totalSub: this.clinicalTrialEuCount\n                }\n              };\n              const params = { 'total': this.clinicalTrialEuCount };\n              this.router.navigate(['/user-downloads/', response.id]);\n            }, error => this.loadingService.setLoading(false));\n          }\n        });\n      }\n    }\n  }\n\n  getApiExportUrl(etag: string, extension: string): string {\n    return this.clinicalTrialService.getApiEuropeExportUrl(etag, extension);\n  }\n\n\n// delete this? \n//  clinicalTrialListExportUrl() {\n//    if (this.substanceUuid != null) {\n//      this.exportUrl = this.clinicalTrialService.getClinicalTrialEuropeListExportUrl(this.substanceUuid);\n//    }\n//  }\n\n  /*\n  // copied from products but has no effect. Make approaoch uniform in future. \n  tabSelected($event) {\n    if ($event) {\n      console.log(\"EVENT\");\n      const evt: any = $event.tab;\n      const textLabel: string = evt.textLabel;\n      if (textLabel != null) {\n        this.loadingStatus = 'Loading data...';\n        this.paged = [];\n        this.getSubstanceClinicalTrials();\n      }\n\n  */\n  joinMeddraTerms(cteu: any) {\n    if(cteu) {\n      // const a =[{\"meddraTerm\": \"meddraTerm1\"}, {\"meddraTerm\": \"meddraTerm2\"},{\"meddraTerm\": \"meddraTerm3\"},{\"meddraTerm\": \"meddraTerm4\"}];\n      return _.map(cteu.clinicalTrialEuropeMeddraList, 'meddraTerm').join(\"|\");\n    }\n  } \n}","<div class=\"padtop5px padleft25px font15px colorblue\">\n\n  <div class=\"divflex\">\n    <div class=\"padtop10px\">\n      <b>Adverse Event PT</b>\n    </div>\n    <div class=\"marginleft50px padleft25px padtopneg50px width120px\" *ngIf=\"totalRecords > 0\">\n      <!--\n      <a [href]=\"exportUrl\" target=\"_blank\" matTooltip='Adverse Event PT Records'>\n        <button mat-icon-button color=\"primary\">\n          <mat-icon>arrow_downward</mat-icon>Export\n        </button>\n      </a>\n      -->\n      <!-- Export Button -->\n      <span class=\"export\" *ngIf=\"isAdmin && adverseEventCount > 0\">\n        <button matTooltip=\"Export Search Results\" mat-button (click)=\"export()\"\n          class=\"mat-button export-button mat-raised-button\">\n          <mat-icon svgIcon=\"get_app\"></mat-icon> Export\n        </button>\n      </span>\n    </div>\n    <div class=\"marginleft50px padleft25px width200px\" *ngIf=\"adverseEventShinySubstanceNameDisplay === true\">\n      <a href=\"{{adverseEventShinySubstanceNameURLWithParam}}\" target=\"_blank\">\n        <button mat-icon-button color=\"accent\" aria-label=\"Analysis by Substance Name on Shiny Server\">\n          <mat-icon>analytics</mat-icon><span class=\"colororange\">Analysis by Substance</span>\n        </button>\n      </a>\n    </div>\n  </div>\n\n  <div class=\"responsive mat-table-style\">\n\n    <!-- SPINNER -->\n    <div *ngIf=\"showSpinner\" class=\"spinnerstyle\">\n      <mat-progress-spinner diameter=\"80\" color=\"warn\" mode=\"indeterminate\">\n      </mat-progress-spinner>\n    </div>\n\n    <table mat-table [dataSource]=\"paged\" matSort (matSortChange)=\"sortData($event)\" matSortActive=\"ptCount\"\n      matSortDirection=\"desc\" matSortDisableClear>\n\n      <ng-container matColumnDef=\"ptTerm\">\n        <th mat-header-cell *matHeaderCellDef mat-sort-header> PT Term </th>\n        <td mat-cell *matCellDef=\"let adverse\">\n          {{adverse.ptTerm}}\n          <span class=\"\" *ngIf=\"adverseEventShinyAdverseEventDisplay === true\">\n            <a href=\"{{adverseEventShinyAdverseEventURLWithParam}}{{getDecodeURL(adverse.ptTerm)}}\" target=\"_blank\"\n              title=\"Analysis by Adverse Event/PT Term on Shiny Server\">\n              <mat-icon>analytics</mat-icon>\n            </a>\n          </span>\n        </td>\n      </ng-container>\n\n      <ng-container matColumnDef=\"primSoc\">\n        <th mat-header-cell *matHeaderCellDef mat-sort-header> Prim SOC </th>\n        <td mat-cell *matCellDef=\"let adverse\"> {{adverse.primSoc}} </td>\n      </ng-container>\n\n      <ng-container matColumnDef=\"caseCount\">\n        <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Count </th>\n        <td mat-cell *matCellDef=\"let adverse\"> {{adverse.caseCount}}</td>\n      </ng-container>\n\n      <ng-container matColumnDef=\"ptCount\">\n        <th mat-header-cell *matHeaderCellDef mat-sort-header> PT Count </th>\n        <td mat-cell *matCellDef=\"let adverse\">\n          <div *ngIf=\"FAERSDashboardAdverseEventUrl; else noFaersLink\">\n            <a href=\"{{FAERSDashboardAdverseEventUrl}}{{getDecodeURL(adverse.ptTerm | titlecase)}}{{FAERSDashboardReactionGroup}}{{getDecodeURL(adverse.primSoc | titlecase)}}\"\n              target=\"_blank\" title=\"FAERS Public Dashboard\">\n              <div [innerHTML]=\"adverse.ptCount\"></div>\n            </a>\n            <span class=\"colorgray font10px\">FAERS Public Dashboard</span>\n          </div>\n          <ng-template #noFaersLink>\n            <div [innerHTML]=\"adverse.ptCount\"></div>\n          </ng-template>\n        </td>\n      </ng-container>\n\n      <ng-container matColumnDef=\"prr\">\n        <th mat-header-cell *matHeaderCellDef mat-sort-header> PRR </th>\n        <td mat-cell *matCellDef=\"let adverse\"> {{adverse.prr | number : '.2-2'}} </td>\n      </ng-container>\n\n      <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n      <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n    </table>\n  </div>\n  <mat-paginator [length]=\"totalRecords\" [pageSize]=\"5\" showFirstLastButtons=\"true\" (page)=\"getAdverseEventPt($event)\"\n    [pageSizeOptions]=\"[5, 10, 25, 100]\">\n  </mat-paginator>","import { Component, OnInit, OnDestroy, Output, EventEmitter, Input } from '@angular/core';\nimport { TitleCasePipe } from '@angular/common';\nimport { ActivatedRoute, Router, NavigationExtras } from '@angular/router';\nimport { PageEvent } from '@angular/material/paginator';\nimport { MatDialog } from '@angular/material/dialog';\nimport { GoogleAnalyticsService } from '@gsrs-core/google-analytics';\nimport { AdverseEventService } from '../../../../adverse-event/service/adverseevent.service';\nimport { SubstanceDetailsBaseTableDisplay } from '../../../substance-products/substance-details-base-table-display';\nimport { Sort } from '@angular/material/sort';\nimport { LoadingService } from '@gsrs-core/loading/loading.service';\nimport { ConfigService } from '@gsrs-core/config';\nimport { FacetParam } from '@gsrs-core/facets-manager';\nimport { ExportDialogComponent } from '@gsrs-core/substances-browse/export-dialog/export-dialog.component';\nimport { AuthService } from '@gsrs-core/auth';\nimport { Subscription } from 'rxjs';\nimport { adverseEventPtSearchSortValues } from '../../../../adverse-event/adverse-events-pt-browse/adverse-events-pt-search-sort-values';\n\n@Component({\n  selector: 'app-substance-adverseeventpt',\n  templateUrl: './substance-adverseeventpt.component.html',\n  styleUrls: ['./substance-adverseeventpt.component.scss']\n})\n\nexport class SubstanceAdverseEventPtComponent extends SubstanceDetailsBaseTableDisplay implements OnInit, OnDestroy {\n  @Input() bdnum: string;\n  @Input() substanceName: string;\n  @Output() countAdvPtOut: EventEmitter<number> = new EventEmitter<number>();\n\n  adverseEventCount = 0;\n  order = '$root_ptCount';\n  ascDescDir = 'desc';\n  showSpinner = false;\n  public privateSearchTerm?: string;\n  private privateFacetParams: FacetParam;\n  public sortValues = adverseEventPtSearchSortValues;\n  privateExport = false;\n  disableExport = false;\n  etag = '';\n  loadingStatus = '';\n  private subscriptions: Array<Subscription> = [];\n\n  adverseEventShinySubstanceNameDisplay = false;\n  adverseEventShinyAdverseEventDisplay = false;\n  adverseEventShinySubstanceNameURL: string;\n  adverseEventShinyAdverseEventURL: string;\n  adverseEventShinySubstanceNameURLWithParam: string;\n  adverseEventShinyAdverseEventURLWithParam: string;\n\n  // FAERS DASHBOARD\n  FAERSDashboardAdverseEventUrl: string;\n  FAERSDashboardSubstanceName: string;\n  FAERSDashboardSearchTerm = \"/select/Search%20Term/\"; // FAERS Adverse Event 'Substance Name'\n  FAERSDashboardReactionTerm = \"/select/Reaction%20Term/\"; // GSRS Adverse Event 'PT Term'\n  FAERSDashboardReactionGroup = \"/select/Reaction%20Group/\"; // GSRS Adverse Event 'Prim SOC'\n\n  filtered: Array<any>;\n  displayedColumns: string[] = [\n    'ptTerm',\n    'primSoc',\n    'caseCount',\n    'ptCount',\n    'prr'\n  ];\n  constructor(\n    private router: Router,\n    public gaService: GoogleAnalyticsService,\n    private adverseEventService: AdverseEventService,\n    private loadingService: LoadingService,\n    private configService: ConfigService,\n    private authService: AuthService,\n    private dialog: MatDialog\n  ) {\n    super(gaService, adverseEventService);\n  }\n\n  ngOnInit() {\n    const rolesSubscription = this.authService.hasAnyRolesAsync('Admin', 'Updater', 'SuperUpdater').subscribe(response => {\n      this.isAdmin = response;\n    });\n    this.subscriptions.push(rolesSubscription);\n\n    if (this.bdnum) {\n      this.getAdverseEventPt();\n\n      // FAERS DASHBOARD\n      this.getFaersDashboardUrl();\n      this.getFaersDashboardRecordByName();\n\n      this.adverseEventPtListExportUrl();\n      this.getAdverseEventShinyConfig();\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.forEach(subscription => {\n      subscription.unsubscribe();\n    });\n  }\n\n  getAdverseEventPt(pageEvent?: PageEvent) {\n    this.setPageEvent(pageEvent);\n    this.showSpinner = true;  // Start progress spinner\n    const skip = this.page * this.pageSize;\n    const privateSearch = 'root_substanceKey:' + this.bdnum;\n    const subscription = this.adverseEventService.getAdverseEventPt(\n      this.order,\n      skip,\n      this.pageSize,\n      privateSearch,\n      this.privateFacetParams\n    )\n      .subscribe(pagingResponse => {\n        this.adverseEventService.totalRecords = pagingResponse.total;\n        this.adverseEventCount = pagingResponse.total;\n        this.setResultData(pagingResponse.content);\n        this.etag = pagingResponse.etag;\n        this.countAdvPtOut.emit(this.adverseEventCount);\n      }, error => {\n        console.log('error');\n      }, () => {\n        subscription.unsubscribe();\n      });\n    this.loadingStatus = '';\n    this.showSpinner = false;  // Stop progress spinner\n  }\n\n  /*\n  getSubstanceAdverseEventPt(pageEvent?: PageEvent): void {\n    this.setPageEvent(pageEvent);\n    this.showSpinner = true;  // Start progress spinner\n    this.adverseEventService.getSubstanceAdverseEventPtAdv(this.bdnum, this.page, this.pageSize,\n      this.orderBy, this.ascDescDir).subscribe(results => {\n        this.setResultData(results);\n        this.advPtCount = this.totalRecords;\n        this.countAdvPtOut.emit(this.advPtCount);\n        this.showSpinner = false;  // Stop progress spinner\n      });\n  }\n  */\n\n  adverseEventPtListExportUrl() {\n    if (this.bdnum != null) {\n      this.exportUrl = this.adverseEventService.getAdverseEventPtListExportUrl(this.bdnum);\n    }\n  }\n\n  sortData(sort: Sort) {\n    if (sort.active) {\n      const orderIndex = this.displayedColumns.indexOf(sort.active).toString(); // + 2; // Adding 2, for name and bdnum.\n      this.ascDescDir = sort.direction;\n      this.sortValues.forEach(sortValue => {\n        if (sortValue.displayedColumns && sortValue.direction) {\n          if (this.displayedColumns[orderIndex] === sortValue.displayedColumns && this.ascDescDir === sortValue.direction) {\n            this.order = sortValue.value;\n          }\n        }\n      });\n      this.getAdverseEventPt();\n    }\n    return;\n  }\n\n  export() {\n    if (this.etag) {\n      const extension = 'xlsx';\n      const url = this.getApiExportUrl(this.etag, extension);\n      if (this.authService.getUser() !== '') {\n        const dialogReference = this.dialog.open(ExportDialogComponent, {\n          height: '215x',\n          width: '550px',\n          data: { 'extension': extension, 'type': 'substanceAdverseEventPt' }\n        });\n        // this.overlayContainer.style.zIndex = '1002';\n        dialogReference.afterClosed().subscribe(name => {\n          // this.overlayContainer.style.zIndex = null;\n          if (name && name !== '') {\n            this.loadingService.setLoading(true);\n            const fullname = name + '.' + extension;\n            this.authService.startUserDownload(url, this.privateExport, fullname).subscribe(response => {\n              this.loadingService.setLoading(false);\n              const navigationExtras: NavigationExtras = {\n                queryParams: {\n                  totalSub: this.adverseEventCount\n                }\n              };\n              const params = { 'total': this.adverseEventCount };\n              this.router.navigate(['/user-downloads/', response.id]);\n            }, error => this.loadingService.setLoading(false));\n          }\n        });\n      }\n    }\n  }\n\n  getApiExportUrl(etag: string, extension: string): string {\n    return this.adverseEventService.getApiExportUrlPt(etag, extension);\n  }\n\n  getFaersDashboardRecordByName(): void {\n    // Get FAERS Name from database table that contains 'P' and 'G' in name.\n    // Example: Acetazolamide (G) instead of GSRS name Acetazolamide\n    const faersNameSubscription = this.adverseEventService.getFaersDashboardRecordByName(this.substanceName).subscribe(results => {\n      if (results) {\n        if (results.name) {\n          this.FAERSDashboardSubstanceName = results.name;\n          this.FAERSDashboardAdverseEventUrl = this.FAERSDashboardAdverseEventUrl + results.name + this.FAERSDashboardReactionTerm;\n        }\n      }\n    });\n    this.subscriptions.push(faersNameSubscription);\n  }\n\n  getFaersDashboardUrl(): void {\n    if (this.configService.configData) {\n      if (this.configService.configData.FAERSDashboardAdverseEventUrl\n        && this.configService.configData.FAERSDashboardAdverseEventUrl !== null) {\n        const faersUrlConfig = this.configService.configData.FAERSDashboardAdverseEventUrl;\n\n        // FULL FAERS DASHBOARD URL\n        // faersUrl + /select/Search%20Term/ + FaersName + /select/Reaction%20Term/ + ptTerm + /select/Reaction%20Group/ + primSoc;\n        this.FAERSDashboardAdverseEventUrl = faersUrlConfig + this.FAERSDashboardSearchTerm;\n      }\n    }\n  }\n\n  getAdverseEventShinyConfig(): void {\n    if (this.configService.configData) {\n\n      // Analysis by Substance in Shiny Config\n      if (this.configService.configData.adverseEventShinySubstanceNameDisplay\n        && this.configService.configData.adverseEventShinySubstanceNameDisplay !== null) {\n        this.adverseEventShinySubstanceNameDisplay = JSON.parse(this.configService.configData.adverseEventShinySubstanceNameDisplay);\n      }\n      if (this.configService.configData.adverseEventShinySubstanceNameURL\n        && this.configService.configData.adverseEventShinySubstanceNameURL !== null) {\n        this.adverseEventShinySubstanceNameURL = this.configService.configData.adverseEventShinySubstanceNameURL;\n        this.adverseEventShinySubstanceNameURLWithParam = this.adverseEventShinySubstanceNameURL + decodeURIComponent(this.substanceName);\n      }\n\n      // Analysis by Adverse Event in Shiny Config\n      if (this.configService.configData.adverseEventShinyAdverseEventDisplay\n        && this.configService.configData.adverseEventShinyAdverseEventDisplay !== null) {\n        this.adverseEventShinyAdverseEventDisplay = JSON.parse(this.configService.configData.adverseEventShinyAdverseEventDisplay);\n      }\n      if (this.configService.configData.adverseEventShinyAdverseEventURL\n        && this.configService.configData.adverseEventShinyAdverseEventURL !== null) {\n        this.adverseEventShinyAdverseEventURL = this.configService.configData.adverseEventShinyAdverseEventURL;\n        this.adverseEventShinyAdverseEventURLWithParam = this.adverseEventShinyAdverseEventURL;\n      }\n\n    }\n  }\n\n  getDecodeURL(value: string): string {\n    let result = '';\n    if (value !== null) {\n      result = decodeURIComponent(value);\n    }\n    return result;\n  }\n\n}\n\n","<div class=\"padtop5px padleft25px font15px colorblue\">\n  <b>Adverse Event DME</b>\n  &nbsp;&nbsp;&nbsp;\n  <!--\n  <a [href]=\"exportUrl\" target=\"_blank\" matTooltip='Adverse Event DME Records' *ngIf=\"totalRecords > 0\">\n    <button mat-icon-button color=\"primary\">\n      <mat-icon>arrow_downward</mat-icon>Export\n    </button>\n  </a>\n  -->\n  <!-- Export Button -->\n  <span class=\"export\" *ngIf=\"isAdmin && adverseEventCount > 0\">\n    <button matTooltip=\"Export Search Results\" mat-button (click)=\"export()\"\n      class=\"mat-button export-button mat-raised-button\">\n      <mat-icon svgIcon=\"get_app\"></mat-icon> Export\n    </button>\n  </span>\n</div>\n<!--\n<div class=\"flex-row\">\n  <span class=\"middle-fill\"></span>\n  <mat-form-field [floatLabel]=\"'never'\" class=\"search\">\n    <input matInput placeholder=\"Search\" [formControl]=\"searchControl\">\n  </mat-form-field>\n</div>\n-->\n<div class=\"responsive mat-table-style\">\n\n  <!-- SPINNER -->\n  <div *ngIf=\"showSpinner\" class=\"spinnerstyle\">\n    <mat-progress-spinner diameter=\"80\" color=\"warn\" mode=\"indeterminate\">\n    </mat-progress-spinner>\n  </div>\n\n  <table mat-table [dataSource]=\"paged\" matSort (matSortChange)=\"sortData($event)\" matSortActive=\"dmeCount\"\n    matSortDirection=\"desc\" matSortDisableClear>\n\n    <ng-container matColumnDef=\"dmeReactions\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> DME Reactions </th>\n      <td mat-cell *matCellDef=\"let adverse\"> {{adverse.dmeReactions}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"ptTermMeddra\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> PT Term Meddra </th>\n      <td mat-cell *matCellDef=\"let adverse\"> {{adverse.ptTermMeddra}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"caseCount\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Count </th>\n      <td mat-cell *matCellDef=\"let adverse\"> {{adverse.caseCount}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"dmeCount\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Dme Count </th>\n      <td mat-cell *matCellDef=\"let adverse\"> {{adverse.dmeCount}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"dmeCountPercent\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Dme Count Percent </th>\n      <td mat-cell *matCellDef=\"let adverse\"> {{adverse.dmeCountPercent}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"weightedAvgPrr\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Weighted Average PRR</th>\n      <td mat-cell *matCellDef=\"let adverse\"> {{adverse.weightedAvgPrr | number : '.2-2'}} </td>\n    </ng-container>\n\n    <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n    <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n  </table>\n</div>\n<mat-paginator [length]=\"totalRecords\" [pageSize]=\"5\" showFirstLastButtons=\"true\" (page)=\"getAdverseEventDme($event)\"\n  [pageSizeOptions]=\"[5, 10, 25, 100]\">\n</mat-paginator>","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\nimport { ActivatedRoute, Router, NavigationExtras } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Sort } from '@angular/material/sort';\nimport { SubstanceCardBaseFilteredList } from '@gsrs-core/substance-details';\nimport { GoogleAnalyticsService } from '@gsrs-core/google-analytics';\nimport { AdverseEventService } from '../../../../adverse-event/service/adverseevent.service';\nimport { SubstanceDetailsBaseTableDisplay } from '../../../substance-products/substance-details-base-table-display';\nimport { PageEvent } from '@angular/material/paginator';\nimport { FacetParam } from '@gsrs-core/facets-manager';\nimport { ExportDialogComponent } from '@gsrs-core/substances-browse/export-dialog/export-dialog.component';\nimport { AuthService } from '@gsrs-core/auth';\nimport { LoadingService } from '@gsrs-core/loading/loading.service';\nimport { Subscription } from 'rxjs';\nimport { adverseEventDmeSearchSortValues } from '../../../../adverse-event/adverse-events-dme-browse/adverse-events-dme-search-sort-values';\n\n@Component({\n  selector: 'app-substance-adverseeventdme',\n  templateUrl: './substance-adverseeventdme.component.html',\n  styleUrls: ['./substance-adverseeventdme.component.scss']\n})\n\nexport class SubstanceAdverseEventDmeComponent extends SubstanceDetailsBaseTableDisplay implements OnInit {\n\n  @Input() bdnum: string;\n  @Output() countAdvDmeOut: EventEmitter<number> = new EventEmitter<number>();\n\n  adverseEventCount = 0;\n  order = '$root_dmeCount';\n  ascDescDir = 'desc';\n  showSpinner = false;\n  public privateSearchTerm?: string;\n  private privateFacetParams: FacetParam;\n  privateExport = false;\n  disableExport = false;\n  etag = '';\n  loadingStatus = '';\n  public sortValues = adverseEventDmeSearchSortValues;\n  private subscriptions: Array<Subscription> = [];\n\n  displayedColumns: string[] = [\n    'dmeReactions', 'ptTermMeddra', 'caseCount', 'dmeCount', 'dmeCountPercent', 'weightedAvgPrr'\n  ];\n\n  constructor(\n    private router: Router,\n    public gaService: GoogleAnalyticsService,\n    private adverseEventService: AdverseEventService,\n    private authService: AuthService,\n    private loadingService: LoadingService,\n    private dialog: MatDialog\n  ) {\n    super(gaService, adverseEventService);\n  }\n\n  ngOnInit() {\n    const rolesSubscription = this.authService.hasAnyRolesAsync('Admin', 'Updater', 'SuperUpdater').subscribe(response => {\n      this.isAdmin = response;\n    });\n    this.subscriptions.push(rolesSubscription);\n\n    if (this.bdnum) {\n      this.getAdverseEventDme();\n      // this.getSubstanceAdverseEventDme();\n      this.adverseEventDmeListExportUrl();\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.forEach(subscription => {\n      subscription.unsubscribe();\n    });\n  }\n\n  getAdverseEventDme(pageEvent?: PageEvent) {\n    this.setPageEvent(pageEvent);\n    this.showSpinner = true;  // Start progress spinner\n    const skip = this.page * this.pageSize;\n    const privateSearch = 'root_substanceKey:' + this.bdnum;\n    const subscription = this.adverseEventService.getAdverseEventDme(\n      this.order,\n      skip,\n      this.pageSize,\n      privateSearch,\n      this.privateFacetParams\n    )\n      .subscribe(pagingResponse => {\n        this.adverseEventService.totalRecords = pagingResponse.total;\n        this.adverseEventCount = pagingResponse.total;\n        this.setResultData(pagingResponse.content);\n        this.etag = pagingResponse.etag;\n        this.countAdvDmeOut.emit(this.adverseEventCount);\n      }, error => {\n        console.log('error');\n      }, () => {\n        subscription.unsubscribe();\n      });\n    this.loadingStatus = '';\n    this.showSpinner = false;  // Stop progress spinner\n  }\n\n  /*\n  getSubstanceAdverseEventDme(pageEvent?: PageEvent): void {\n    this.setPageEvent(pageEvent);\n\n    this.showSpinner = true;  // Start progress spinner\n    this.adverseEventService.getSubstanceAdverseEventDme(this.bdnum, this.page, this.pageSize).subscribe(results => {\n      this.setResultData(results);\n      this.advDmeCount = this.totalRecords;\n      this.countAdvDmeOut.emit(this.advDmeCount);\n      this.showSpinner = false;  // Stop progress spinner\n    });\n  }\n  */\n\n  sortData(sort: Sort) {\n    if (sort.active) {\n      const orderIndex = this.displayedColumns.indexOf(sort.active).toString();\n      this.ascDescDir = sort.direction;\n      this.sortValues.forEach(sortValue => {\n        if (sortValue.displayedColumns && sortValue.direction) {\n          if (this.displayedColumns[orderIndex] === sortValue.displayedColumns && this.ascDescDir === sortValue.direction) {\n            this.order = sortValue.value;\n          }\n        }\n      });\n      this.getAdverseEventDme();\n    }\n    return;\n  }\n\n  export() {\n    if (this.etag) {\n      const extension = 'xlsx';\n      const url = this.getApiExportUrl(this.etag, extension);\n      if (this.authService.getUser() !== '') {\n        const dialogReference = this.dialog.open(ExportDialogComponent, {\n          height: '215x',\n          width: '550px',\n          data: { 'extension': extension, 'type': 'substanceAdverseEventDme' }\n        });\n        // this.overlayContainer.style.zIndex = '1002';\n        dialogReference.afterClosed().subscribe(name => {\n          // this.overlayContainer.style.zIndex = null;\n          if (name && name !== '') {\n            this.loadingService.setLoading(true);\n            const fullname = name + '.' + extension;\n            this.authService.startUserDownload(url, this.privateExport, fullname).subscribe(response => {\n              this.loadingService.setLoading(false);\n              const navigationExtras: NavigationExtras = {\n                queryParams: {\n                  totalSub: this.adverseEventCount\n                }\n              };\n              const params = { 'total': this.adverseEventCount };\n              this.router.navigate(['/user-downloads/', response.id]);\n            }, error => this.loadingService.setLoading(false));\n          }\n        });\n      }\n    }\n  }\n\n  getApiExportUrl(etag: string, extension: string): string {\n    return this.adverseEventService.getApiExportUrlDme(etag, extension);\n  }\n\n  adverseEventDmeListExportUrl() {\n    if (this.bdnum != null) {\n      this.exportUrl = this.adverseEventService.getAdverseEventDmeListExportUrl(this.bdnum);\n    }\n  }\n\n}\n","<div class=\"padtop5px padleft25px font15px colorblue\">\n  <b>Adverse Event CVM</b>\n  &nbsp;&nbsp;&nbsp;\n  <!--\n  <a [href]=\"exportUrl\" target=\"_blank\" matTooltip='Adverse Event CVM Records' *ngIf=\"totalRecords > 0\">\n    <button mat-icon-button color=\"primary\">\n      <mat-icon>arrow_downward</mat-icon>Export\n    </button>\n  </a>\n  -->\n  <!-- Export Button -->\n  <span class=\"export\" *ngIf=\"isAdmin && adverseEventCount > 0\">\n    <button matTooltip=\"Export Search Results\" mat-button (click)=\"export()\"\n      class=\"mat-button export-button mat-raised-button\">\n      <mat-icon svgIcon=\"get_app\"></mat-icon> Export\n    </button>\n  </span>\n</div>\n\n<!--\n<div class=\"flex-row\">\n  <span class=\"middle-fill\"></span>d\n  <mat-form-field [floatLabel]=\"'never'\" class=\"search\">\n    <input matInput placeholder=\"Search\" [formControl]=\"searchControl\">\n  </mat-form-field>\n</div>\n-->\n\n<div class=\"responsive mat-table-style\">\n\n  <!-- Spinner -->\n  <div *ngIf=\"showSpinner\" class=\"spinnerstyle\">\n    <mat-progress-spinner diameter=\"80\" color=\"warn\" mode=\"indeterminate\">\n    </mat-progress-spinner>\n  </div>\n\n  <table mat-table [dataSource]=\"paged\" matSort (matSortChange)=\"sortData($event)\" matSortActive=\"adverseEventCount\"\n    matSortDirection=\"desc\" matSortDisableClear>\n\n    <ng-container matColumnDef=\"adverseEvent\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Adverse Event </th>\n      <td mat-cell *matCellDef=\"let adverse\"> {{adverse.adverseEvent}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"species\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Species </th>\n      <td mat-cell *matCellDef=\"let adverse\"> {{adverse.species}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"adverseEventCount\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Adverse Event Count </th>\n      <td mat-cell *matCellDef=\"let adverse\"> {{adverse.aeCount}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"routeOfAdmin\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Route of Administration </th>\n      <td mat-cell *matCellDef=\"let adverse\"> {{adverse.routeOfAdmin}} </td>\n    </ng-container>\n\n    <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n    <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n  </table>\n</div>\n<mat-paginator [length]=\"totalRecords\" [pageSize]=\"5\" showFirstLastButtons=\"true\" (page)=\"getAdverseEventCvm($event)\"\n  [pageSizeOptions]=\"[5, 10, 25, 100]\">\n</mat-paginator>","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\nimport { ActivatedRoute, Router, NavigationExtras } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Sort } from '@angular/material/sort';\nimport { SubstanceCardBaseFilteredList } from '@gsrs-core/substance-details';\nimport { GoogleAnalyticsService } from '@gsrs-core/google-analytics';\nimport { AdverseEventService } from '../../../../adverse-event/service/adverseevent.service';\nimport { SubstanceDetailsBaseTableDisplay } from '../../../substance-products/substance-details-base-table-display';\nimport { PageEvent } from '@angular/material/paginator';\nimport { FacetParam } from '@gsrs-core/facets-manager';\nimport { ExportDialogComponent } from '@gsrs-core/substances-browse/export-dialog/export-dialog.component';\nimport { AuthService } from '@gsrs-core/auth';\nimport { LoadingService } from '@gsrs-core/loading/loading.service';\nimport { Subscription } from 'rxjs';\nimport { adverseEventCvmSearchSortValues } from '../../../../adverse-event/adverse-events-cvm-browse/adverse-events-cvm-search-sort-values';\n\n@Component({\n  selector: 'app-substance-adverseeventcvm',\n  templateUrl: './substance-adverseeventcvm.component.html',\n  styleUrls: ['./substance-adverseeventcvm.component.scss']\n})\n\nexport class SubstanceAdverseEventCvmComponent extends SubstanceDetailsBaseTableDisplay implements OnInit {\n\n  @Input() bdnum: string;\n  @Output() countAdvCvmOut: EventEmitter<number> = new EventEmitter<number>();\n\n  adverseEventCount = 0;\n  order = '$root_aeCount';\n  ascDescDir = 'desc';\n  showSpinner = false;\n  public privateSearchTerm?: string;\n  private privateFacetParams: FacetParam;\n  privateExport = false;\n  disableExport = false;\n  etag = '';\n  loadingStatus = '';\n  public sortValues = adverseEventCvmSearchSortValues;\n  private subscriptions: Array<Subscription> = [];\n\n  displayedColumns: string[] = [\n    'adverseEvent', 'species', 'adverseEventCount', 'routeOfAdmin'\n  ];\n\n  constructor(\n    private router: Router,\n    public gaService: GoogleAnalyticsService,\n    private adverseEventService: AdverseEventService,\n    private authService: AuthService,\n    private loadingService: LoadingService,\n    private dialog: MatDialog\n  ) {\n    super(gaService, adverseEventService);\n  }\n\n  ngOnInit() {\n    const rolesSubscription = this.authService.hasAnyRolesAsync('Admin', 'Updater', 'SuperUpdater').subscribe(response => {\n      this.isAdmin = response;\n    });\n    this.subscriptions.push(rolesSubscription);\n    if (this.bdnum) {\n      this.getAdverseEventCvm();\n      // this.getSubstanceAdverseEventCvm();\n      this.adverseEventCvmListExportUrl();\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.forEach(subscription => {\n      subscription.unsubscribe();\n    });\n  }\n\n  getAdverseEventCvm(pageEvent?: PageEvent) {\n    this.setPageEvent(pageEvent);\n    this.showSpinner = true;  // Start progress spinner\n    const skip = this.page * this.pageSize;\n    const privateSearch = 'root_substanceKey:' + this.bdnum;\n    const subscription = this.adverseEventService.getAdverseEventCvm(\n      this.order,\n      skip,\n      this.pageSize,\n      privateSearch,\n      this.privateFacetParams\n    )\n      .subscribe(pagingResponse => {\n        this.adverseEventService.totalRecords = pagingResponse.total;\n        this.adverseEventCount = pagingResponse.total;\n        this.setResultData(pagingResponse.content);\n        this.etag = pagingResponse.etag;\n        this.countAdvCvmOut.emit(this.adverseEventCount);\n      }, error => {\n        console.log('error');\n      }, () => {\n        subscription.unsubscribe();\n      });\n    this.loadingStatus = '';\n    this.showSpinner = false;  // Stop progress spinner\n  }\n\n  sortData(sort: Sort) {\n    if (sort.active) {\n      const orderIndex = this.displayedColumns.indexOf(sort.active).toString(); // + 2; // Adding 2, for name and bdnum.\n      this.ascDescDir = sort.direction;\n      this.sortValues.forEach(sortValue => {\n        if (sortValue.displayedColumns && sortValue.direction) {\n          if (this.displayedColumns[orderIndex] === sortValue.displayedColumns && this.ascDescDir === sortValue.direction) {\n            this.order = sortValue.value;\n          }\n        }\n      });\n      this.getAdverseEventCvm();\n    }\n    return;\n  }\n\n  export() {\n    if (this.etag) {\n      const extension = 'xlsx';\n      const url = this.getApiExportUrl(this.etag, extension);\n      if (this.authService.getUser() !== '') {\n        const dialogReference = this.dialog.open(ExportDialogComponent, {\n          height: '215x',\n          width: '550px',\n          data: { 'extension': extension, 'type': 'substanceAdverseEventCvm' }\n        });\n        // this.overlayContainer.style.zIndex = '1002';\n        dialogReference.afterClosed().subscribe(name => {\n          // this.overlayContainer.style.zIndex = null;\n          if (name && name !== '') {\n            this.loadingService.setLoading(true);\n            const fullname = name + '.' + extension;\n            this.authService.startUserDownload(url, this.privateExport, fullname).subscribe(response => {\n              this.loadingService.setLoading(false);\n              const navigationExtras: NavigationExtras = {\n                queryParams: {\n                  totalSub: this.adverseEventCount\n                }\n              };\n              const params = { 'total': this.adverseEventCount };\n              this.router.navigate(['/user-downloads/', response.id]);\n            }, error => this.loadingService.setLoading(false));\n          }\n        });\n      }\n    }\n  }\n\n  getApiExportUrl(etag: string, extension: string): string {\n    return this.adverseEventService.getApiExportUrlCvm(etag, extension);\n  }\n\n  adverseEventCvmListExportUrl() {\n    if (this.bdnum != null) {\n      this.exportUrl = this.adverseEventService.getAdverseEventCvmListExportUrl(this.bdnum);\n    }\n  }\n\n}\n\n","<div class=\"padtop5px padleft25px font15px colorblue\">\n  <b>Impurities Specs</b>\n  &nbsp;&nbsp;&nbsp;\n  <!-- Export Button -->\n  <span class=\"export\" *ngIf=\"isAdmin\">\n    <button matTooltip=\"Export Search Results\" mat-button (click)=\"export()\"\n      class=\"mat-button export-button mat-raised-button\">\n      <mat-icon svgIcon=\"get_app\"></mat-icon> Export\n    </button>\n  </span>\n\n  <!--\n  <a [href]=\"exportUrl\" target=\"_blank\" matTooltip='Export Impurities Records' *ngIf=\"totalRecords > 0\">\n    <button mat-icon-button color=\"primary\">\n      <mat-icon>arrow_downward</mat-icon>Export\n    </button>\n  </a>\n  -->\n</div>\n\n<div class=\"responsive mat-table-style\">\n  <!-- Spinner -->\n  <div *ngIf=\"showSpinner\" class=\"spinnerstyle\">\n    <mat-progress-spinner diameter=\"80\" color=\"warn\" mode=\"indeterminate\">\n    </mat-progress-spinner>\n  </div>\n\n  <table mat-table [dataSource]=\"paged\">\n\n    <ng-container matColumnDef=\"productName\">\n      <th mat-header-cell *matHeaderCellDef class=\"width100px\">Product/Substance Name</th>\n      <td mat-cell *matCellDef=\"let impurities\">\n        <div *ngIf=\"impurities.id\">\n          <a [routerLink]=\"['/impurities', impurities.id]\" target=\"_blank\">\n            <div *ngIf=\"impurities.productSubstanceName; else noProdName\">{{impurities.productSubstanceName}}</div>\n            <ng-template #noProdName>\n              View\n            </ng-template>\n          </a>\n          &nbsp;&nbsp;\n          <a [routerLink]=\"['/impurities', impurities.id, 'edit']\" target=\"_blank\" *ngIf=\"isAdmin\"\n            matTooltip='Edit Impurities Record'>\n            <mat-icon svgIcon=\"edit\"></mat-icon>\n          </a>\n        </div>\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"sourceType\">\n      <th mat-header-cell *matHeaderCellDef class=\"width100px\"> Source Type</th>\n      <td mat-cell *matCellDef=\"let impurities\"> {{impurities.sourceType}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"source\">\n      <th mat-header-cell *matHeaderCellDef class=\"width100px\"> Source </th>\n      <td mat-cell *matCellDef=\"let impurities\"> {{impurities.source}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"sourceid\">\n      <th mat-header-cell *matHeaderCellDef class=\"width100px\"> Source ID</th>\n      <td mat-cell *matCellDef=\"let impurities\"> {{impurities.sourceId}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"type\">\n      <th mat-header-cell *matHeaderCellDef class=\"width100px\"> Type </th>\n      <td mat-cell *matCellDef=\"let impurities\"> {{impurities.type}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"specType\">\n      <th mat-header-cell *matHeaderCellDef class=\"width100px\"> Spec Type </th>\n      <td mat-cell *matCellDef=\"let impurities\"> {{impurities.specType}} </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"parentSubstance\">\n      <th mat-header-cell *matHeaderCellDef class=\"width100px\"> Parent Substance </th>\n      <td mat-cell *matCellDef=\"let impurities\">\n        <div *ngFor=\"let impSub of impurities.impuritiesSubstanceList; let subIndex = index\">\n          <a [routerLink]=\"['/substances', impSub._parentSubstanceUuid]\" target=\"_blank\">\n            <span class=\"colorblue\">{{impSub._parentSubstanceName}}</span>\n          </a>\n        </div>\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"relatedSubstance\">\n      <th mat-header-cell *matHeaderCellDef class=\"width100px\"> Impurities Related Substance</th>\n      <td mat-cell *matCellDef=\"let impurities\">\n        <div *ngFor=\"let impSub of impurities.impuritiesSubstanceList; let subIndex = index\">\n          <!-- Impurities Substance Name is same as current display Substance Name -->\n          <!--\n          <div *ngIf=\"impSub.substanceUuid === substanceUuid\">\n          -->\n          <!--\n            <b>{{substanceName}}</b><br>\n            -->\n          <div *ngFor=\"let impTest of impSub.impuritiesTestList; let testIndex = index\">\n            <!--\n            <ol>\n            -->\n            <div *ngFor=\"let impDetail of impTest.impuritiesDetailsList; let detIndex = index\" class=\"font12px\">\n              <div *ngIf=\"impDetail.relatedSubstanceUuid === substanceUuid\">\n                <!--<b>{{substanceName}}</b>-->\n                <!--\n                  <li>\n                    <a [routerLink]=\"['/substances', impDetail.relatedSubstanceUuid]\"\n                    target=\"_blank\"><b>{{impDetail._ingredientName}}</b></a>\n                    -->\n                <span class=\"colorgreen\">\n                  <span *ngIf=\"impDetail.limitType\">&nbsp;&nbsp;&nbsp;&nbsp;{{impDetail.limitType}}&nbsp;</span>\n                  {{impDetail.limitValue}}&nbsp;{{impDetail.unit}}\n                </span>\n                <span *ngIf=\"impDetail.impurityType\"\n                  class=\"colorpurple\"><br>&nbsp;&nbsp;&nbsp;&nbsp;{{impDetail.impurityType}}\n                </span>\n                <!--\n                  </li>\n                    -->\n              </div>\n            </div> <!-- ngFor impDetail -->\n            <!--\n            </ol>\n          -->\n          </div> <!-- ngFor impTest -->\n\n          <!--\n          </div>\n          -->\n          <!-- impSub.substanceUuid == substanceUuid -->\n\n        </div>\n      </td>\n    </ng-container>\n\n    <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n    <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n  </table>\n</div>\n\n<mat-paginator [length]=\"totalRecords\" [pageSize]=\"5\" showFirstLastButtons=\"true\"\n  (page)=\"getImpuritiesBySubstanceUuid($event)\" [pageSizeOptions]=\"[5, 10, 25, 100]\">\n</mat-paginator>","import { Component, OnInit, OnDestroy, Input, Output, EventEmitter } from '@angular/core';\nimport { ActivatedRoute, Router, NavigationExtras } from '@angular/router';\nimport { PageEvent } from '@angular/material/paginator';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Subscription } from 'rxjs';\nimport { take } from 'rxjs/operators';\nimport { ConfigService } from '@gsrs-core/config';\nimport { LoadingService } from '@gsrs-core/loading/loading.service';\nimport { AuthService } from '@gsrs-core/auth';\nimport { GoogleAnalyticsService } from '@gsrs-core/google-analytics';\nimport { ImpuritiesService } from '../../../impurities/service/impurities.service';\nimport { GeneralService } from '../../../service/general.service';\nimport { SubstanceCardBaseFilteredList } from '@gsrs-core/substance-details';\nimport { SubstanceDetailsBaseTableDisplay } from '../substance-details-base-table-display';\nimport { Impurities, ImpuritiesTesting, ImpuritiesDetails, IdentityCriteria } from '../../../impurities/model/impurities.model';\nimport { Facet } from '@gsrs-core/facets-manager';\nimport { FacetParam, FacetHttpParams, FacetQueryResponse } from '@gsrs-core/facets-manager';\nimport { ExportDialogComponent } from '@gsrs-core/substances-browse/export-dialog/export-dialog.component';\n\n@Component({\n  selector: 'app-substance-impurities',\n  templateUrl: './substance-impurities.component.html',\n  styleUrls: ['./substance-impurities.component.scss']\n})\nexport class SubstanceImpuritiesComponent extends SubstanceDetailsBaseTableDisplay implements OnInit, OnDestroy {\n\n  @Input() substanceUuid: string;\n  @Input() substanceName: string;\n  @Output() countImpuritiesOut: EventEmitter<number> = new EventEmitter<number>();\n  private subscriptions: Array<Subscription> = [];\n  parentSubstance: string;\n  parentSubstanceUuid: string;\n  showSpinner = false;\n  impurities: Array<Impurities>;\n  totalImpurities = 0;\n  impuritiesCount = 0;\n  impuritiesTestTotal = 0;\n  pageIndex = 0;\n  pageSize = 5;\n  public privateSearchTerm?: string;\n  private privateFacetParams: FacetParam;\n  privateExport = false;\n  disableExport = false;\n  etag = '';\n  displayedColumns: string[] = [\n    'productName',\n    'sourceType',\n    'source',\n    'sourceid',\n    'type',\n    'specType',\n    'parentSubstance',\n    'relatedSubstance'\n  ];\n\n  constructor(\n    private router: Router,\n    public gaService: GoogleAnalyticsService,\n    private impuritiesService: ImpuritiesService,\n    private generalService: GeneralService,\n    private authService: AuthService,\n    private loadingService: LoadingService,\n    private dialog: MatDialog\n  ) {\n    super(gaService, impuritiesService);\n  }\n\n  ngOnInit() {\n    const rolesSubscription = this.authService.hasAnyRolesAsync('Admin', 'Updater', 'SuperUpdater').subscribe(response => {\n      this.isAdmin = response;\n    });\n    this.subscriptions.push(rolesSubscription);\n\n    if (this.substanceUuid) {\n      this.getImpuritiesBySubstanceUuid();\n      this.impuritiesListExportUrl();\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.forEach(subscription => {\n      if (subscription) {\n        subscription.unsubscribe();\n      }\n    });\n  }\n\n  /*\n  getSubstanceImpuritiesNEW(pageEvent?: PageEvent): void {\n    this.setPageEvent(pageEvent);\n\n    this.showSpinner = true;  // Start progress spinner\n    this.impuritiesService.searchImpurities(this.substanceUuid, this.page, this.pageSize).subscribe(results => {\n      this.setResultData(results);\n      this.impurities = results;\n      this.getImpuritiesTestTotal();\n      this.impuritiesCount = this.totalRecords;\n      this.countImpuritiesOut.emit(this.impuritiesCount);\n      this.showSpinner = false;  // Stop progress spinner\n    });\n  }\n  */\n\n  searchImpurities() {\n    this.privateSearchTerm = this.substanceUuid;\n    //  this.loadingService.setLoading(true);\n    const skip = this.pageIndex * this.pageSize;\n    const subscription = this.impuritiesService.searchImpurities(\n      skip,\n      this.pageSize,\n      this.privateSearchTerm,\n      this.privateFacetParams,\n    )\n      .subscribe(pagingResponse => {\n        // this.isError = false;\n\n        this.setResultData(pagingResponse.content);\n        this.impurities = pagingResponse.content;\n        this.impuritiesCount = pagingResponse.total;\n        this.countImpuritiesOut.emit(this.impuritiesCount);\n        this.etag = pagingResponse.etag;\n\n        /*\n        if (pagingResponse.total % this.pageSize === 0) {\n          this.lastPage = (pagingResponse.total / this.pageSize);\n        } else {\n          this.lastPage = Math.floor(pagingResponse.total / this.pageSize + 1);\n        }\n        */\n        // Set Facets from paging response\n        /*  if (pagingResponse.facets && pagingResponse.facets.length > 0) {\n            this.rawFacets = pagingResponse.facets;\n          }\n          */\n      }, error => {\n        /*\n         console.log('error');\n         const notification: AppNotification = {\n           message: 'There was an error trying to retrieve Products. Please refresh and try again.',\n           type: NotificationType.error,\n           milisecondsToShow: 6000\n         };\n         this.isError = true;\n         this.isLoading = false;\n         this.loadingService.setLoading(this.isLoading);\n         this.notificationService.setNotification(notification);\n         */\n      }, () => {\n        subscription.unsubscribe();\n        //   this.isLoading = false;\n        //   this.loadingService.setLoading(this.isLoading);\n      });\n  }\n\n  getImpuritiesBySubstanceUuid(pageEvent?: PageEvent): void {\n    this.setPageEvent(pageEvent);\n\n    this.showSpinner = true;  // Start progress spinner\n    // , this.page, this.pageSize\n    this.impuritiesService.getImpuritiesBySubstanceUuid(this.substanceUuid).subscribe(results => {\n      this.impuritiesService.totalRecords = results.total;\n      this.impurities = results.content;\n\n      // Load Impurities Test Details by Substance Uuid\n      this.loadImpuritiesTestDetails();\n\n      this.setResultData(this.impurities);\n\n      this.totalImpurities = results.total;\n\n      this.etag = results.etag;\n      this.countImpuritiesOut.emit(this.totalImpurities);\n    });\n    this.showSpinner = false;  // Stop progress spinner\n  }\n\n  /*\n  getImpuritiesByTestImpuritiesDetails(pageEvent?: PageEvent): void {\n    this.setPageEvent(pageEvent);\n\n    this.showSpinner = true;  // Start progress spinner\n    // , this.page, this.pageSize\n    this.impuritiesService.getImpuritiesBySubstanceUuid(this.substanceUuid).subscribe(results => {\n      this.impuritiesService.totalRecords = results.total;\n      this.impurities = results.content;\n\n      //Load Impurities Test Details by Substance Uuid\n      this.loadImpuritiesTestDetails();\n\n      this.setResultData(this.impurities);\n\n      this.totalImpurities = results.total;\n\n      this.etag = results.etag;\n      this.countImpuritiesOut.emit(this.totalImpurities);\n    });\n    this.showSpinner = false;  // Stop progress spinner\n  }\n  */\n\n  loadImpuritiesTestDetails() {\n    this.impurities.forEach((element, index) => {\n      element.impuritiesSubstanceList.forEach((elementSub, indexSub) => {\n\n        if (elementSub.substanceUuid) {\n          // if current Substance is same as Parent Substance of Impurities\n          if (elementSub.substanceUuid === this.substanceUuid) {\n            elementSub._parentSubstanceName = this.substanceName;\n            elementSub._parentSubstanceUuid = elementSub.substanceUuid;\n          }\n        }\n        elementSub.impuritiesTestList.forEach((elementTest, indexTest) => {\n\n          elementTest.impuritiesDetailsList.forEach((elementDetail, indexDetail) => {\n\n            if (elementDetail.relatedSubstanceUuid != null) {\n              // if current Substance is same as Impurities Details of Impurities\n              if (elementDetail.relatedSubstanceUuid === this.substanceUuid) {\n                const subSubscription = this.generalService.getSubstanceNamesBySubstanceUuid(elementSub.substanceUuid).subscribe(substanceNames => {\n                  let subNames = substanceNames;\n\n                  // Get Preferred Term or DisplayName == true\n                  subNames.forEach((names, index) => {\n                    if (names.displayName === true) {\n                      elementSub._parentSubstanceName = names.name;\n                      elementSub._parentSubstanceUuid = elementSub.substanceUuid;\n                    }\n                  });\n                });\n                this.subscriptions.push(subSubscription);\n              }\n            }\n          }); // Impurities Details forEach\n        }); // Test forEach\n      }); // Substance forEach\n    }); // Impurities forEach\n  }\n\n  getSubstanceNames(substanceUuid: string): string {\n    let preferredTerm;\n    if (substanceUuid) {\n      const subSubscription = this.generalService.getSubstanceNamesBySubstanceUuid(substanceUuid).subscribe(substanceNames => {\n        let subNames = substanceNames;\n\n        // Get Preferred Term or DisplayName == true\n        subNames.forEach((names, index) => {\n          if (names.displayName === true) {\n            preferredTerm = names.name;\n          }\n        });\n      });\n      this.subscriptions.push(subSubscription);\n      return preferredTerm;\n    }\n  }\n\n  /*\n  getSubstanceImpurities(pageEvent?: PageEvent): void {\n    this.setPageEvent(pageEvent);\n\n    this.showSpinner = true;  // Start progress spinner\n    this.impuritiesService.getSubstanceImpurities(this.substanceUuid, this.page, this.pageSize).subscribe(results => {\n      this.setResultData(results);\n      this.impurities = results;\n      this.impuritiesCount = this.totalRecords;\n      this.impuritiesService.totalRecords = this.totalRecords;\n      this.countImpuritiesOut.emit(this.impuritiesCount);\n      this.showSpinner = false;  // Stop progress spinner\n    });\n  }\n  */\n\n  export() {\n    if (this.etag) {\n      const extension = 'xlsx';\n      const url = this.getApiExportUrl(this.etag, extension);\n      if (this.authService.getUser() !== '') {\n        const dialogReference = this.dialog.open(ExportDialogComponent, {\n          height: '215x',\n          width: '550px',\n          data: { 'extension': extension, 'type': 'substanceImpurities' }\n        });\n        // this.overlayContainer.style.zIndex = '1002';\n        dialogReference.afterClosed().subscribe(name => {\n          // this.overlayContainer.style.zIndex = null;\n          if (name && name !== '') {\n            this.loadingService.setLoading(true);\n            const fullname = name + '.' + extension;\n            this.authService.startUserDownload(url, this.privateExport, fullname).subscribe(response => {\n              this.loadingService.setLoading(false);\n              const navigationExtras: NavigationExtras = {\n                queryParams: {\n                  totalSub: this.totalImpurities\n                }\n              };\n              const params = { 'total': this.totalImpurities };\n              this.router.navigate(['/user-downloads/', response.id]);\n            }, error => this.loadingService.setLoading(false));\n          }\n        });\n      }\n    }\n  }\n\n  getApiExportUrl(etag: string, extension: string): string {\n    return this.impuritiesService.getApiExportUrl(etag, extension);\n  }\n\n  impuritiesListExportUrl() {\n    if (this.substanceUuid != null) {\n      this.exportUrl = this.impuritiesService.getImpuritiesListExportUrl(this.substanceUuid);\n    }\n  }\n\n}\n","<div class=\"info-container\">\n  <a *ngIf=\"substance && substance.uuid\" aria-label=\"FDA details\" [href]=\"baseDomain + '/ginas/app/substance/' + substance.uuid + '#fdadetails'\"\n    target=\"_blank\">\n    <!-- COMMENTING THIS OUT SINCE WE DO NOT HAVE CLASSIC VIEW IN 3.0\n    For data export, sorting and searching of the tabs below please use the classic view here\n    -->\n  </a>\n</div>\n<div class=\"bordergray mat-tab-style\">\n  <mat-tab-group>\n\n    <mat-tab label=\"Product ({{productCount}})\" *ngIf = \"loadedComponents && loadedComponents.products\">\n\n      <div *ngIf=\"(loadingComplete === true && foundProvenanceList === false && productCount === 0)\">\n        <br>\n        <div class=\"padleft25px colorblue\"><b>No Product Found</b></div>\n        <br>\n      </div>\n      <mat-tab-group (selectedTabChange)=\"tabSelected($event)\">\n        <mat-tab label=\"{{prov}}\" *ngFor=\"let prov of provenanceList; let index = index\">\n          <div class=\"padtop5px padleft25px font15px colorblue\">\n            <b> {{prov}}</b>\n            &nbsp;&nbsp;&nbsp;\n            <span class=\"colorred\">{{loadingStatus}}</span>\n            &nbsp;&nbsp;&nbsp;\n            <!--\n            <a [href]=\"exportUrl\" target=\"_blank\" matTooltip='Product Records' *ngIf=\"totalRecords > 0\">\n              <button mat-icon-button color=\"primary\">\n                <mat-icon>arrow_downward</mat-icon>Export All Products\n              </button>\n            </a>\n            -->\n            <!-- Export Button -->\n            <span class=\"export\" *ngIf=\"isAdmin\">\n              <button matTooltip=\"Export Search Results\" mat-button (click)=\"export()\"\n                class=\"mat-button export-button mat-raised-button\">\n                <mat-icon svgIcon=\"get_app\"></mat-icon> Export All Products\n              </button>\n            </span>\n          </div>\n\n          <div class=\"responsive mat-table-style\">\n\n            <div *ngIf=\"showSpinner\" class=\"spinnerstyle\">\n              <mat-progress-spinner diameter=\"80\" color=\"warn\" mode=\"indeterminate\">\n              </mat-progress-spinner>\n            </div>\n\n            <table mat-table [dataSource]=\"paged\" class=\"font12px\">\n\n              <ng-container matColumnDef=\"productId\">\n                <th mat-header-cell *matHeaderCellDef> Product ID </th>\n                <td mat-cell *matCellDef=\"let product\">\n                  <span *ngIf=\"product.fromtable === 'GSRS'\">\n                    <a [routerLink]=\"['/product', product.productId]\" target=\"_blank\">\n                      <span *ngIf=\"product.productNDC; else noProdNDCGSRS\">\n                        {{product.productNDC}}\n                      </span>\n                      <ng-template #noProdNDCGSRS>\n                        (NO NDC)\n                      </ng-template>\n                    </a>\n                    &nbsp;&nbsp;\n                    <a [routerLink]=\"['/product', product.productId, 'edit']\" target=\"_blank\" *ngIf=\"isAdmin\"\n                      matTooltip='Edit GSRS Product Record'>\n                      <mat-icon svgIcon=\"edit\"></mat-icon>\n                    </a>\n                  </span>\n                  <span *ngIf=\"product.fromtable != 'GSRS'\">\n                    <a [routerLink]=\"['/product-elist', product.productId]\" target=\"_blank\">\n                      <span *ngIf=\"product.productNDC; else noProdNDC\">\n                        {{product.productNDC}}\n                      </span>\n                      <ng-template #noProdNDC>\n                        (NO NDC)\n                      </ng-template>\n                    </a>\n                    <br><span class=\"font10px colorgray\">({{product.fromtable}})</span>\n                  </span>\n                </td>\n              </ng-container>\n\n              <ng-container matColumnDef=\"productName\">\n                <th mat-header-cell *matHeaderCellDef> Product Name </th>\n                <td mat-cell *matCellDef=\"let product\">\n                  <div *ngFor=\"let prodName of product.productNameAllList; let i = index\">\n                    {{prodName.productName}}\n                  </div>\n                </td>\n              </ng-container>\n\n              <ng-container matColumnDef=\"labelerName\">\n                <th mat-header-cell *matHeaderCellDef> Labeler Name </th>\n                <td mat-cell *matCellDef=\"let product\"> {{product.labelerName}}\n                  <div *ngFor=\"let prodComp of product.productCompanyAllList; let i = index\">\n                    {{prodComp.labelerName}}\n                  </div>\n                </td>\n              </ng-container>\n\n              <ng-container matColumnDef=\"country\">\n                <th mat-header-cell *matHeaderCellDef> Country </th>\n                <td mat-cell *matCellDef=\"let product\">\n                  <div *ngFor=\"let prodComp of product.productCompanyAllList; let i = index\">\n                    {{prodComp.countryWithoutCode}}\n                  </div>\n                </td>\n              </ng-container>\n\n              <ng-container matColumnDef=\"status\">\n                <th mat-header-cell *matHeaderCellDef> Status </th>\n                <td mat-cell *matCellDef=\"let product\"> {{product.status}} </td>\n              </ng-container>\n\n              <ng-container matColumnDef=\"productNameType\">\n                <th mat-header-cell *matHeaderCellDef> Product Type </th>\n                <td mat-cell *matCellDef=\"let product\"> {{product.productType}} </td>\n              </ng-container>\n\n              <ng-container matColumnDef=\"ingredientType\">\n                <th mat-header-cell *matHeaderCellDef> Ingredient Type </th>\n                <td mat-cell *matCellDef=\"let product\">\n                  <div *ngFor=\"let prodIng of product.productIngredientAllList; let i = index\">\n                    <div *ngIf=\"prodIng.substanceUuid\">\n                      <div *ngIf=\"(substance.uuid === prodIng.substanceUuid)\">\n                        {{prodIng.ingredientType}}\n                      </div>\n                    </div>\n                  </div>\n                </td>\n              </ng-container>\n\n              <ng-container matColumnDef=\"applicationNumber\">\n                <th mat-header-cell *matHeaderCellDef> Application Number </th>\n                <td mat-cell *matCellDef=\"let product\"> {{product.appTypeNumber}} </td>\n              </ng-container>\n\n              <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n              <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n            </table>\n          </div>\n          <mat-paginator [length]=\"totalRecords\" [pageSize]=\"5\" showFirstLastButtons=\"true\"\n            (page)=\"getSubstanceProducts($event)\" [pageSizeOptions]=\"[5, 10, 25, 100]\">\n          </mat-paginator>\n        </mat-tab>\n\n\n      </mat-tab-group>\n\n      <!--\n      </div>\n      <ng-template #noprovence>\n        <br>\n        <div class=\"padleft25px colorblue\"><b>No Product Found</b></div>\n        <br>\n      </ng-template>\n    -->\n    </mat-tab>\n\n    <!--  PREVIOUS CODE\n      <div class=\"responsive mat-table-style\">\n        <table mat-table [dataSource]=\"paged\">\n\n          <ng-container matColumnDef=\"productNDC\">\n            <th mat-header-cell *matHeaderCellDef> Product NDC </th>\n            <td mat-cell *matCellDef=\"let product\">\n              <div *ngIf=\"product.fromTable === 'SRS'\">\n                <a [routerLink]=\"['/productDetails', product.id, 'srs']\" target=\"_blank\">{{product.productNDC}}</a>\n              </div>\n              <div *ngIf=\"product.fromTable != 'SRS'\">\n                <a [routerLink]=\"['/productElistDetails', product.id, 'elist']\"\n                  target=\"_blank\">{{product.productNDC}}</a>\n                <br><span class=\"font10px colorgray\">(Elist)</span>\n              </div>\n\n            </td>\n          </ng-container>\n\n          <ng-container matColumnDef=\"name\">\n            <th mat-header-cell *matHeaderCellDef> Product Name </th>\n            <td mat-cell *matCellDef=\"let product\"> {{product.productName}} </td>\n          </ng-container>\n\n          <ng-container matColumnDef=\"nonProprietaryName\">\n            <th mat-header-cell *matHeaderCellDef> Non Proprietary Name </th>\n            <td mat-cell *matCellDef=\"let product\"> {{product.nonProprietaryName}} </td>\n          </ng-container>\n\n          <ng-container matColumnDef=\"labelerName\">\n            <th mat-header-cell *matHeaderCellDef> Labeler Name </th>\n            <td mat-cell *matCellDef=\"let product\"> {{product.labelerName}} </td>\n          </ng-container>\n\n          <ng-container matColumnDef=\"applicationNumber\">\n            <th mat-header-cell *matHeaderCellDef> Application Number </th>\n            <td mat-cell *matCellDef=\"let product\"> {{product.applicationNumber}} </td>\n          </ng-container>\n\n          <ng-container matColumnDef=\"productNameType\">\n            <th mat-header-cell *matHeaderCellDef> Product Name Type </th>\n            <td mat-cell *matCellDef=\"let product\"> {{product.productTypeName}} </td>\n          </ng-container>\n\n          <ng-container matColumnDef=\"ingredientType\">\n            <th mat-header-cell *matHeaderCellDef> Ingredient Type </th>\n            <td mat-cell *matCellDef=\"let product\"> {{product.ingredientType}} </td>\n          </ng-container>\n\n\n          <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n          <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n        </table>\n      </div>\n\n      <mat-paginator [length]=\"totalRecords\" [pageSize]=\"5\" showFirstLastButtons=\"true\"\n        (page)=\"getSubstanceProducts($event)\" [pageSizeOptions]=\"[5, 10, 25, 100]\">\n      </mat-paginator>\n    -->\n\n\n    <mat-tab label=\"Application ({{applicationCount}})\" *ngIf = \"loadedComponents && loadedComponents.applications\">\n      <app-substance-application [bdnum]=\"bdnum\" (countApplicationOut)=\"getApplicationCount($event)\">\n      </app-substance-application>\n    </mat-tab>\n\n    <div *ngIf = \"loadedComponents && loadedComponents.clinicaltrials\">\n      <mat-tab label=\"Clinical Trial ({{clinicalTrialCount}})\" >\n        <app-substance-clinical-trials [bdnum]=\"bdnum\" [substanceUuid]=\"substance.uuid\" (countClinicalTrialOut)=\"getClinicalTrialCount($event)\">\n        </app-substance-clinical-trials>\n      </mat-tab>\n    </div>\n\n\n    <mat-tab label=\"Clinical Trial Europe ({{clinicalTrialEuCount}})\" *ngIf = \"loadedComponents && loadedComponents.clinicaltrials\">\n      <app-substance-clinical-trials-eu [bdnum]=\"bdnum\" [substanceUuid]=\"substance.uuid\" (countClinicalTrialEuOut)=\"getClinicalTrialEuCount($event)\">\n      </app-substance-clinical-trials-eu>\n    </mat-tab>\n\n    <mat-tab label=\"Adverse Event PT ({{advPtCount}})\" *ngIf = \"loadedComponents && loadedComponents.adverseevents\">\n      <app-substance-adverseeventpt [bdnum]=\"bdnum\" [substanceName]=\"substanceName\"\n        (countAdvPtOut)=\"getAdvPtCount($event)\">\n      </app-substance-adverseeventpt>\n    </mat-tab>\n\n    <mat-tab label=\"Adverse Event DME ({{advDmeCount}})\"  *ngIf = \"loadedComponents && loadedComponents.adverseevents\">\n      <app-substance-adverseeventdme [bdnum]=\"bdnum\" (countAdvDmeOut)=\"getAdvDmeCount($event)\">\n      </app-substance-adverseeventdme>\n    </mat-tab>\n\n    <mat-tab label=\"Adverse Event CVM ({{advCvmCount}})\"  *ngIf = \"loadedComponents && loadedComponents.adverseevents\">\n      <app-substance-adverseeventcvm [bdnum]=\"bdnum\" (countAdvCvmOut)=\"getAdvCvmCount($event)\">\n      </app-substance-adverseeventcvm>\n    </mat-tab>\n\n    <mat-tab label=\"Impurities Specs ({{impuritiesCount}})\"  *ngIf = \"loadedComponents && loadedComponents.impurities\">\n      <app-substance-impurities [substanceUuid]=\"substance.uuid\" (countImpuritiesOut)=\"getImpuritiesCount($event)\" [substanceName]=\"substanceName\">\n      </app-substance-impurities>\n    </mat-tab>\n\n  </mat-tab-group>\n</div>\n","import { Component, OnInit, AfterViewInit, ViewChild, ViewEncapsulation } from '@angular/core';\nimport { ActivatedRoute, Router, NavigationExtras } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { SubstanceCardBaseFilteredList } from '@gsrs-core/substance-details';\nimport { GoogleAnalyticsService } from '@gsrs-core/google-analytics';\nimport { ProductService } from '../../product/service/product.service';\nimport { MatTableDataSource } from '@angular/material/table';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MatSort } from '@angular/material/sort';\nimport { PageEvent } from '@angular/material/paginator';\nimport { SubstanceDetailsBaseTableDisplay } from './substance-details-base-table-display';\nimport { SubstanceAdverseEventCvmComponent } from './substance-adverseevent/adverseeventcvm/substance-adverseeventcvm.component';\nimport { ConfigService, LoadedComponents } from '@gsrs-core/config';\nimport { AuthService } from '@gsrs-core/auth';\nimport { take } from 'rxjs/operators';\nimport { FacetParam } from '@gsrs-core/facets-manager';\nimport { LoadingService } from '@gsrs-core/loading/loading.service';\nimport { ExportDialogComponent } from '@gsrs-core/substances-browse/export-dialog/export-dialog.component';\n\n@Component({\n  selector: 'app-substance-products',\n  templateUrl: './substance-products.component.html',\n  styleUrls: ['./substance-products.component.scss']\n})\n\nexport class SubstanceProductsComponent extends SubstanceDetailsBaseTableDisplay implements OnInit, AfterViewInit {\n\n  productCount = 0;\n  applicationCount = 0;\n  clinicalTrialCount = 0;\n  clinicalTrialEuCount = 0;\n  advPtCount = 0;\n  advDmeCount = 0;\n  advCvmCount = 0;\n  impuritiesCount = 0;\n  provenance = '';\n  provenanceList = '';\n  datasourceList = '';\n  loadingStatus = '';\n  showSpinner = false;\n  baseDomain: string;\n  foundProvenanceList = false;\n  loadingComplete = false;\n  substanceName = '';\n  public privateSearch?: string;\n  private privateFacetParams: FacetParam;\n  public privateSearchTerm?: string;\n  privateExport = false;\n  disableExport = false;\n  etag = '';\n  etagAllExport = '';\n  loadedComponents: LoadedComponents;\n  public displayedColumns: string[] = [\n    'productId',\n    'productName',\n    'labelerName',\n    'country',\n    'status',\n    'productNameType',\n    'ingredientType',\n    'applicationNumber'\n  ];\n\n  constructor(\n    private router: Router,\n    public gaService: GoogleAnalyticsService,\n    private productService: ProductService,\n    private configService: ConfigService,\n    public authService: AuthService,\n    private loadingService: LoadingService,\n    private dialog: MatDialog\n  ) {\n    super(gaService, productService);\n  }\n\n  ngOnInit() {\n    this.loadedComponents = this.configService.configData.loadedComponents || null;\n    this.authService.hasAnyRolesAsync('Admin', 'Updater', 'SuperUpdater').pipe(take(1)).subscribe(response => {\n      this.isAdmin = response;\n    });\n\n    if (this.substance && this.substance.uuid) {\n      this.getSubstanceKey();\n\n      // Get Provenance List to Display in Tab\n      this.getProductProvenanceList();\n\n      this.privateSearch = 'root_productIngredientAllList_substanceUuid:\\\"' + this.substance.uuid + '\"';\n      this.getSubstanceProducts(null, 'initial');\n    }\n\n    this.baseDomain = this.configService.configData.apiUrlDomain;\n  }\n\n  ngAfterViewInit() {\n  }\n\n  getApplicationCount($event: any) {\n    this.applicationCount = $event;\n  }\n\n  getClinicalTrialCount($event: any) {\n    this.clinicalTrialCount = $event;\n  }\n\n  getClinicalTrialEuCount($event: any) {\n    this.clinicalTrialEuCount = $event;\n  }\n\n  getAdvPtCount($event: any) {\n    this.advPtCount = $event;\n  }\n\n  getAdvDmeCount($event: any) {\n    this.advDmeCount = $event;\n  }\n\n  getAdvCvmCount($event: any) {\n    this.advCvmCount = $event;\n  }\n\n  getImpuritiesCount($event: any) {\n    this.impuritiesCount = $event;\n  }\n\n  getSubstanceKey() {\n    if (this.substance) {\n      // Get Substance Name\n      this.substanceName = this.substance._name;\n      if (this.substance.codes.length > 0) {\n        this.substance.codes.forEach(element => {\n          if (element.codeSystem && element.codeSystem === 'BDNUM') {\n            if (element.type && element.type === 'PRIMARY') {\n              this.bdnum = element.code;\n            }\n          }\n        });\n      }\n    }\n  }\n\n  getProductProvenanceList(): void {\n    this.productService.getProductProvenanceList(this.substance.uuid).subscribe(results => {\n      this.provenanceList = results;\n      if (this.provenanceList && this.provenanceList.length > 0) {\n        this.foundProvenanceList = true;\n      }\n      this.loadingComplete = true;\n    });\n  }\n\n  /* WORKS In PLAY FRAMEWORK\n  getProductProvenanceList(): void {\n    this.productService.getProductProvenanceList(this.substance.uuid).subscribe(results => {\n      this.provenanceList = results.provenanceList;\n      if (this.provenanceList && this.provenanceList.length > 0) {\n        this.foundProvenanceList = true;\n      }\n      this.loadingComplete = true;\n    });\n  }\n  */\n\n  /* WORKS In PLAY FRAMEWORK\n  getSubstanceProducts(pageEvent?: PageEvent): void {\n    this.setPageEvent(pageEvent);\n    this.showSpinner = true;  // Start progress spinner\n    this.productService.getSubstanceProducts(this.substance.uuid, this.provenance, this.page, this.pageSize).subscribe(results => {\n      this.setResultData(results);\n      this.productCount = this.totalRecords;\n      this.loadingStatus = '';\n      this.showSpinner = false;  // Stop progress spinner\n    });\n  }\n  */\n\n  getSubstanceProducts(pageEvent?: PageEvent, searchType?: string) {\n    this.setPageEvent(pageEvent);\n    this.showSpinner = true;  // Start progress spinner\n    const skip = this.page * this.pageSize;\n\n    // Facet Search for \"Provenance\"\n    // this.privateFacetParams = { 'Provenance': { 'params': { 'SPL': true }, 'isAllMatch': false } };\n\n    const subscription = this.productService.getProducts(\n      'default',\n      skip,\n      this.pageSize,\n      this.privateSearch,\n      this.privateFacetParams\n    )\n      .subscribe(pagingResponse => {\n        if (searchType && searchType === 'initial') {\n          this.etagAllExport = pagingResponse.etag;\n        } else {\n          this.productService.totalRecords = pagingResponse.total;\n          this.setResultData(pagingResponse.content);\n          this.productCount = pagingResponse.total;\n          this.etag = pagingResponse.etag;\n        }\n      }, error => {\n        console.log('error');\n      }, () => {\n        subscription.unsubscribe();\n      });\n    this.loadingStatus = '';\n    this.showSpinner = false;  // Stop progress spinner\n  }\n\n  export() {\n    if (this.etagAllExport) {\n      const extension = 'xlsx';\n      const url = this.getApiExportUrl(this.etagAllExport, extension);\n      if (this.authService.getUser() !== '') {\n        const dialogReference = this.dialog.open(ExportDialogComponent, {\n          height: '215x',\n          width: '550px',\n          data: { 'extension': extension, 'type': 'substanceProduct' }\n        });\n        // this.overlayContainer.style.zIndex = '1002';\n        dialogReference.afterClosed().subscribe(name => {\n          // this.overlayContainer.style.zIndex = null;\n          if (name && name !== '') {\n            this.loadingService.setLoading(true);\n            const fullname = name + '.' + extension;\n            this.authService.startUserDownload(url, this.privateExport, fullname).subscribe(response => {\n              this.loadingService.setLoading(false);\n              const navigationExtras: NavigationExtras = {\n                queryParams: {\n                  totalSub: this.productCount\n                }\n              };\n              const params = { 'total': this.productCount };\n              this.router.navigate(['/user-downloads/', response.id]);\n            }, error => this.loadingService.setLoading(false));\n          }\n        });\n      }\n    }\n  }\n\n  getApiExportUrl(etag: string, extension: string): string {\n    return this.productService.getApiExportUrl(etag, extension);\n  }\n\n  tabSelected($event) {\n    if ($event) {\n      const evt: any = $event.tab;\n      const textLabel: string = evt.textLabel;\n      // Get Country and fromTable/Source from Tab Label\n      if (textLabel != null) {\n        this.loadingStatus = 'Loading data...';\n        this.provenance = textLabel;\n        //  const index = textLabel.indexOf(' ');\n        //  const tab = textLabel.slice(0, index);\n        // this.country = textLabel.slice(index + 1, textLabel.length);\n        // set the current result data to empty or null.\n        this.paged = [];\n\n        this.privateSearch = 'root_productIngredientAllList_substanceUuid:\\\"'\n          + this.substance.uuid + '\\\" AND root_provenance:' + this.provenance;\n\n        this.getSubstanceProducts();\n\n      }\n\n    }\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { DynamicComponentLoaderModule } from '@gsrs-core/dynamic-component-loader';\nimport { SubstanceProductsComponent } from './substance-products.component';\nimport { MatTableModule } from '@angular/material/table';\nimport { CdkTableModule } from '@angular/cdk/table';\nimport { MatPaginatorModule } from '@angular/material/paginator';\nimport { MatSortModule } from '@angular/material/sort';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport { SubstanceApplicationComponent } from './substance-application/substance-application.component';\nimport { SubstanceClinicalTrialsComponent } from './substance-clinical-trials/substance-clinical-trials.component';\nimport { SubstanceAdverseEventPtComponent } from './substance-adverseevent/adverseeventpt/substance-adverseeventpt.component';\nimport { SubstanceAdverseEventDmeComponent } from './substance-adverseevent/adverseeventdme/substance-adverseeventdme.component';\nimport { SubstanceAdverseEventCvmComponent } from './substance-adverseevent/adverseeventcvm/substance-adverseeventcvm.component';\nimport { SubstanceClinicalTrialsEuropeComponent } from './substance-clinical-trials-eu/substance-clinical-trials-eu.component';\nimport { SubstanceImpuritiesComponent } from './substance-impurities/substance-impurities.component';\n@NgModule({\n  imports: [\n    CommonModule,\n    DynamicComponentLoaderModule.forChild(SubstanceProductsComponent),\n    MatTableModule,\n    CdkTableModule,\n    MatPaginatorModule,\n    MatSortModule,\n    MatInputModule,\n    MatTabsModule,\n    MatButtonModule,\n    MatIconModule,\n    MatProgressSpinnerModule,\n    ReactiveFormsModule,\n    FormsModule,\n    RouterModule\n  ],\n  declarations: [\n    SubstanceProductsComponent,\n    SubstanceApplicationComponent,\n    SubstanceClinicalTrialsComponent,\n    SubstanceAdverseEventPtComponent,\n    SubstanceAdverseEventDmeComponent,\n    SubstanceAdverseEventCvmComponent,\n    SubstanceClinicalTrialsEuropeComponent,\n    SubstanceImpuritiesComponent,\n  ]\n})\nexport class SubstanceProductsModule { }\n"],"sourceRoot":"webpack:///","file":"4371.6026c0c6ad88dd22.js"}