{"version":3,"mappings":"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","names":["i0","ctx_r4","ctx_r6","ctx_r7","ctx_r9","ctx_r11","ctx_r12","ctx_r13","ctx_r14","ctx_r20","ctx_r22","SubstanceFormStructureCardComponent","substanceFormService","substanceFormStructureService","structureService","loadingService","dialog","overlayContainerService","gaService","substanceService","substanceFormStructuralUnitsService","l","this","overlayContainer","getContainerElement","definitionSubscription","definition","subscribe","e","substanceType","def","substanceClass","menuLabelUpdate","emit","idealStructSubscription","substanceIdealizedStructure","structure","loadStructure","subscriptions","push","structSubscription","substanceStructure","resolvedMol","mol","updateStructureForm","structureEditor","setMolecule","forEach","subscription","unsubscribe","editor","setLoading","structureUpdated","o","molfile","smiles","isInitializing","interpretStructure","processStructurePostResponse","response","structurePostResponse","hash","charge","Object","keys","key","uuid","updateMoieties","moieties","length","clearTimeout","userMessageTimer","userMessage","setTimeout","sendEvent","dialogRef","open","StructureImportComponent","height","width","data","style","zIndex","afterClosed","structuralUnits","updateSRUs","StructureExportComponent","type","NameResolverDialogComponent","StructureImageModalComponent","panelClass","id","structureErrorsArray","structureDuplicateCheck","resp","messageType","index","splice","link","oldLinkFix","i","SubstanceFormBase","selectors","ctx","SubstanceFormStructureModule","b","CommonModule","DynamicComponentLoaderModule","StructureEditorModule","MatFormFieldModule","MatInputModule","ReactiveFormsModule","FormsModule","MatSelectModule","SubstanceFormModule","NameResolverModule","MatMenuModule","MatIconModule","MatButtonModule"],"sources":["./src/app/core/substance-form/structure/substance-form-structure-card.component.html","./src/app/core/substance-form/structure/substance-form-structure-card.component.ts","./src/app/core/substance-form/structure/substance-form-structure.module.ts"],"sourcesContent":["<div>\n  <div>\n    <div>\n      <app-structure-editor (loadedMolfile)=\"molvecUpdate($event)\" (editorOnLoad)=\"editorOnLoad($event)\"   style=\"z-index: 9999\">\n      </app-structure-editor>\n    </div>\n    <div [ngClass]=\"{'messages-container': true, collapsed: !userMessage, expanded: userMessage}\">\n      {{userMessage}}\n    </div>\n  </div>\n  <div class=\"button-row\" *ngIf=\"structure && substanceType === 'polymer'\">\n    <span class=\"middle-fill\"></span>\n    <span class=\"right-buttons\">\n      <button mat-button color=\"primary\" matTooltip=\"Import options\" (click)=\"openStructureImportDialog()\">\n        <mat-icon svgIcon=\"cloud_upload\"></mat-icon>\n        Import\n      </button>\n      <button (click)=\"openStructureExportDialog()\" mat-button color=\"primary\" matTooltip=\"export structure\">\n        <mat-icon svgIcon=\"get_app\"></mat-icon>\n        Export\n      </button>\n      <button mat-button color=\"primary\" matTooltip=\"preview structure stereochemistry\"\n        (click)=\"openStructureImageModal()\">\n        <mat-icon svgIcon=\"zoom_in\"></mat-icon> View stereochemistry\n      </button>\n    </span>\n  </div>\n  <div class=\"button-row\" *ngIf=\"structure && substanceType === 'structure'\">\n    <span class=\"left-buttons\">\n      <button (click)=\"duplicateCheck()\" matTooltip=\"check the database for duplicate structures\" mat-button\n        color=\"primary\" class=\"dupe-check\">\n        <mat-icon svgIcon=\"search\"></mat-icon>\n        Check for duplicates\n      </button>\n    </span>\n    <span class=\"middle-fill\"></span>\n    <span class=\"right-buttons\">\n      <button mat-button color=\"primary\" matTooltip=\"Import options\" [matMenuTriggerFor]=\"importMenu\">\n        <mat-icon svgIcon=\"cloud_upload\"></mat-icon>\n        Import  &#9660; \n      </button>\n      <button (click)=\"openStructureExportDialog()\" mat-button color=\"primary\" matTooltip=\"export structure\">\n        <mat-icon svgIcon=\"get_app\"></mat-icon>\n        Export\n      </button>\n      <button mat-button color=\"primary\" matTooltip=\"preview structure stereochemistry\"\n        (click)=\"openStructureImageModal()\">\n        <mat-icon svgIcon=\"zoom_in\"></mat-icon> View stereochemistry\n      </button>\n    </span>\n\n    <mat-menu #importMenu=\"matMenu\">\n      <button mat-menu-item (click)=\"openStructureImportDialog()\">\n        Import Structure\n      </button>\n      <button mat-menu-item (click)=\"openNameResolverDialog()\">\n        Resolve name\n      </button>\n    </mat-menu>\n  </div>\n  <div class=\"submission-messages\" *ngIf=\"structureErrorsArray && structureErrorsArray.length > 0\">\n    <div class=\"validation-message\" *ngFor=\"let err of structureErrorsArray; index as i\">\n      <div class=\"message-type\" [ngClass]=\"err.messageType\">{{err.messageType}}</div>\n      <div class=\"message\">{{err.message}}<span *ngFor=\"let link of err.links\"><br />\n          <a [href]=\"fixLink(link.href)\" class=\"internal-link\" target=\"_blank\">\n            {{link.text}}\n          </a></span></div>\n      <button mat-icon-button matTooltip=\"Dismiss\" (click)=\"dismissErrorMessage(i)\">\n        <mat-icon svgIcon=\"close\"></mat-icon>\n      </button>\n    </div>\n  </div>\n  <app-structure-form [structure]=\"structure\" showSettings=\"true\" [type]=\"substanceType\">\n  </app-structure-form>\n  <div class=\"button-container\" *ngIf=\"substanceType === 'polymer'\">\n    <button class=\"mat-flat-button mat-primary\" color=\"primary\" (click)=\"generateSRU()\"\n      matTooltip=\"generate structural units for this structure\">Generate SRUs</button>\n  </div>\n</div>","import { Component, OnInit, AfterViewInit, OnDestroy } from '@angular/core';\nimport { SubstanceFormBase } from '../base-classes/substance-form-base';\nimport { Editor } from '../../structure-editor/structure.editor.model';\nimport { SubstanceStructure } from '@gsrs-core/substance/substance.model';\nimport { SubstanceFormService } from '../substance-form.service';\nimport { StructureService } from '../../structure/structure.service';\nimport { LoadingService } from '../../loading/loading.service';\nimport { InterpretStructureResponse, StructureImportComponent, StructureImageModalComponent } from '@gsrs-core/structure';\nimport { MatDialog } from '@angular/material/dialog';\nimport { StructureExportComponent } from '@gsrs-core/structure/structure-export/structure-export.component';\nimport { OverlayContainer } from '@angular/cdk/overlay';\nimport { GoogleAnalyticsService } from '@gsrs-core/google-analytics';\nimport { StructureDuplicationMessage } from '../substance-form.model';\nimport { NameResolverDialogComponent } from '@gsrs-core/name-resolver/name-resolver-dialog.component';\nimport { Subscription } from 'rxjs';\nimport { SubstanceService } from '@gsrs-core/substance/substance.service';\nimport { SubstanceFormStructuralUnitsService } from '../structural-units/substance-form-structural-units.service';\nimport { SubstanceFormStructureService } from './substance-form-structure.service';\n\n@Component({\n  selector: 'app-substance-form-structure-card',\n  templateUrl: './substance-form-structure-card.component.html',\n  styleUrls: ['./substance-form-structure-card.component.scss']\n})\nexport class SubstanceFormStructureCardComponent extends SubstanceFormBase implements OnInit, AfterViewInit, OnDestroy {\n  structureEditor: Editor;\n  structure: SubstanceStructure;\n  userMessage: string;\n  userMessageTimer: any;\n  substanceType: string;\n  smiles: string;\n  mol: string;\n  isInitializing = true;\n  private overlayContainer: HTMLElement;\n  structureErrorsArray: Array<StructureDuplicationMessage>;\n  subscriptions: Array<Subscription> = [];\n\n  constructor(\n    private substanceFormService: SubstanceFormService,\n    private substanceFormStructureService: SubstanceFormStructureService,\n    private structureService: StructureService,\n    private loadingService: LoadingService,\n    private dialog: MatDialog,\n    private overlayContainerService: OverlayContainer,\n    private gaService: GoogleAnalyticsService,\n    private substanceService: SubstanceService,\n    private substanceFormStructuralUnitsService: SubstanceFormStructuralUnitsService\n  ) {\n    super();\n  }\n\n  ngOnInit() {\n    this.overlayContainer = this.overlayContainerService.getContainerElement();\n    const definitionSubscription = this.substanceFormService.definition.subscribe(def => {\n      this.substanceType = def.substanceClass;\n      if (this.substanceType === 'polymer') {\n        this.menuLabelUpdate.emit('Idealized Structure');\n        const idealStructSubscription = this.substanceFormStructureService.substanceIdealizedStructure.subscribe(structure => {\n          if (structure) {\n            this.structure = structure;\n          } else {\n            // while we also want to do something with display structures eventually,\n            // this isn't the place to do it, I don't think ...\n            //\n            // this.substanceFormService.substanceDisplayStructure.subscribe(structure2 => {\n            //   this.structure = structure2;\n            // });\n          }\n          this.loadStructure();\n        });\n        this.subscriptions.push(idealStructSubscription);\n      } else {\n        this.menuLabelUpdate.emit('Structure');\n        const structSubscription = this.substanceFormStructureService.substanceStructure.subscribe(structure => {\n          this.structure = structure;\n          this.loadStructure();\n        });\n        this.subscriptions.push(structSubscription);\n      }\n    });\n    this.subscriptions.push(definitionSubscription);\n    const resolver = this.substanceFormService.resolvedMol.subscribe(mol => {\n      if (mol != null && mol !== '') {\n        this.updateStructureForm(mol);\n        this.structureEditor.setMolecule(mol);\n      }\n    });\n  }\n\n  ngAfterViewInit() {\n\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach(subscription => {\n      subscription.unsubscribe();\n    });\n  }\n\n  editorOnLoad(editor: Editor): void {\n    this.loadingService.setLoading(false);\n    this.structureEditor = editor;\n    this.loadStructure();\n    this.structureEditor.structureUpdated().subscribe(molfile => {\n      this.updateStructureForm(molfile);\n      this.smiles = this.structure && this.structure.smiles || null;\n      this.mol = this.structure && this.structure.molfile || null;\n    });\n    this.isInitializing = false;\n  }\n\n  startInitializing(): void {\n    this.isInitializing = true;\n  }\n\n  endInitializing(): void {\n    this.isInitializing = false;\n  }\n\n  loadStructure(): void {\n    if (this.structure && this.structureEditor && this.structure.molfile) {\n      this.isInitializing = true;\n      this.structureEditor.setMolecule(this.structure.molfile);\n      this.smiles = this.structure.smiles;\n      this.mol = this.structure.molfile;\n      this.isInitializing = false;\n    }\n  }\n\n  molvecUpdate(mol: any): void {\n    this.updateStructureForm(mol);\n    this.structureEditor.setMolecule(mol);\n  }\n\n  updateStructureForm(molfile: string): void {\n    if (!this.isInitializing) {\n      this.structure.molfile = molfile;\n      this.structureService.interpretStructure(molfile).subscribe(response => {\n        this.processStructurePostResponse(response);\n      });\n    }\n  }\n\n  processStructurePostResponse(structurePostResponse?: InterpretStructureResponse): void {\n    if (structurePostResponse && structurePostResponse.structure) {\n\n      // we should only be dealing with this stuff if the total hash changes\n      // or if the charge changes, or if it's a polymer\n      if (this.substanceType === 'polymer' ||\n        this.structure['hash'] !== structurePostResponse.structure['hash'] ||\n        this.structure['charge'] !== structurePostResponse.structure['charge']) {\n\n        this.smiles = structurePostResponse.structure.smiles;\n        this.mol = structurePostResponse.structure.molfile;\n        // this is sometimes overly ambitious\n        Object.keys(structurePostResponse.structure).forEach(key => {\n          // we don't want to do this with molfile, we want to trust the editor\n          if (key !== 'molfile') {\n            this.structure[key] = structurePostResponse.structure[key];\n          }\n        });\n\n        this.structure.uuid = '';\n        this.substanceFormStructureService.updateMoieties(structurePostResponse.moieties);\n        if (this.substanceType !== 'polymer') {\n        if (structurePostResponse.moieties && structurePostResponse.moieties.length > 1) {\n          clearTimeout(this.userMessageTimer);\n            this.userMessage = 'Certain moieties may have been updated and/or deleted. Please check that the changes are correct.';\n          this.userMessageTimer = setTimeout(() => {\n            this.userMessage = null;\n          }, 20000);\n        }\n      }\n      }\n    }\n  }\n\n  openStructureImportDialog(): void {\n    this.gaService.sendEvent('structureForm', 'button:import', 'import structure');\n    const dialogRef = this.dialog.open(StructureImportComponent, {\n      height: 'auto',\n      width: '650px',\n      data: {}\n    });\n    this.overlayContainer.style.zIndex = '1002';\n\n    dialogRef.afterClosed().subscribe((response?: InterpretStructureResponse) => {\n      this.overlayContainer.style.zIndex = null;\n      if (response != null) {\n        if (response && response.structure && response.structure.molfile) {\n          this.structureEditor.setMolecule(response.structure.molfile);\n        }\n        this.processStructurePostResponse(response);\n      }\n    }, () => { });\n  }\n\n  generateSRU(): void {\n    this.loadingService.setLoading(true);\n    this.structureService.interpretStructure(this.structure.molfile).subscribe(response => {\n      if (response.structuralUnits && response.structuralUnits.length > 0) {\n        this.substanceFormStructuralUnitsService.updateSRUs(response.structuralUnits);\n      }\n      this.loadingService.setLoading(false);\n    }, error => {\n      this.loadingService.setLoading(false);\n    });\n  }\n\n  openStructureExportDialog(): void {\n\n    const dialogRef = this.dialog.open(StructureExportComponent, {\n      height: 'auto',\n      width: '650px',\n      data: {\n        molfile: this.mol,\n        smiles: this.smiles,\n        type: this.substanceType\n      }\n    });\n    this.overlayContainer.style.zIndex = '1002';\n\n    dialogRef.afterClosed().subscribe(() => {\n      this.overlayContainer.style.zIndex = null;\n    }, () => {\n      this.overlayContainer.style.zIndex = null;\n    });\n  }\n\n  openNameResolverDialog(): void {\n    this.gaService.sendEvent('structureForm', 'button:resolveName', 'resolve name');\n    const dialogRef = this.dialog.open(NameResolverDialogComponent, {\n      height: 'auto',\n      width: '800px',\n      data: {}\n    });\n    this.overlayContainer.style.zIndex = '1002';\n\n    dialogRef.afterClosed().subscribe((molfile?: string) => {\n      this.overlayContainer.style.zIndex = null;\n      if (molfile != null && molfile !== '') {\n        this.updateStructureForm(molfile);\n        this.structureEditor.setMolecule(molfile);\n      }\n    }, () => { });\n  }\n\n  openStructureImageModal(): void {\n\n    const dialogRef = this.dialog.open(StructureImageModalComponent, {\n      height: '90%',\n      width: '650px',\n      panelClass: 'structure-image-panel',\n      data: {\n        structure: this.structure.id\n      }\n    });\n\n    this.overlayContainer.style.zIndex = '1002';\n\n    dialogRef.afterClosed().subscribe(() => {\n      this.overlayContainer.style.zIndex = null;\n    }, () => {\n      this.overlayContainer.style.zIndex = null;\n    });\n  }\n\n  duplicateCheck() {\n    this.structureErrorsArray = [];\n    this.substanceFormService.structureDuplicateCheck().subscribe(response => {\n      response.forEach(resp => {\n        if (resp.messageType && resp.messageType !== 'INFO') {\n          this.structureErrorsArray.push(resp);\n        }\n      });\n    });\n  }\n\n  dismissErrorMessage(index: number) {\n    this.structureErrorsArray.splice(index, 1);\n  }\n\n  fixLink(link: string) {\n    return this.substanceService.oldLinkFix(link);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { SubstanceFormStructureCardComponent } from './substance-form-structure-card.component';\nimport { DynamicComponentLoaderModule } from '../../dynamic-component-loader/dynamic-component-loader.module';\nimport { StructureEditorModule } from '../../structure-editor/structure-editor.module';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\nimport { MatSelectModule } from '@angular/material/select';\nimport { SubstanceFormModule } from '../substance-form.module';\nimport { NameResolverModule } from '../../name-resolver/name-resolver.module';\nimport { DragDropPasteDirective } from '@gsrs-core/substance-form/structure/drag-drop-paste.component';\nimport {MatIconModule} from '@angular/material/icon';\nimport {MatMenuModule} from '@angular/material/menu';\nimport {MatButtonModule} from '@angular/material/button';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    DynamicComponentLoaderModule.forChild(SubstanceFormStructureCardComponent),\n    StructureEditorModule,\n    MatFormFieldModule,\n    MatInputModule,\n    ReactiveFormsModule,\n    FormsModule,\n    MatSelectModule,\n    SubstanceFormModule,\n    NameResolverModule,\n    MatMenuModule,\n    MatIconModule,\n    MatButtonModule\n  ],\n  declarations: [\n    SubstanceFormStructureCardComponent,\n  ]\n})\nexport class SubstanceFormStructureModule { }\n"],"sourceRoot":"webpack:///","file":"7333.089593b69d056762.js"}