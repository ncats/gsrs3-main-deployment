"use strict";(self.webpackChunkgsrs_client=self.webpackChunkgsrs_client||[]).push([[5171],{35171:function(ne,C,a){a.r(C),a.d(C,{SubstanceFormDisulfideLinksModule:function(){return ie}});var v=a(1884),g=a(39117),m=a(36362),A=a(75143),M=a(7168),x=a(19975),h=a(65590),k=a(87317),P=a(94673),b=a(44770),f=a(90587),U=a(26439),J=a(43365),y=a(40089),N=a(31959),w=a(46751),Y=a(56101),Q=a(79550),L=a(35354),E=a(40104),D=a(39401),F=a(33567),e=a(86613),S=a(95758),Z=a(54244),_=a(51279),V=a(63169),$=a(18291),T=a(91434),j=a(1130);function z(t,l){if(1&t){var s=e.EpF();e.TgZ(0,"div",9),e._uU(1," Deleted\xa0 "),e.TgZ(2,"button",10),e.NdJ("click",function(){return e.CHM(s),e.oxw().undoDelete()}),e._UZ(3,"mat-icon",11),e.qZA(),e.qZA()}}function B(t,l){if(1&t&&(e.TgZ(0,"mat-option",16),e._uU(1),e.qZA()),2&t){var s=l.$implicit;e.Q6J("value",s),e.xp6(1),e.AsE(" ",s.subunitIndex,"_",s.residueIndex," ")}}function H(t,l){if(1&t){var s=e.EpF();e.TgZ(0,"div",12),e.TgZ(1,"mat-form-field",13),e.TgZ(2,"mat-label"),e._uU(3),e.qZA(),e.TgZ(4,"mat-select",14),e.NdJ("selectionChange",function(r){var u=e.CHM(s).index;return e.oxw().updateSuggestions(r.value,u)}),e.YNc(5,B,2,3,"mat-option",15),e.TgZ(6,"mat-option",16),e._uU(7),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){var i=l.$implicit,n=l.index,o=e.oxw();e.xp6(3),e.Oqu(0===n?"To":"From"),e.xp6(1),e.Q6J("formControlName","site"+n),e.xp6(1),e.Q6J("ngForOf",o.cysteine),e.xp6(1),e.Q6J("value",i),e.xp6(1),e.AsE(" ",i.subunitIndex,"_",i.residueIndex," ")}}var X=function(){var t=function(){function l(s,i,n,o,d,r){(0,g.Z)(this,l),this.cvService=s,this.dialog=i,this.utilsService=n,this.overlayContainerService=o,this.substanceFormService=d,this.substanceFormDisulfideLinksService=r,this.cysteine=[],this.linkDeleted=new e.vpe,this.testForm=new f.cw({site0:new f.NI("",[f.kI.required]),site1:new f.NI("",[f.kI.required])}),this.subscriptions=[]}return(0,v.Z)(l,[{key:"ngOnInit",value:function(){this.privateLink.sites?(this.testForm.controls.site0.setValue(this.privateLink.sites[0]),this.testForm.controls.site1.setValue(this.privateLink.sites[1])):this.privateLink.sites=[{},{}],this.overlayContainer=this.overlayContainerService.getContainerElement()}},{key:"ngAfterViewInit",value:function(){var i=this;setTimeout(function(){var n=i.substanceFormDisulfideLinksService.substanceCysteineSites.subscribe(function(o){i.cysteine=o});i.subscriptions.push(n)})}},{key:"ngOnDestroy",value:function(){this.subscriptions.forEach(function(i){i.unsubscribe()})}},{key:"link",get:function(){return this.privateLink},set:function(i){this.privateLink=i}},{key:"deleteLink",value:function(){var i=this;confirm("Are you sure you want to delete links?")&&(this.privateLink.$$deletedCode=this.utilsService.newUUID(),this.deleteTimer=setTimeout(function(){i.linkDeleted.emit(i.link)},1e3),this.substanceFormDisulfideLinksService.emitDisulfideLinkUpdate())}},{key:"undoDelete",value:function(){clearTimeout(this.deleteTimer),delete this.privateLink.$$deletedCode,this.substanceFormDisulfideLinksService.emitDisulfideLinkUpdate()}},{key:"updateAccess",value:function(i){this.link.access=i}},{key:"updateSuggestions",value:function(i,n){this.cysteine=this.cysteine.filter(function(o){return o.residueIndex!==i.residueIndex||o.subunitIndex!==i.subunitIndex}),this.privateLink.sites[n]!==i&&(this.privateLink.sites[n].residueIndex&&this.cysteine.push(this.privateLink.sites[n]),this.privateLink.sites[n]=i,this.substanceFormDisulfideLinksService.updateCysteine(this.cysteine)),this.testForm.controls["site"+n].setValue(i)}},{key:"openDialog",value:function(){var i=this,n=this.privateLink.sites;(!n[0].residueIndex||!n[1].residueIndex)&&(n=[]);var o=this.dialog.open(D.r,{data:{card:"disulfide",link:n},width:"1040px",panelClass:"subunit-dialog"});this.overlayContainer.style.zIndex="1002";var d=o.afterClosed().subscribe(function(r){i.overlayContainer.style.zIndex=null,r&&(r[0]&&r[0].subunitIndex?(i.privateLink.sites[0]=r[0],i.testForm.controls.site0.setValue(i.privateLink.sites[0])):(i.privateLink.sites[0]={},i.testForm.controls.site0.reset()),r[1]&&r[1].subunitIndex?(i.privateLink.sites[1]=r[1],i.testForm.controls.site1.setValue(i.privateLink.sites[1])):(i.privateLink.sites[1]={},i.testForm.controls.site1.reset())),i.substanceFormDisulfideLinksService.emitDisulfideLinkUpdate()});this.subscriptions.push(d)}}]),l}();return t.\u0275fac=function(s){return new(s||t)(e.Y36($.I),e.Y36(S.uw),e.Y36(V.FW),e.Y36(Z.Xj),e.Y36(F.B),e.Y36(L.n))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-disulfide-links-form"]],inputs:{link:"link"},outputs:{linkDeleted:"linkDeleted"},decls:9,vars:3,consts:[[1,"link-form-container",3,"formGroup"],["class","notification-backdrop",4,"ngIf"],[1,"form-row"],[1,"delete-container"],["mat-icon-button","","matTooltip","Delete link",3,"click"],["svgIcon","delete_forever"],["class","sites",4,"ngFor","ngForOf"],["mat-icon-button","","matTooltip","Select from sequence view",3,"click"],["svgIcon","edit"],[1,"notification-backdrop"],["mat-icon-button","","matTooltip","Undo",3,"click"],["svgIcon","undo"],[1,"sites"],[1,"site"],[1,"site-select",3,"formControlName","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(s,i){1&s&&(e.TgZ(0,"div",0),e.YNc(1,z,4,0,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"button",4),e.NdJ("click",function(){return i.deleteLink()}),e._UZ(5,"mat-icon",5),e.qZA(),e.qZA(),e.YNc(6,H,8,6,"div",6),e.TgZ(7,"button",7),e.NdJ("click",function(){return i.openDialog()}),e._UZ(8,"mat-icon",8),e.qZA(),e.qZA(),e.qZA()),2&s&&(e.Q6J("formGroup",i.testForm),e.xp6(1),e.Q6J("ngIf",i.link.$$deletedCode),e.xp6(5),e.Q6J("ngForOf",i.link.sites))},directives:[f.JL,f.sg,m.O5,k.lW,y.gM,h.Hw,m.sg,b.KE,b.hX,T.gD,f.JJ,f.u,j.ey],styles:[".notification-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;display:-ms-flexbox;display:flex;z-index:10;background-color:var(--notif-backdrop-bg-color);-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;font-size:30px;font-weight:700;color:var(--notif-backdrop-color)}.link-form-container[_ngcontent-%COMP%]{padding:30px 10px 12px;position:relative}.form-row[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around;-ms-flex-align:end;align-items:flex-end}.form-row[_ngcontent-%COMP%]   .delete-container[_ngcontent-%COMP%]{padding:0 10px 8px 0}.form-row[_ngcontent-%COMP%]   .site[_ngcontent-%COMP%]{max-width:80px}.form-row[_ngcontent-%COMP%]   sites[_ngcontent-%COMP%]{width:35%}"]}),t}(),W=a(14900);function G(t,l){1&t&&e._UZ(0,"mat-divider",15),2&t&&e.Q6J("vertical",!0)("inset",!0)}function R(t,l){1&t&&e._UZ(0,"mat-divider",16),2&t&&e.Q6J("inset",!0)}function K(t,l){if(1&t){var s=e.EpF();e.TgZ(0,"div",11),e.YNc(1,G,1,2,"mat-divider",12),e.TgZ(2,"app-disulfide-links-form",13),e.NdJ("linkDeleted",function(c){return e.CHM(s),e.oxw().deleteDisulfideLink(c)}),e.qZA(),e.YNc(3,R,1,1,"mat-divider",14),e.qZA()}if(2&t){var i=l.$implicit,n=l.last,o=l.index,d=e.oxw();e.Q6J("id","substance-disulfide-links-"+o)("ngClass",o%2==0?"side-border":""),e.xp6(1),e.Q6J("ngIf",o%2==0),e.xp6(1),e.Q6J("link",i),e.xp6(1),e.Q6J("ngIf",!n&&o!==d.disulfideLinks.length-2)}}function q(t,l){if(1&t){var s=e.EpF();e.TgZ(0,"div",9),e.TgZ(1,"button",17),e.NdJ("click",function(){return e.CHM(s),e.oxw().deleteAllDisulfideLinks()}),e._uU(2," Delete All Links\n"),e.qZA(),e.qZA()}}var ee=function(){var t=function(l){(0,w.Z)(i,l);var s=(0,Y.Z)(i);function i(n,o,d,r,c){var u;return(0,g.Z)(this,i),(u=s.call(this,d)).substanceFormDisulfideLinksService=n,u.substanceFormService=o,u.gaService=d,u.dialog=r,u.overlayContainerService=c,u.subscriptions=[],u.analyticsEventCategory="substance form disulfide Links",u}return(0,v.Z)(i,[{key:"ngOnInit",value:function(){this.canAddItemUpdate.emit(!0),this.menuLabelUpdate.emit("Disulfide Links"),this.overlayContainer=this.overlayContainerService.getContainerElement()}},{key:"ngAfterViewInit",value:function(){var o=this,d=this.substanceFormDisulfideLinksService.substanceDisulfideLinks.subscribe(function(u){o.disulfideLinks=u,o.countCysteine()});this.subscriptions.push(d);var r=this.substanceFormService.substanceSubunits.subscribe(function(u){o.subunits=u,o.countCysteine()});this.subscriptions.push(r);var c=this.substanceFormDisulfideLinksService.substanceCysteineSites.subscribe(function(u){o.cysteine=u,o.countCysteine()});this.subscriptions.push(c)}},{key:"ngOnDestroy",value:function(){this.componentDestroyed.emit(),this.subscriptions.forEach(function(o){o.unsubscribe()})}},{key:"countCysteine",value:function(){var o=this;null!=this.disulfideLinks&&null!=this.subunits&&null!=this.cysteine&&(this.cysteineBonds=0,this.subunits&&this.subunits.forEach(function(d){o.cysteineBonds+=d.sequence.toUpperCase().split("C").length-1}),this.cysteine&&this.cysteine.length?this.cysteineBonds=this.cysteine.length:this.cysteineBonds-=2*this.disulfideLinks.length,this.getSuggestions())}},{key:"getSuggestions",value:function(){var o=[];if(this.subunits)for(var d=0;d<this.subunits.length;d++){var r=this.subunits[d].sequence;if(null!=r&&r.length>0)for(var c=0;c<r.length;c++)"C"===r[c].toUpperCase()&&o.push({residueIndex:c+1,subunitIndex:d+1})}this.disulfideLinks.forEach(function(p){p.sites&&p.sites.forEach(function(I){o=o.filter(function(O){return O.residueIndex!==I.residueIndex||O.subunitIndex!==I.subunitIndex})})})}},{key:"addItem",value:function(){this.addLink()}},{key:"addLink",value:function(){this.substanceFormDisulfideLinksService.addSubstanceDisulfideLink(),setTimeout(function(){}),this.substanceFormDisulfideLinksService.emitDisulfideLinkUpdate()}},{key:"deleteDisulfideLink",value:function(o){this.substanceFormDisulfideLinksService.deleteSubstanceDisulfideLink(o),this.substanceFormDisulfideLinksService.emitDisulfideLinkUpdate()}},{key:"deleteAllDisulfideLinks",value:function(){confirm("Are you sure you want to delete all links?")&&(this.substanceFormDisulfideLinksService.deleteAllDisulfideLinks(),this.substanceFormDisulfideLinksService.emitDisulfideLinkUpdate())}},{key:"openDialog",value:function(){var o=this,d=this.dialog.open(D.r,{data:{card:"multi-disulfide",link:[]},width:"1040px",panelClass:"subunit-dialog"});this.overlayContainer.style.zIndex="1002";var r=d.afterClosed().subscribe(function(c){o.overlayContainer.style.zIndex=null,c&&o.substanceFormDisulfideLinksService.addCompleteDisulfideLinks(c)});this.subscriptions.push(r)}}]),i}(Q.u);return t.\u0275fac=function(s){return new(s||t)(e.Y36(L.n),e.Y36(F.B),e.Y36(E.$),e.Y36(S.uw),e.Y36(Z.Xj))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-substance-form-disulfide-links-card"]],features:[e.qOj],decls:16,vars:4,consts:[[1,"responsive","columns"],[1,"flex-row","form-row2"],[1,"add-buttons"],["mat-button","",3,"click"],["svgIcon","add_circle_outline"],[1,"cysteine"],["appScrollToTarget","","class","site-set alternate-backgrounds2",3,"id","ngClass",4,"ngFor","ngForOf"],["class","flex-row",4,"ngIf"],[3,"source"],[1,"flex-row"],[1,"middle-fill"],["appScrollToTarget","",1,"site-set","alternate-backgrounds2",3,"id","ngClass"],["style","",3,"vertical","inset",4,"ngIf"],[3,"link","linkDeleted"],["class","form-divider",3,"inset",4,"ngIf"],[3,"vertical","inset"],[1,"form-divider",3,"inset"],["mat-raised-button","","mat-primary","",3,"click"]],template:function(s,i){1&s&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"button",3),e.NdJ("click",function(){return i.openDialog()}),e._uU(4," Add Multiple Links "),e._UZ(5,"mat-icon",4),e.qZA(),e.qZA(),e.TgZ(6,"div",5),e._uU(7),e.qZA(),e.qZA(),e.YNc(8,K,4,5,"div",6),e.qZA(),e.YNc(9,q,3,0,"div",7),e._UZ(10,"app-audit-info",8),e.TgZ(11,"div",9),e._UZ(12,"span",10),e.TgZ(13,"button",3),e.NdJ("click",function(){return i.addLink()}),e._uU(14," Add Disulfide Link "),e._UZ(15,"mat-icon",4),e.qZA(),e.qZA()),2&s&&(e.xp6(7),e.hij(" Number of unspecified Cysteine residues: ",i.cysteineBonds," "),e.xp6(1),e.Q6J("ngForOf",i.disulfideLinks),e.xp6(1),e.Q6J("ngIf",i.disulfideLinks&&i.disulfideLinks.length>0),e.xp6(1),e.Q6J("source",i.disulfideLinks))},directives:[k.lW,h.Hw,m.sg,_.P,m.mk,m.O5,x.d,X,W.n],styles:[".link-form-container[_ngcontent-%COMP%]{padding:30px 10px 12px;position:relative}.notification-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;display:-ms-flexbox;display:flex;z-index:10;background-color:var(--notif-backdrop-bg-color);-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;font-size:30px;font-weight:700;color:var(--notif-backdrop-color)}.form-row2[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:end;align-items:flex-end;-ms-flex:1 0 99%;flex:1 0 99%}.form-row2[_ngcontent-%COMP%]   .delete-container[_ngcontent-%COMP%]{padding:0 10px 8px 0}.form-row2[_ngcontent-%COMP%]   .add-buttons[_ngcontent-%COMP%]{width:40%}.form-row2[_ngcontent-%COMP%]   .cysteine[_ngcontent-%COMP%]{width:50%}.form-row[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:end;align-items:flex-end}.site-set[_ngcontent-%COMP%]{-ms-flex:1 0 48%;flex:1 0 48%;margin:5px;max-width:50%}.columns[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.alternate-backgrounds2[_ngcontent-%COMP%]:nth-child(4n){background-color:var(--nth-child-color-2)}.alternate-backgrounds2[_ngcontent-%COMP%]:nth-child(4n)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-3)}.alternate-backgrounds2[_ngcontent-%COMP%]:nth-child(4n+3){background-color:var(--nth-child-color-2)}.alternate-backgrounds2[_ngcontent-%COMP%]:nth-child(4n+3)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-3)}.alternate-backgrounds2[_ngcontent-%COMP%]:nth-child(4n+1)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-1)}.alternate-backgrounds2[_ngcontent-%COMP%]:nth-child(4n+2)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-1)}.alternate-backgrounds2[_ngcontent-%COMP%]     .mat-expansion-panel, .alternate-backgrounds2[_ngcontent-%COMP%]     .mat-table, .alternate-backgrounds2[_ngcontent-%COMP%]     textarea{background-color:var(--regular-transparent-color)}"]}),t}(),ie=(a(64061),function(){var t=(0,v.Z)(function l(){(0,g.Z)(this,l)});return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[m.ez,A.o0.forChild(ee),M.O,x.t,h.Ps,k.ot,P.w,b.lN,f.UX,f.u5,U.TU,y.AV,N.vV,J.c,T.LD]]}),t}())}}]);
//# sourceMappingURL=5171.eaaa6792dca14bd0.js.map