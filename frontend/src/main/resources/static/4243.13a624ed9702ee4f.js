"use strict";(self.webpackChunkgsrs_client=self.webpackChunkgsrs_client||[]).push([[4243],{14243:function(ct,M,r){r.r(M),r.d(M,{SubstanceFormStructuralModificationsModule:function(){return rt}});var m=r(1884),p=r(39117),u=r(36362),_=r(64061),y=r(7168),C=r(19975),f=r(65590),g=r(87317),x=r(94673),v=r(44770),l=r(90587),S=r(26439),h=r(43365),Z=r(46751),b=r(56101),A=r(79550),O=(r(27299),r(40104)),F=r(5118),t=r(86613),P=r(78444),I=r(51279),U=r(18291),J=r(63169),N=r(39401),D=r(33567),E=r(27164),k=r(95758),w=r(54244),Q=r(24459),Y=r(16667),T=r(91434),R=r(1130),j=r(15992),L=r(84577),V=r(14900);function q(n,d){if(1&n){var o=t.EpF();t.TgZ(0,"div",28),t._uU(1," Deleted\xa0 "),t.TgZ(2,"button",29),t.NdJ("click",function(){return t.CHM(o),t.oxw().undoDelete()}),t._UZ(3,"mat-icon",30),t.qZA(),t.qZA()}}function H(n,d){if(1&n){var o=t.EpF();t.TgZ(0,"div",31),t.TgZ(1,"div",32),t._uU(2,"Sites"),t.qZA(),t._uU(3),t.TgZ(4,"button",29),t.NdJ("click",function(){return t.CHM(o),t.oxw().openDialog()}),t._UZ(5,"mat-icon",25),t.qZA(),t.qZA()}if(2&n){var e=t.oxw();t.xp6(3),t.hij(" ",e.siteDisplay," ")}}function z(n,d){if(1&n){var o=t.EpF();t.TgZ(0,"mat-form-field",18),t.TgZ(1,"input",33),t.NdJ("ngModelChange",function(i){return t.CHM(o),t.oxw().mod.residueModified=i}),t.qZA(),t.qZA()}if(2&n){var e=t.oxw();t.xp6(1),t.Q6J("ngModel",e.mod.residueModified)}}function $(n,d){1&n&&(t.TgZ(0,"mat-option",41),t.TgZ(1,"span",42),t._uU(2,"Clear selection"),t.qZA(),t.qZA()),2&n&&t.Q6J("value",null)}function X(n,d){if(1&n&&(t.TgZ(0,"mat-option",41),t._uU(1),t.qZA()),2&n){var o=d.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij(" ",o.display," ")}}function G(n,d){if(1&n&&(t.TgZ(0,"mat-option",41),t._uU(1),t.qZA()),2&n){var o=t.oxw(2);t.s9C("value",o.mod.residueModified),t.xp6(1),t.hij("",o.mod.residueModified," (not in CV)")}}function W(n,d){if(1&n){var o=t.EpF();t.TgZ(0,"div",43),t.TgZ(1,"input",44),t.NdJ("focusout",function(a){return t.CHM(o),t.oxw(2).updateOrigin(a.target)}),t.qZA(),t.qZA()}}function B(n,d){if(1&n){var o=t.EpF();t.TgZ(0,"div",18),t.TgZ(1,"div",34),t.TgZ(2,"mat-form-field",35),t.TgZ(3,"mat-label"),t._uU(4,"Residue Modified"),t.qZA(),t.TgZ(5,"mat-select",36),t.NdJ("ngModelChange",function(i){return t.CHM(o),t.oxw().mod.residueModified=i})("ngModelChange",function(i){return t.CHM(o),t.oxw().updateResidue(i)}),t.YNc(6,$,3,1,"mat-option",37),t.YNc(7,X,2,2,"mat-option",38),t.YNc(8,G,2,2,"mat-option",37),t.TgZ(9,"mat-option",39),t._uU(10,"Other (New Value)"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(11,W,2,0,"div",40),t.qZA()}if(2&n){var e=t.oxw();t.xp6(2),t.Q6J("ngClass","other"===e.privateMod?"risen":""),t.xp6(3),t.Q6J("ngModel",e.mod.residueModified)("disabled",e.disable),t.xp6(1),t.Q6J("ngIf",e.mod.residueModified),t.xp6(1),t.Q6J("ngForOf",e.nucleicAcidOptions),t.xp6(1),t.Q6J("ngIf",e.mod.residueModified&&!e.inCV(e.nucleicAcidOptions,e.mod.residueModified)&&""!==e.mod.residueModified),t.xp6(3),t.Q6J("ngIf","other"===e.mod.residueModified)}}function K(n,d){if(1&n){var o=t.EpF();t.TgZ(0,"div",45),t.TgZ(1,"app-tag-selector",46),t.NdJ("tagsUpdate",function(i){return t.CHM(o),t.oxw().update(i)}),t.qZA(),t.qZA()}if(2&n){var e=t.oxw();t.xp6(1),t.Q6J("tags",e.pipeToArray(e.mod.residueModified))}}function tt(n,d){if(1&n&&(t.TgZ(0,"div",47),t._uU(1),t.qZA()),2&n){var o=t.oxw();t.xp6(1),t.hij(" ",o.displayAmount(o.mod.extentAmount)," ")}}var et=function(){var n=function(){function d(o,e,a,i,c){(0,p.Z)(this,d),this.cvService=o,this.dialog=e,this.utilsService=a,this.overlayContainerService=i,this.substanceFormService=c,this.modDeleted=new t.vpe,this.modExtentList=[],this.modLocationList=[],this.modTypeList=[],this.subscriptions=[],this.nucleicAcidOptions=[{value:"U",display:"U"},{value:"T",display:"T"},{value:"C",display:"C"},{value:"G",display:"G"},{value:"A",display:"A"}]}return(0,m.Z)(d,[{key:"ngOnInit",value:function(){this.getVocabularies(),this.overlayContainer=this.overlayContainerService.getContainerElement(),this.updateDisplay(),this.getSubstanceType()}},{key:"ngAfterViewInit",value:function(){}},{key:"mod",get:function(){return this.privateMod},set:function(e){this.privateMod=e,this.relatedSubstanceUuid=this.privateMod.molecularFragment&&this.privateMod.molecularFragment.refuuid||""}},{key:"updateResidue",value:function(e){this.privateMod.residueModified=e}},{key:"updateOrigin",value:function(e){e&&""!==e.value&&(this.privateMod.residueModified=e.value)}},{key:"update",value:function(e){this.privateMod.residueModified=e.join(";")}},{key:"getSubstanceType",value:function(){var e=this;this.substanceFormService.definition.subscribe(function(i){e.substanceType=i.substanceClass}).unsubscribe()}},{key:"getVocabularies",value:function(){var e=this;this.cvService.getDomainVocabulary("STRUCTURAL_MODIFICATION_TYPE","LOCATION_TYPE","EXTENT_TYPE").subscribe(function(a){e.modTypeList=a.STRUCTURAL_MODIFICATION_TYPE.list,e.modLocationList=a.LOCATION_TYPE.list,e.modExtentList=a.EXTENT_TYPE.list})}},{key:"deleteMod",value:function(){var e=this;this.privateMod.$$deletedCode=this.utilsService.newUUID(),this.deleteTimer=setTimeout(function(){e.modDeleted.emit(e.privateMod)},2e3)}},{key:"undoDelete",value:function(){clearTimeout(this.deleteTimer),delete this.privateMod.$$deletedCode}},{key:"updateAccess",value:function(e){this.mod.access=e}},{key:"relatedSubstanceUpdated",value:function(e){null!==e?(this.mod.molecularFragment={refPname:e._name,name:e._name,refuuid:e.uuid,substanceClass:"reference",approvalID:e.approvalID},this.relatedSubstanceUuid=this.mod.molecularFragment.refuuid):(this.mod.molecularFragment={},this.relatedSubstanceUuid="")}},{key:"openDialog",value:function(){var e=this,a=this.dialog.open(N.r,{data:{card:"other",link:this.mod.sites},width:"1040px",panelClass:"subunit-dialog"});this.overlayContainer.style.zIndex="1002";var i=a.afterClosed().subscribe(function(c){e.overlayContainer.style.zIndex=null,e.mod.sites=c,e.updateDisplay(),e.substanceFormService.emitStructuralModificationsUpdate()});this.subscriptions.push(i)}},{key:"openAmountDialog",value:function(){var e=this;this.mod.extentAmount||(this.mod.extentAmount={});var a=this.dialog.open(E.O,{data:{subsAmount:this.mod.extentAmount},width:"1040px"});this.overlayContainer.style.zIndex="1002";var i=a.afterClosed().subscribe(function(c){e.overlayContainer.style.zIndex=null,e.mod.extentAmount=c});this.subscriptions.push(i)}},{key:"updateDisplay",value:function(){this.siteDisplay=this.substanceFormService.siteString(this.mod.sites)}},{key:"displayAmount",value:function(e){return this.utilsService.displayAmount(e)}},{key:"formatValue",value:function(e){return e?"object"==typeof e?e.display?e.display:e.value?e.value:null:e:null}},{key:"pipeToArray",value:function(e){return e&&""!==e?e.split(";"):[]}},{key:"inCV",value:function(e,a){return!e||e.some(function(i){return a===i.value})}}]),d}();return n.\u0275fac=function(o){return new(o||n)(t.Y36(U.I),t.Y36(k.uw),t.Y36(J.FW),t.Y36(w.Xj),t.Y36(D.B))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-structural-modification-form"]],inputs:{mod:"mod"},outputs:{modDeleted:"modDeleted"},decls:34,vars:13,consts:[[1,"code-form-container"],["class","notification-backdrop",4,"ngIf"],[1,"delete-container"],["mat-icon-button","","matTooltip","Delete code",3,"click"],["svgIcon","delete_forever"],[1,"flex-column","related-substance"],[1,"related-holder"],["eventCategory","substanceRelationshipRelatedSub","placeholder","Molecular Fragment","header","Molecular Fragment",3,"subuuid","selectionUpdated"],[1,"flex-column","form-content"],[1,"form-row"],["key","Structural Modification Structural Modification Type","title","Modification Type",3,"model","valueChange"],["class","sites",4,"ngIf"],[1,"residues"],["class","group",4,"ngIf"],["class","multi",4,"ngIf"],["domain","EXTENT_TYPE","title","Extent",3,"model","valueChange"],["domain","LOCATION_TYPE","title","Location",3,"model","valueChange"],[1,"group-access"],[1,"group"],["matInput","","placeholder","Group","required","","name","group",3,"ngModel","ngModelChange"],[1,"access"],[3,"access","accessOut"],[1,"amount"],[1,"label","padded"],["mat-icon-button","","matTooltip","add",3,"click"],["svgIcon","edit"],["class","amount-display",4,"ngIf"],[3,"source"],[1,"notification-backdrop"],["mat-icon-button","","matTooltip","Undo",3,"click"],["svgIcon","undo"],[1,"sites"],[1,"label"],["matInput","","placeholder","Residue Modified","name","Residue Modified",3,"ngModel","ngModelChange"],[1,"flex-row"],[1,"cv-field",3,"ngClass"],["name","residueModified",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["value","other"],["class","custom",4,"ngIf"],[3,"value"],[1,"deselect"],[1,"custom"],["matInput","","placeholder","Custom value","name","custom",3,"focusout"],[1,"multi"],["placeholder","Residue Modified","disableCV","true","cvDomain","AMINO_ACID_RESIDUE",1,"tags",3,"tags","tagsUpdate"],[1,"amount-display"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0),t.YNc(1,q,4,0,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"button",3),t.NdJ("click",function(){return e.deleteMod()}),t._UZ(4,"mat-icon",4),t.qZA(),t.qZA(),t.TgZ(5,"div",5),t.TgZ(6,"div",6),t.TgZ(7,"app-substance-selector",7),t.NdJ("selectionUpdated",function(i){return e.relatedSubstanceUpdated(i)}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"div",8),t.TgZ(9,"div",9),t.TgZ(10,"app-cv-input",10),t.NdJ("valueChange",function(i){return e.mod.structuralModificationType=i}),t.qZA(),t.YNc(11,H,6,1,"div",11),t.TgZ(12,"div",12),t.YNc(13,z,2,1,"mat-form-field",13),t.YNc(14,B,12,7,"div",13),t.YNc(15,K,2,1,"div",14),t.qZA(),t.qZA(),t.TgZ(16,"div",9),t.TgZ(17,"app-cv-input",15),t.NdJ("valueChange",function(i){return e.mod.extent=i}),t.qZA(),t.TgZ(18,"app-cv-input",16),t.NdJ("valueChange",function(i){return e.mod.locationType=i}),t.qZA(),t.TgZ(19,"div",17),t.TgZ(20,"div",9),t.TgZ(21,"mat-form-field",18),t.TgZ(22,"input",19),t.NdJ("ngModelChange",function(i){return e.mod.modificationGroup=i}),t.qZA(),t.qZA(),t.TgZ(23,"div",20),t.TgZ(24,"app-access-manager",21),t.NdJ("accessOut",function(i){return e.updateAccess(i)}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"div",9),t.TgZ(26,"div",22),t.TgZ(27,"div",23),t._uU(28," Amount "),t.qZA(),t.TgZ(29,"button",24),t.NdJ("click",function(){return e.openAmountDialog()}),t._UZ(30,"mat-icon",25),t.qZA(),t.YNc(31,tt,2,1,"div",26),t.qZA(),t.qZA(),t.TgZ(32,"div",9),t._UZ(33,"app-audit-info",27),t.qZA(),t.qZA(),t.qZA()),2&o&&(t.xp6(1),t.Q6J("ngIf",e.mod.$$deletedCode),t.xp6(6),t.Q6J("subuuid",e.relatedSubstanceUuid),t.xp6(3),t.Q6J("model",e.mod.structuralModificationType),t.xp6(1),t.Q6J("ngIf","RESIDUE_SPECIFIC"!==e.mod.locationType),t.xp6(2),t.Q6J("ngIf","nucleicAcid"!==e.substanceType&&"protein"!==e.substanceType),t.xp6(1),t.Q6J("ngIf","nucleicAcid"===e.substanceType),t.xp6(1),t.Q6J("ngIf","protein"===e.substanceType),t.xp6(2),t.Q6J("model",e.mod.extent),t.xp6(1),t.Q6J("model",e.mod.locationType),t.xp6(4),t.Q6J("ngModel",e.mod.modificationGroup),t.xp6(2),t.Q6J("access",e.mod.access),t.xp6(7),t.Q6J("ngIf",e.mod.extentAmount),t.xp6(2),t.Q6J("source",e.mod))},directives:[u.O5,g.lW,f.Hw,Q.Q,Y.S,v.KE,h.Nt,l.Fj,l.JJ,l.On,u.mk,v.hX,T.gD,R.ey,u.sg,j.C,l.Q7,L.h,V.n],styles:[".code-form-container[_ngcontent-%COMP%]{padding:30px 10px 12px;position:relative;display:-ms-flexbox;display:flex}.related-substance[_ngcontent-%COMP%]{max-width:25%;width:25%}  .related-substance img{max-width:125px!important;margin:auto}.notification-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;display:-ms-flexbox;display:flex;z-index:10;background-color:var(--notif-backdrop-bg-color);-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;font-size:30px;font-weight:700;color:var(--notif-backdrop-color)}.form-row[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:end;align-items:flex-end}.form-row[_ngcontent-%COMP%]   .delete-container[_ngcontent-%COMP%]{padding:0 10px 8px 0}.form-row[_ngcontent-%COMP%]   .code-system[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .code-system-type[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1;padding-right:15px}.form-row[_ngcontent-%COMP%]   .code-text[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .url[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1}.key-value-pair[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-item-align:start;align-self:flex-start}.key-value-pair[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{font-size:11px;padding-bottom:3.5px;line-height:11px;color:var(--dark-label-color);font-weight:400;font-family:Roboto,Helvetica Neue,sans-serif}.key-value-pair[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:15.5px}.references-container[_ngcontent-%COMP%]{width:100%}.form-row[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;padding:0 10px;-ms-flex-align:end;align-items:flex-end}.form-row[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{padding-bottom:18px}.form-row[_ngcontent-%COMP%]   .location-type[_ngcontent-%COMP%]   .extent[_ngcontent-%COMP%]   .sites[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1}.form-row[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .comment[_ngcontent-%COMP%]{width:45%;padding-right:15px;-ms-flex-positive:1;flex-grow:1}.padded[_ngcontent-%COMP%]{padding-right:20px}.amount-display[_ngcontent-%COMP%]{padding-top:11px}.form-actions[_ngcontent-%COMP%]{-ms-flex-pack:start;justify-content:flex-start;margin:5px 0 10px}.form-content[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1}.mod-type[_ngcontent-%COMP%], .location-type[_ngcontent-%COMP%], .sites[_ngcontent-%COMP%], .group-access[_ngcontent-%COMP%], .extent[_ngcontent-%COMP%], .amount[_ngcontent-%COMP%]{width:33%}.group[_ngcontent-%COMP%], .access[_ngcontent-%COMP%]{width:45%}.custom[_ngcontent-%COMP%]{width:100%}.residues[_ngcontent-%COMP%]{width:60%}.custom[_ngcontent-%COMP%]{padding-bottom:10px;padding-top:10px;border-bottom:1px solid var(--box-shadow-color-6)}"]}),n}();function ot(n,d){1&n&&t._UZ(0,"mat-divider",8),2&n&&t.Q6J("inset",!0)}function nt(n,d){if(1&n){var o=t.EpF();t.TgZ(0,"div",5),t.TgZ(1,"app-structural-modification-form",6),t.NdJ("modDeleted",function(s){return t.CHM(o),t.oxw().deleteStructuralModification(s)}),t.qZA(),t.YNc(2,ot,1,1,"mat-divider",7),t.qZA()}if(2&n){var e=d.$implicit,a=d.last;t.Q6J("id","substance-structural-modification-"+d.index),t.xp6(1),t.Q6J("mod",e),t.xp6(1),t.Q6J("ngIf",!a)}}var it=function(){var n=function(d){(0,Z.Z)(e,d);var o=(0,b.Z)(e);function e(a,i,c){var s;return(0,p.Z)(this,e),(s=o.call(this,c)).substanceFormStructuralModificationsService=a,s.scrollToService=i,s.gaService=c,s.subscriptions=[],s.analyticsEventCategory="substance form structural modifications",s}return(0,m.Z)(e,[{key:"ngOnInit",value:function(){this.canAddItemUpdate.emit(!0),this.menuLabelUpdate.emit("Structural Modifications")}},{key:"ngAfterViewInit",value:function(){var i=this,c=this.substanceFormStructuralModificationsService.substanceStructuralModifications.subscribe(function(s){i.modifications=s});this.subscriptions.push(c)}},{key:"ngOnDestroy",value:function(){this.componentDestroyed.emit(),this.subscriptions.forEach(function(i){i.unsubscribe()})}},{key:"addItem",value:function(){this.addStructuralModification()}},{key:"addStructuralModification",value:function(){var i=this;this.substanceFormStructuralModificationsService.addSubstanceStructuralModification(),setTimeout(function(){i.scrollToService.scrollToElement("substance-structural-modification-0","center")})}},{key:"deleteStructuralModification",value:function(i){this.substanceFormStructuralModificationsService.deleteSubstanceStructuralModification(i)}}]),e}(A.u);return n.\u0275fac=function(o){return new(o||n)(t.Y36(F.T),t.Y36(P.i),t.Y36(O.$))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-substance-form-structural-modifications-card"]],features:[t.qOj],decls:8,vars:1,consts:[[1,"flex-row"],[1,"middle-fill"],["class","alternate-backgrounds","appScrollToTarget","",3,"id",4,"ngFor","ngForOf"],["mat-button","",3,"click"],["svgIcon","add_circle_outline"],["appScrollToTarget","",1,"alternate-backgrounds",3,"id"],[3,"mod","modDeleted"],["class","form-divider",3,"inset",4,"ngIf"],[1,"form-divider",3,"inset"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0),t._UZ(1,"span",1),t.qZA(),t.YNc(2,nt,3,3,"div",2),t.TgZ(3,"div",0),t._UZ(4,"span",1),t.TgZ(5,"button",3),t.NdJ("click",function(){return e.addStructuralModification()}),t._uU(6," Add Modification "),t._UZ(7,"mat-icon",4),t.qZA(),t.qZA()),2&o&&(t.xp6(2),t.Q6J("ngForOf",e.modifications))},directives:[u.sg,I.P,et,u.O5,C.d,g.lW,f.Hw],styles:[".mat-divider.mat-divider-inset[_ngcontent-%COMP%]{margin-left:0}.mat-divider[_ngcontent-%COMP%]{border-top-color:var(--box-shadow-color-3)}.code[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--nth-child-color-2)}.code[_ngcontent-%COMP%]:nth-child(odd)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-3)}.code[_ngcontent-%COMP%]:nth-child(even)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-1)}.code[_ngcontent-%COMP%]     .mat-expansion-panel, .code[_ngcontent-%COMP%]     .mat-table, .code[_ngcontent-%COMP%]     textarea{background-color:var(--regular-transparent-color)}.search[_ngcontent-%COMP%]{width:400px;max-width:100%}"]}),n}(),at=r(63200),rt=function(){var n=(0,m.Z)(function d(){(0,p.Z)(this,d)});return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[u.ez,_.o.forChild(it),y.O,C.t,f.Ps,g.ot,x.w,v.lN,l.UX,l.u5,S.TU,T.LD,h.c,at.U]]}),n}()}}]);
//# sourceMappingURL=4243.13a624ed9702ee4f.js.map