{"version":3,"mappings":"kcACEA,4BACEA,mBACFA,4BAFgBA,4BACuBA,2HAOzCA,2BAAqKA,uDAAQC,2CAE3KD,8BAFyDA,iDAA2C,mBAA3CA,CAA2C,aAA3CA,CAA2C,oDAKpGA,+BAAkCA,wDAFpCA,iBACEA,iCAA4CA,6DAAoBE,qBAAyBF,QACzFA,gCACFA,2CAHuEA,mBACjDA,8BAC8BA,iEAEpDA,2BAAqKA,uDAAQG,2CAE7KH,8BAF2DA,iDAA2C,mBAA3CA,CAA2C,aAA3CA,CAA2C,qEAItGA,kBACIA,kBACAA,qBAAmBA,iDAASI,0BACxBJ,2BAAcA,uBAChBA,QACJA,SCRK,IAAMK,EAAb,eAAaA,EAAb,0CAME,WACUC,EACAC,EACAC,EACDC,EACCC,GAAyC,6BAEjDC,cAAMF,IANEH,iCACAK,WACAA,oBACDA,cACCA,4BARFA,gBAAqC,GAW3CA,EAAKC,uBAAyB,4BAHmBD,EAXrD,uCAiBE,WACEE,KAAKC,iBAAiBC,MAAK,GAC3BF,KAAKG,gBAAgBD,KAAK,cAC1BF,KAAKI,iBAAmBJ,KAAKH,wBAAwBQ,wBApBzD,6BAuBE,WAAe,WACPC,EAAyBN,KAAKP,+BAA+Bc,oBAAoBC,UAAU,YAC/FC,EAAKC,WAAaA,EAClBD,EAAKE,SAAWD,EAChB,IAAME,EAAqBH,EAAKI,cAAcC,aAAaN,UAAU,YACnEC,EAAKM,WAAWC,EAAOP,EAAKC,WAAYD,EAAKV,yBAC5C,YACDkB,QAAQC,IAAIC,KAEdV,EAAKW,cAAcC,KAAKT,GACxBH,EAAKa,KAAO,EACZb,EAAKc,eAEPvB,KAAKoB,cAAcC,KAAKf,KApC5B,yBAuCE,WACEN,KAAKwB,mBAAmBtB,OACxBF,KAAKoB,cAAcK,QAAQ,YACzBC,EAAaC,kBA1CnB,qCA8CE,WAAsE,WAA9CC,EAA8CC,uDAAd,CAAEC,OAAQ,IAE1DC,EAAY/B,KAAKN,OAAOsC,KAAKC,IAA6B,CAC9DC,KAAMN,EACNO,MAAO,UAETnC,KAAKI,iBAAiBgC,MAAMC,OAAS,OAErC,IAAMC,EAAqBP,EAAUQ,cAAc/B,UAAU,YAC3DC,EAAKL,iBAAiBgC,MAAMC,OAAS,KACjB,MAAhBG,GAAwBA,EAAaC,SAAWD,EAAaE,UAC/DjC,EAAKhB,+BAA+BkD,sBAAsBH,KAG9DxC,KAAKoB,cAAcC,KAAKiB,KA5D5B,qBA+DE,WACEtC,KAAK2C,0BAhET,mCAmEE,WAAqB,WACbC,EAAiB5C,KAAKP,+BAA+BkD,sBAAsB,IACjFE,WAAW,WACTpC,EAAKd,gBAAgBmD,gBAAgBF,EAAeG,KAAM,WACzD,MAvEP,6BA0EE,SAAgBnB,GACd5B,KAAKP,+BAA+BuD,yBAAyBpB,OA3EjEqB,GAA0DC,kDAA7C1D,GAAoCL,mFAApCK,EAAoC2D,+yBDjBjDhE,iBACEA,kCAGAA,kBAIFA,QACAA,iCAGAA,uBAIAA,iCAIAA,8BAnByDA,oEAQzCA,2DAG6BA,kCAI7BA,2DAIVA,qyBCHOK,EAAb,mCCgBa4D,EAAb,eAAaA,KAAbC,iFAAaD,4DAlBF,CACPE,KACAC,aAAsC/D,GACtCgE,IACAC,IACAC,IACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,QAMSb,EAAb","names":["i0","ctx_r5","ctx_r10","ctx_r12","ctx_r14","SubstanceFormReferencesCardComponent","substanceFormReferencesService","dialog","scrollToService","gaService","overlayContainerService","s","analyticsEventCategory","this","canAddItemUpdate","emit","menuLabelUpdate","overlayContainer","getContainerElement","referencesSubscription","substanceReferences","subscribe","a","references","filtered","searchSubscription","searchControl","valueChanges","filterList","value","console","log","error","subscriptions","push","page","pageChange","componentDestroyed","forEach","subscription","unsubscribe","reference","arguments","access","dialogRef","open","RefernceFormDialogComponent","data","width","style","zIndex","dialogSubscription","afterClosed","newReference","doctype","citation","addSubstanceReference","addedReference","setTimeout","scrollToElement","uuid","deleteSubstanceReference","t","SubstanceCardBaseFilteredList","selectors","SubstanceFormReferencesModule","v","CommonModule","DynamicComponentLoaderModule","SubstanceFormModule","MatDividerModule","ScrollToModule","MatIconModule","MatButtonModule","MatFormFieldModule","ReactiveFormsModule","FormsModule","MatPaginatorModule","MatInputModule"],"sources":["./src/app/core/substance-form/references/substance-form-references-card.component.html","./src/app/core/substance-form/references/substance-form-references-card.component.ts","./src/app/core/substance-form/references/substance-form-references.module.ts"],"sourcesContent":["<div class=\"flex-row\">\n  <mat-form-field [floatLabel]=\"'never'\" class=\"search\" *ngIf=\"references && references.length > pageSize\">\n    <input matInput placeholder=\"Search\" [formControl]=\"searchControl\">\n  </mat-form-field>\n  <span class=\"middle-fill\"></span>\n  <!-- <button mat-button (click)=\"addSubstanceReference()\">\n    Add reference <mat-icon svgIcon=\"add_circle_outline\"></mat-icon>\n  </button> -->\n</div>\n<mat-paginator *ngIf=\"references && references.length > 5\" [length]=\"filtered && filtered.length || 0\" [pageIndex]=\"page\" [pageSize]=\"5\" showFirstLastButtons=\"true\" (page)=\"pageChange($event, analyticsEventCategory)\"\n    [pageSizeOptions]=\"[5, 10, 25, 100]\">\n  </mat-paginator>\n<div class=\"reference\" *ngFor=\"let reference of paged; last as isLast\" [id]=\"reference.uuid\" appScrollToTarget>\n  <app-reference-form [reference]=\"reference\" (referenceDeleted)=\"deleteReference($event)\"></app-reference-form>\n  <mat-divider class=\"form-divider\" [inset]=\"true\" *ngIf=\"!isLast\"></mat-divider>\n</div>\n<mat-paginator *ngIf=\"references && references.length > 5\" [length]=\"filtered && filtered.length || 0\" [pageIndex]=\"page\" [pageSize]=\"5\" showFirstLastButtons=\"true\" (page)=\"pageChange($event, analyticsEventCategory)\"\n  [pageSizeOptions]=\"[5, 10, 25, 100]\">\n</mat-paginator>\n\n<div *ngIf = \"references && references.length > 0\" style = \"display: flex;\">\n    <span class=\"middle-fill\"></span>\n    <button mat-button (click)=\"addSubstanceReference()\">\n        Add reference <mat-icon svgIcon=\"add_circle_outline\"></mat-icon>\n      </button> \n  </div>","import { Component, OnInit, AfterViewInit, OnDestroy } from '@angular/core';\nimport { SubstanceCardBaseFilteredList, SubstanceCardBaseList } from '../base-classes/substance-form-base-filtered-list';\nimport { SubstanceReference } from '@gsrs-core/substance/substance.model';\nimport { SubstanceFormService } from '../substance-form.service';\nimport { MatDialog } from '@angular/material/dialog';\nimport { RefernceFormDialogComponent } from './references-dialogs/refernce-form-dialog.component';\nimport { ScrollToService } from '../../scroll-to/scroll-to.service';\nimport { GoogleAnalyticsService } from '../../google-analytics/google-analytics.service';\nimport { Subscription } from 'rxjs';\nimport { OverlayContainer } from '@angular/cdk/overlay';\nimport { SubstanceFormReferencesService } from './substance-form-references.service';\n\n@Component({\n  selector: 'app-substance-form-references-card',\n  templateUrl: './substance-form-references-card.component.html',\n  styleUrls: ['./substance-form-references-card.component.scss']\n})\nexport class SubstanceFormReferencesCardComponent extends SubstanceCardBaseFilteredList<SubstanceReference>\n  implements OnInit, AfterViewInit, OnDestroy, SubstanceCardBaseList {\n  references: Array<SubstanceReference>;\n  private subscriptions: Array<Subscription> = [];\n  private overlayContainer: HTMLElement;\n\n  constructor(\n    private substanceFormReferencesService: SubstanceFormReferencesService,\n    private dialog: MatDialog,\n    private scrollToService: ScrollToService,\n    public gaService: GoogleAnalyticsService,\n    private overlayContainerService: OverlayContainer\n  ) {\n    super(gaService);\n    this.analyticsEventCategory = 'substance form references';\n  }\n\n  ngOnInit() {\n    this.canAddItemUpdate.emit(true);\n    this.menuLabelUpdate.emit('References');\n    this.overlayContainer = this.overlayContainerService.getContainerElement();\n  }\n\n  ngAfterViewInit() {\n    const referencesSubscription = this.substanceFormReferencesService.substanceReferences.subscribe(references => {\n      this.references = references;\n      this.filtered = references;\n      const searchSubscription = this.searchControl.valueChanges.subscribe(value => {\n        this.filterList(value, this.references, this.analyticsEventCategory);\n      }, error => {\n        console.log(error);\n      });\n      this.subscriptions.push(searchSubscription);\n      this.page = 0;\n      this.pageChange();\n    });\n    this.subscriptions.push(referencesSubscription);\n  }\n\n  ngOnDestroy() {\n    this.componentDestroyed.emit();\n    this.subscriptions.forEach(subscription => {\n      subscription.unsubscribe();\n    });\n  }\n\n  openReferenceFormDialog(reference: SubstanceReference = { access: [] }): void {\n\n    const dialogRef = this.dialog.open(RefernceFormDialogComponent, {\n      data: reference,\n      width: '900px'\n    });\n    this.overlayContainer.style.zIndex = '1002';\n\n    const dialogSubscription = dialogRef.afterClosed().subscribe(newReference => {\n      this.overlayContainer.style.zIndex = null;\n      if (newReference != null && newReference.doctype && newReference.citation) {\n        this.substanceFormReferencesService.addSubstanceReference(newReference);\n      }\n    });\n    this.subscriptions.push(dialogSubscription);\n  }\n\n  addItem(): void {\n    this.addSubstanceReference();\n  }\n\n  addSubstanceReference(): void {\n    const addedReference = this.substanceFormReferencesService.addSubstanceReference({});\n    setTimeout(() => {\n      this.scrollToService.scrollToElement(addedReference.uuid, 'center');\n    }, 10);\n  }\n\n  deleteReference(reference: SubstanceReference): void {\n    this.substanceFormReferencesService.deleteSubstanceReference(reference);\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { SubstanceFormReferencesCardComponent } from './substance-form-references-card.component';\nimport { DynamicComponentLoaderModule } from '../../dynamic-component-loader/dynamic-component-loader.module';\nimport { SubstanceFormModule } from '../substance-form.module';\nimport { MatDividerModule } from '@angular/material/divider';\nimport { ScrollToModule } from '../../scroll-to/scroll-to.module';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\nimport { MatPaginatorModule } from '@angular/material/paginator';\nimport { MatInputModule } from '@angular/material/input';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    DynamicComponentLoaderModule.forChild(SubstanceFormReferencesCardComponent),\n    SubstanceFormModule,\n    MatDividerModule,\n    ScrollToModule,\n    MatIconModule,\n    MatButtonModule,\n    MatFormFieldModule,\n    ReactiveFormsModule,\n    FormsModule,\n    MatPaginatorModule,\n    MatInputModule\n  ],\n  declarations: [\n    SubstanceFormReferencesCardComponent,\n  ]\n})\nexport class SubstanceFormReferencesModule { }\n"],"sourceRoot":"webpack:///","file":"5353.8a6f9d0d4060fc8e.js"}